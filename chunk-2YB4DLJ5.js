import{a as et,b as qt}from"./chunk-UUTQQLSI.js";var Ht=null,jf=!1,j_=1,jF=null,an=Symbol("SIGNAL");function ie(n){let e=Ht;return Ht=n,e}function $f(){return Ht}var jl={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Bl(n){if(jf)throw new Error("");if(Ht===null)return;Ht.consumerOnSignalRead(n);let e=Ht.producersTail;if(e!==void 0&&e.producer===n)return;let t,r=Ht.recomputing;if(r&&(t=e!==void 0?e.nextProducer:Ht.producers,t!==void 0&&t.producer===n)){Ht.producersTail=t,t.lastReadVersion=n.version;return}let i=n.consumersTail;if(i!==void 0&&i.consumer===Ht&&(!r||$F(i,Ht)))return;let s=ac(Ht),o={producer:n,consumer:Ht,nextProducer:t,prevConsumer:i,lastReadVersion:n.version,nextConsumer:void 0};Ht.producersTail=o,e!==void 0?e.nextProducer=o:Ht.producers=o,s&&rD(n,o)}function eD(){j_++}function B_(n){if(!(ac(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===j_)){if(!n.producerMustRecompute(n)&&!Hf(n)){U_(n);return}n.producerRecomputeValue(n),U_(n)}}function $_(n){if(n.consumers===void 0)return;let e=jf;jf=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let r=t.consumer;r.dirty||BF(r)}}finally{jf=e}}function q_(){return Ht?.consumerAllowSignalWrites!==!1}function BF(n){n.dirty=!0,$_(n),n.consumerMarkedDirty?.(n)}function U_(n){n.dirty=!1,n.lastCleanEpoch=j_}function $l(n){return n&&tD(n),ie(n)}function tD(n){n.producersTail=void 0,n.recomputing=!0}function qf(n,e){ie(e),n&&nD(n)}function nD(n){n.recomputing=!1;let e=n.producersTail,t=e!==void 0?e.nextProducer:n.producers;if(t!==void 0){if(ac(n))do t=H_(t);while(t!==void 0);e!==void 0?e.nextProducer=void 0:n.producers=void 0}}function Hf(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,r=e.lastReadVersion;if(r!==t.version||(B_(t),r!==t.version))return!0}return!1}function ql(n){if(ac(n)){let e=n.producers;for(;e!==void 0;)e=H_(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function rD(n,e){let t=n.consumersTail,r=ac(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!r)for(let i=n.producers;i!==void 0;i=i.nextProducer)rD(i.producer,i)}function H_(n){let e=n.producer,t=n.nextProducer,r=n.nextConsumer,i=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,r!==void 0?r.prevConsumer=i:e.consumersTail=i,i!==void 0)i.nextConsumer=r;else if(e.consumers=r,!ac(e)){let s=e.producers;for(;s!==void 0;)s=H_(s)}return t}function ac(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function z_(n){jF?.(n)}function $F(n,e){let t=e.producersTail;if(t!==void 0){let r=e.producers;do{if(r===n)return!0;if(r===t)break;r=r.nextProducer}while(r!==void 0)}return!1}function G_(n,e){return Object.is(n,e)}function zf(n,e){let t=Object.create(qF);t.computation=n,e!==void 0&&(t.equal=e);let r=()=>{if(B_(t),Bl(t),t.value===Bf)throw t.error;return t.value};return r[an]=t,z_(t),r}var L_=Symbol("UNSET"),F_=Symbol("COMPUTING"),Bf=Symbol("ERRORED"),qF=qt(et({},jl),{value:L_,dirty:!0,error:null,equal:G_,kind:"computed",producerMustRecompute(n){return n.value===L_||n.value===F_},producerRecomputeValue(n){if(n.value===F_)throw new Error("");let e=n.value;n.value=F_;let t=$l(n),r,i=!1;try{r=n.computation(),ie(null),i=e!==L_&&e!==Bf&&r!==Bf&&n.equal(e,r)}catch(s){r=Bf,n.error=s}finally{qf(n,t)}if(i){n.value=e;return}n.value=r,n.version++}});function HF(){throw new Error}var iD=HF;function sD(n){iD(n)}function W_(n){iD=n}var zF=null;function K_(n,e){let t=Object.create(Gf);t.value=n,e!==void 0&&(t.equal=e);let r=()=>oD(t);return r[an]=t,z_(t),[r,o=>Hl(t,o),o=>aD(t,o)]}function oD(n){return Bl(n),n.value}function Hl(n,e){q_()||sD(n),n.equal(n.value,e)||(n.value=e,GF(n))}function aD(n,e){q_()||sD(n),Hl(n,e(n.value))}var Gf=qt(et({},jl),{equal:G_,value:void 0,kind:"signal"});function GF(n){n.version++,eD(),$_(n),zF?.(n)}function Q_(n){let e=ie(null);try{return n()}finally{ie(e)}}function le(n){return typeof n=="function"}function cc(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Wf=cc(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function fo(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Vt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(le(r))try{r()}catch(s){e=s instanceof Wf?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{cD(s)}catch(o){e=e??[],o instanceof Wf?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Wf(e)}}add(e){var t;if(e&&e!==this)if(this.closed)cD(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&fo(t,e)}remove(e){let{_finalizers:t}=this;t&&fo(t,e),e instanceof n&&e._removeParent(this)}};Vt.EMPTY=(()=>{let n=new Vt;return n.closed=!0,n})();var Y_=Vt.EMPTY;function Kf(n){return n instanceof Vt||n&&"closed"in n&&le(n.remove)&&le(n.add)&&le(n.unsubscribe)}function cD(n){le(n)?n():n.unsubscribe()}var Kn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var uc={setTimeout(n,e,...t){let{delegate:r}=uc;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=uc;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Qf(n){uc.setTimeout(()=>{let{onUnhandledError:e}=Kn;if(e)e(n);else throw n})}function po(){}var uD=J_("C",void 0,void 0);function lD(n){return J_("E",void 0,n)}function dD(n){return J_("N",n,void 0)}function J_(n,e,t){return{kind:n,value:e,error:t}}var mo=null;function lc(n){if(Kn.useDeprecatedSynchronousErrorHandling){let e=!mo;if(e&&(mo={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=mo;if(mo=null,t)throw r}}else n()}function hD(n){Kn.useDeprecatedSynchronousErrorHandling&&mo&&(mo.errorThrown=!0,mo.error=n)}var go=class extends Vt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Kf(e)&&e.add(this)):this.destination=QF}static create(e,t,r){return new dc(e,t,r)}next(e){this.isStopped?Z_(dD(e),this):this._next(e)}error(e){this.isStopped?Z_(lD(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Z_(uD,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},WF=Function.prototype.bind;function X_(n,e){return WF.call(n,e)}var ev=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Yf(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Yf(r)}else Yf(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Yf(t)}}},dc=class extends go{constructor(e,t,r){super();let i;if(le(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&Kn.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&X_(e.next,s),error:e.error&&X_(e.error,s),complete:e.complete&&X_(e.complete,s)}):i=e}this.destination=new ev(i)}};function Yf(n){Kn.useDeprecatedSynchronousErrorHandling?hD(n):Qf(n)}function KF(n){throw n}function Z_(n,e){let{onStoppedNotification:t}=Kn;t&&uc.setTimeout(()=>t(n,e))}var QF={closed:!0,next:po,error:KF,complete:po};var hc=typeof Symbol=="function"&&Symbol.observable||"@@observable";function vn(n){return n}function Jf(...n){return tv(n)}function tv(n){return n.length===0?vn:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var me=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=JF(t)?t:new dc(t,r,i);return lc(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=fD(r),new r((i,s)=>{let o=new dc({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[hc](){return this}pipe(...t){return tv(t)(this)}toPromise(t){return t=fD(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function fD(n){var e;return(e=n??Kn.Promise)!==null&&e!==void 0?e:Promise}function YF(n){return n&&le(n.next)&&le(n.error)&&le(n.complete)}function JF(n){return n&&n instanceof go||YF(n)&&Kf(n)}function XF(n){return le(n?.lift)}function ge(n){return e=>{if(XF(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ye(n,e,t,r,i){return new nv(n,e,t,r,i)}var nv=class extends go{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var pD=cc(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var yr=(()=>{class n extends me{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new Xf(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new pD}next(t){lc(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){lc(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){lc(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Y_:(this.currentObservers=null,s.push(t),new Vt(()=>{this.currentObservers=null,fo(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new me;return t.source=this,t}}return n.create=(e,t)=>new Xf(e,t),n})(),Xf=class extends yr{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:Y_}};var zl=class extends yr{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var rv={now(){return(rv.delegate||Date).now()},delegate:void 0};var Zf=class extends Vt{constructor(e,t){super()}schedule(e,t=0){return this}};var Gl={setInterval(n,e,...t){let{delegate:r}=Gl;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Gl;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var fc=class extends Zf{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,r=0){return Gl.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&Gl.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,fo(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var pc=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};pc.now=rv.now;var mc=class extends pc{constructor(e,t=pc.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var ep=new mc(fc),iv=ep;var tp=class extends fc{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var np=class extends mc{};var sv=new np(tp);var Wl=new me(n=>n.complete());function rp(n){return n&&le(n.schedule)}function mD(n){return n[n.length-1]}function gD(n){return le(mD(n))?n.pop():void 0}function Zi(n){return rp(mD(n))?n.pop():void 0}function ov(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function _D(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{d(r.next(h))}catch(f){o(f)}}function c(h){try{d(r.throw(h))}catch(f){o(f)}}function d(h){h.done?s(h.value):i(h.value).then(a,c)}d((r=r.apply(n,e||[])).next())})}function yD(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function yo(n){return this instanceof yo?(this.v=n,this):new yo(n)}function vD(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(w){return function(R){return Promise.resolve(R).then(w,f)}}function a(w,R){r[w]&&(i[w]=function(N){return new Promise(function(P,F){s.push([w,N,P,F])>1||c(w,N)})},R&&(i[w]=R(i[w])))}function c(w,R){try{d(r[w](R))}catch(N){y(s[0][3],N)}}function d(w){w.value instanceof yo?Promise.resolve(w.value.v).then(h,f):y(s[0][2],w)}function h(w){c("next",w)}function f(w){c("throw",w)}function y(w,R){w(R),s.shift(),s.length&&c(s[0][0],s[0][1])}}function ID(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof yD=="function"?yD(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){o=n[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(d){s({value:d,done:a})},o)}}var ip=n=>n&&typeof n.length=="number"&&typeof n!="function";function sp(n){return le(n?.then)}function op(n){return le(n[hc])}function ap(n){return Symbol.asyncIterator&&le(n?.[Symbol.asyncIterator])}function cp(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function ZF(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var up=ZF();function lp(n){return le(n?.[up])}function dp(n){return vD(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield yo(t.read());if(i)return yield yo(void 0);yield yield yo(r)}}finally{t.releaseLock()}})}function hp(n){return le(n?.getReader)}function ht(n){if(n instanceof me)return n;if(n!=null){if(op(n))return e2(n);if(ip(n))return t2(n);if(sp(n))return n2(n);if(ap(n))return ED(n);if(lp(n))return r2(n);if(hp(n))return i2(n)}throw cp(n)}function e2(n){return new me(e=>{let t=n[hc]();if(le(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function t2(n){return new me(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function n2(n){return new me(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Qf)})}function r2(n){return new me(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function ED(n){return new me(e=>{s2(n,e).catch(t=>e.error(t))})}function i2(n){return ED(dp(n))}function s2(n,e){var t,r,i,s;return _D(this,void 0,void 0,function*(){try{for(t=ID(n);r=yield t.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function cn(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function es(n,e=0){return ge((t,r)=>{t.subscribe(ye(r,i=>cn(r,n,()=>r.next(i),e),()=>cn(r,n,()=>r.complete(),e),i=>cn(r,n,()=>r.error(i),e)))})}function ts(n,e=0){return ge((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function wD(n,e){return ht(n).pipe(ts(e),es(e))}function TD(n,e){return ht(n).pipe(ts(e),es(e))}function bD(n,e){return new me(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function SD(n,e){return new me(t=>{let r;return cn(t,e,()=>{r=n[up](),cn(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>le(r?.return)&&r.return()})}function fp(n,e){if(!n)throw new Error("Iterable cannot be null");return new me(t=>{cn(t,e,()=>{let r=n[Symbol.asyncIterator]();cn(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function AD(n,e){return fp(dp(n),e)}function CD(n,e){if(n!=null){if(op(n))return wD(n,e);if(ip(n))return bD(n,e);if(sp(n))return TD(n,e);if(ap(n))return fp(n,e);if(lp(n))return SD(n,e);if(hp(n))return AD(n,e)}throw cp(n)}function kn(n,e){return e?CD(n,e):ht(n)}function o2(...n){let e=Zi(n);return kn(n,e)}function a2(n,e){let t=le(n)?n:()=>n,r=i=>i.error(t());return new me(e?i=>e.schedule(r,0,i):r)}function c2(n){return!!n&&(n instanceof me||le(n.lift)&&le(n.subscribe))}var Kl=cc(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function DD(n){return n instanceof Date&&!isNaN(n)}function un(n,e){return ge((t,r)=>{let i=0;t.subscribe(ye(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:u2}=Array;function l2(n,e){return u2(e)?n(...e):n(e)}function RD(n){return un(e=>l2(n,e))}var{isArray:d2}=Array,{getPrototypeOf:h2,prototype:f2,keys:p2}=Object;function ND(n){if(n.length===1){let e=n[0];if(d2(e))return{args:e,keys:null};if(m2(e)){let t=p2(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function m2(n){return n&&typeof n=="object"&&h2(n)===f2}function PD(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function g2(...n){let e=Zi(n),t=gD(n),{args:r,keys:i}=ND(n);if(r.length===0)return kn([],e);let s=new me(y2(r,e,i?o=>PD(i,o):vn));return t?s.pipe(RD(t)):s}function y2(n,e,t=vn){return r=>{xD(e,()=>{let{length:i}=n,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)xD(e,()=>{let d=kn(n[c],e),h=!1;d.subscribe(ye(r,f=>{s[c]=f,h||(h=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function xD(n,e,t){n?cn(t,n,e):e()}function kD(n,e,t,r,i,s,o,a){let c=[],d=0,h=0,f=!1,y=()=>{f&&!c.length&&!d&&e.complete()},w=N=>d<r?R(N):c.push(N),R=N=>{s&&e.next(N),d++;let P=!1;ht(t(N,h++)).subscribe(ye(e,F=>{i?.(F),s?w(F):e.next(F)},()=>{P=!0},void 0,()=>{if(P)try{for(d--;c.length&&d<r;){let F=c.shift();o?cn(e,o,()=>R(F)):R(F)}y()}catch(F){e.error(F)}}))};return n.subscribe(ye(e,w,()=>{f=!0,y()})),()=>{a?.()}}function _o(n,e,t=1/0){return le(e)?_o((r,i)=>un((s,o)=>e(r,s,i,o))(ht(n(r,i))),t):(typeof e=="number"&&(t=e),ge((r,i)=>kD(r,i,n,t)))}function MD(n=1/0){return _o(vn,n)}function OD(){return MD(1)}function pp(...n){return OD()(kn(n,Zi(n)))}function _2(n){return new me(e=>{ht(n()).subscribe(e)})}function av(n=0,e,t=iv){let r=-1;return e!=null&&(rp(e)?t=e:r=e),new me(i=>{let s=DD(n)?+n-t.now():n;s<0&&(s=0);let o=0;return t.schedule(function(){i.closed||(i.next(o++),0<=r?this.schedule(void 0,r):i.complete())},s)})}function gc(n,e){return ge((t,r)=>{let i=0;t.subscribe(ye(r,s=>n.call(e,s,i++)&&r.next(s)))})}function VD(n){return ge((e,t)=>{let r=null,i=!1,s;r=e.subscribe(ye(t,void 0,void 0,o=>{s=ht(n(o,VD(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function LD(n,e,t,r,i){return(s,o)=>{let a=t,c=e,d=0;s.subscribe(ye(o,h=>{let f=d++;c=a?n(c,h,f):(a=!0,h),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function cv(n,e){return le(e)?_o(n,e,1):_o(n,1)}function FD(n){return ge((e,t)=>{let r=!1;e.subscribe(ye(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function uv(n){return n<=0?()=>Wl:ge((e,t)=>{let r=0;e.subscribe(ye(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function lv(n,e){return ge((t,r)=>{let i=new Set;t.subscribe(ye(r,s=>{let o=n?n(s):s;i.has(o)||(i.add(o),r.next(s))})),e&&ht(e).subscribe(ye(r,()=>i.clear(),po))})}function dv(n,e=vn){return n=n??v2,ge((t,r)=>{let i,s=!0;t.subscribe(ye(r,o=>{let a=e(o);(s||!n(i,a))&&(s=!1,i=a,r.next(o))}))})}function v2(n,e){return n===e}function UD(n=I2){return ge((e,t)=>{let r=!1;e.subscribe(ye(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function I2(){return new Kl}function E2(n){return ge((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function w2(n,e){let t=arguments.length>=2;return r=>r.pipe(n?gc((i,s)=>n(i,s,r)):vn,uv(1),t?FD(e):UD(()=>new Kl))}function T2(n){return n<=0?()=>Wl:ge((e,t)=>{let r=[];e.subscribe(ye(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function hv(){return ge((n,e)=>{let t,r=!1;n.subscribe(ye(e,i=>{let s=t;t=i,r&&e.next([s,i]),r=!0}))})}function mp(n,e){return ge(LD(n,e,arguments.length>=2,!0))}function fv(...n){let e=Zi(n);return ge((t,r)=>{(e?pp(n,t,e):pp(n,t)).subscribe(r)})}function b2(n,e){return ge((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe(ye(r,c=>{i?.unsubscribe();let d=0,h=s++;ht(n(c,h)).subscribe(i=ye(r,f=>r.next(e?e(c,f,h,d++):f),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function S2(n){return ge((e,t)=>{ht(n).subscribe(ye(t,()=>t.complete(),po)),!t.closed&&e.subscribe(t)})}function A2(n,e,t){let r=le(n)||e||t?{next:n,error:e,complete:t}:n;return r?ge((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(ye(s,c=>{var d;(d=r.next)===null||d===void 0||d.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var d;a=!1,(d=r.error)===null||d===void 0||d.call(r,c),s.error(c)},()=>{var c,d;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(d=r.finalize)===null||d===void 0||d.call(r)}))}):vn}var pv;function gp(){return pv}function _r(n){let e=pv;return pv=n,e}var jD=Symbol("NotFound");function yc(n){return n===jD||n?.name==="\u0275NotFound"}var vc=class{full;major;minor;patch;constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},Nv=new vc("21.1.4");var wp="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",ke=class extends Error{code;constructor(e,t){super(Pv(e,t)),this.code=e}};function R2(n){return`NG0${Math.abs(n)}`}function Pv(n,e){return`${R2(n)}${e?": "+e:""}`}var Ec=globalThis;function Ve(n){for(let e in n)if(n[e]===Ve)return e;throw Error("")}function Jr(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(Jr).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let r=t.indexOf(`
`);return r>=0?t.slice(0,r):t}function Tp(n,e){return n?e?`${n} ${e}`:n:e||""}var N2=Ve({__forward_ref__:Ve});function bp(n){return n.__forward_ref__=bp,n.toString=function(){return Jr(this())},n}function ln(n){return xv(n)?n():n}function xv(n){return typeof n=="function"&&n.hasOwnProperty(N2)&&n.__forward_ref__===bp}function Qe(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Sp(n){return{providers:n.providers||[],imports:n.imports||[]}}function ed(n){return x2(n,Ap)}function P2(n){return ed(n)!==null}function x2(n,e){return n.hasOwnProperty(e)&&n[e]||null}function k2(n){let e=n?.[Ap]??null;return e||null}function gv(n){return n&&n.hasOwnProperty(_p)?n[_p]:null}var Ap=Ve({\u0275prov:Ve}),_p=Ve({\u0275inj:Ve}),be=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=Qe({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function kv(n){return n&&!!n.\u0275providers}var Mv=Ve({\u0275cmp:Ve}),Ov=Ve({\u0275dir:Ve}),Vv=Ve({\u0275pipe:Ve}),Lv=Ve({\u0275mod:Ve}),Yl=Ve({\u0275fac:Ve}),bo=Ve({__NG_ELEMENT_ID__:Ve}),BD=Ve({__NG_ENV_ID__:Ve});function Fv(n){return Cp(n,"@NgModule"),n[Lv]||null}function rs(n){return Cp(n,"@Component"),n[Mv]||null}function Uv(n){return Cp(n,"@Directive"),n[Ov]||null}function zD(n){return Cp(n,"@Pipe"),n[Vv]||null}function Cp(n,e){if(n==null)throw new ke(-919,!1)}function wc(n){return typeof n=="string"?n:n==null?"":String(n)}var GD=Ve({ngErrorCode:Ve}),M2=Ve({ngErrorMessage:Ve}),O2=Ve({ngTokenPath:Ve});function jv(n,e){return WD("",-200,e)}function Dp(n,e){throw new ke(-201,!1)}function WD(n,e,t){let r=new ke(e,n);return r[GD]=e,r[M2]=n,t&&(r[O2]=t),r}function V2(n){return n[GD]}var yv;function KD(){return yv}function In(n){let e=yv;return yv=n,e}function Bv(n,e,t){let r=ed(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&8)return null;if(e!==void 0)return e;Dp(n,"")}var L2={},vo=L2,_v="__NG_DI_FLAG__",vv=class{injector;constructor(e){this.injector=e}retrieve(e,t){let r=Io(t)||0;try{return this.injector.get(e,r&8?null:vo,r)}catch(i){if(yc(i))return i;throw i}}};function F2(n,e=0){let t=gp();if(t===void 0)throw new ke(-203,!1);if(t===null)return Bv(n,void 0,e);{let r=U2(e),i=t.retrieve(n,r);if(yc(i)){if(r.optional)return null;throw i}return i}}function zt(n,e=0){return(KD()||F2)(ln(n),e)}function se(n,e){return zt(n,Io(e))}function Io(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function U2(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function Iv(n){let e=[];for(let t=0;t<n.length;t++){let r=ln(n[t]);if(Array.isArray(r)){if(r.length===0)throw new ke(900,!1);let i,s=0;for(let o=0;o<r.length;o++){let a=r[o],c=j2(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(zt(i,s))}else e.push(zt(r))}return e}function QD(n,e){return n[_v]=e,n.prototype[_v]=e,n}function j2(n){return n[_v]}function Eo(n,e){let t=n.hasOwnProperty(Yl);return t?n[Yl]:null}function Rp(n,e){n.forEach(t=>Array.isArray(t)?Rp(t,e):e(t))}function $v(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function td(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function YD(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let s=i-2;n[i]=n[s],i--}n[e]=t,n[e+1]=r}}function qv(n,e,t){let r=Tc(n,e);return r>=0?n[r|1]=t:(r=~r,YD(n,r,e,t)),r}function Np(n,e){let t=Tc(n,e);if(t>=0)return n[t|1]}function Tc(n,e){return B2(n,e,1)}function B2(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let s=r+(i-r>>1),o=n[s<<t];if(e===o)return s<<t;o>e?i=s:r=s+1}return~(i<<t)}var So={},dn=[],bc=new be(""),Hv=new be("",-1),zv=new be(""),Jl=class{get(e,t=vo){if(t===vo){let i=WD("",-201);throw i.name="\u0275NotFound",i}return t}};function Xr(n){return{\u0275providers:n}}function JD(n){return Xr([{provide:bc,multi:!0,useValue:n}])}function XD(...n){return{\u0275providers:Gv(!0,n),\u0275fromNgModule:!0}}function Gv(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return Rp(e,o=>{let a=o;vp(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&ZD(i,s),t}function ZD(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];Wv(i,s=>{e(s,r)})}}function vp(n,e,t,r){if(n=ln(n),!n)return!1;let i=null,s=gv(n),o=!s&&rs(n);if(!s&&!o){let c=n.ngModule;if(s=gv(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=n}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let d of c)vp(d,e,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let d;Rp(s.imports,h=>{vp(h,e,t,r)&&(d||=[],d.push(h))}),d!==void 0&&ZD(d,e)}if(!a){let d=Eo(i)||(()=>new i);e({provide:i,useFactory:d,deps:dn},i),e({provide:zv,useValue:i,multi:!0},i),e({provide:bc,useValue:()=>zt(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let d=n;Wv(c,h=>{e(h,d)})}}else return!1;return i!==n&&n.providers!==void 0}function Wv(n,e){for(let t of n)kv(t)&&(t=t.\u0275providers),Array.isArray(t)?Wv(t,e):e(t)}var $2=Ve({provide:String,useValue:Ve});function eR(n){return n!==null&&typeof n=="object"&&$2 in n}function q2(n){return!!(n&&n.useExisting)}function H2(n){return!!(n&&n.useFactory)}function Ip(n){return typeof n=="function"}var Kv=new be(""),yp={},$D={},mv;function nd(){return mv===void 0&&(mv=new Jl),mv}var hn=class{},wo=class extends hn{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,wv(e,o=>this.processProvider(o)),this.records.set(Hv,_c(void 0,this)),i.has("environment")&&this.records.set(hn,_c(void 0,this));let s=this.records.get(Kv);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(zv,dn,{self:!0}))}retrieve(e,t){let r=Io(t)||0;try{return this.get(e,vo,r)}catch(i){if(yc(i))return i;throw i}}destroy(){Ql(this),this._destroyed=!0;let e=ie(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),ie(e)}}onDestroy(e){return Ql(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){Ql(this);let t=_r(this),r=In(void 0),i;try{return e()}finally{_r(t),In(r)}}get(e,t=vo,r){if(Ql(this),e.hasOwnProperty(BD))return e[BD](this);let i=Io(r),s,o=_r(this),a=In(void 0);try{if(!(i&4)){let d=this.records.get(e);if(d===void 0){let h=Q2(e)&&ed(e);h&&this.injectableDefInScope(h)?d=_c(Ev(e),yp):d=null,this.records.set(e,d)}if(d!=null)return this.hydrate(e,d,i)}let c=i&2?nd():this.parent;return t=i&8&&t===vo?null:t,c.get(e,t)}catch(c){let d=V2(c);throw d===-200||d===-201?new ke(d,null):c}finally{In(a),_r(o)}}resolveInjectorInitializers(){let e=ie(null),t=_r(this),r=In(void 0),i;try{let s=this.get(bc,dn,{self:!0});for(let o of s)o()}finally{_r(t),In(r),ie(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(Jr(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=ln(e);let t=Ip(e)?e:ln(e&&e.provide),r=G2(e);if(!Ip(e)&&e.multi===!0){let i=this.records.get(t);i||(i=_c(void 0,yp,!0),i.factory=()=>Iv(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t,r){let i=ie(null);try{if(t.value===$D)throw jv(Jr(e));return t.value===yp&&(t.value=$D,t.value=t.factory(void 0,r)),typeof t.value=="object"&&t.value&&K2(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{ie(i)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=ln(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Ev(n){let e=ed(n),t=e!==null?e.factory:Eo(n);if(t!==null)return t;if(n instanceof be)throw new ke(204,!1);if(n instanceof Function)return z2(n);throw new ke(204,!1)}function z2(n){if(n.length>0)throw new ke(204,!1);let t=k2(n);return t!==null?()=>t.factory(n):()=>new n}function G2(n){if(eR(n))return _c(void 0,n.useValue);{let e=tR(n);return _c(e,yp)}}function tR(n,e,t){let r;if(Ip(n)){let i=ln(n);return Eo(i)||Ev(i)}else if(eR(n))r=()=>ln(n.useValue);else if(H2(n))r=()=>n.useFactory(...Iv(n.deps||[]));else if(q2(n))r=(i,s)=>zt(ln(n.useExisting),s!==void 0&&s&8?8:void 0);else{let i=ln(n&&(n.useClass||n.provide));if(W2(n))r=()=>new i(...Iv(n.deps));else return Eo(i)||Ev(i)}return r}function Ql(n){if(n.destroyed)throw new ke(205,!1)}function _c(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function W2(n){return!!n.deps}function K2(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function Q2(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function wv(n,e){for(let t of n)Array.isArray(t)?wv(t,e):t&&kv(t)?wv(t.\u0275providers,e):e(t)}function is(n,e){let t;n instanceof wo?(Ql(n),t=n):t=new vv(n);let r,i=_r(t),s=In(void 0);try{return e()}finally{_r(i),In(s)}}function nR(){return KD()!==void 0||gp()!=null}var Qn=0,de=1,pe=2,xt=3,Mn=4,On=5,Sc=6,Ac=7,st=8,Zr=9,vr=10,ft=11,Cc=12,Qv=13,Ao=14,wn=15,Co=16,Do=17,Ro=18,ei=19,Yv=20,Yr=21,Pp=22,rd=23,Tn=24,xp=25,No=26,Ft=27,rR=1,Jv=6,ss=7,id=8,sd=9,ot=10;function ti(n){return Array.isArray(n)&&typeof n[rR]=="object"}function Yn(n){return Array.isArray(n)&&n[rR]===!0}function Xv(n){return(n.flags&4)!==0}function Po(n){return n.componentOffset>-1}function kp(n){return(n.flags&1)===1}function xo(n){return!!n.template}function Dc(n){return(n[pe]&512)!==0}function ko(n){return(n[pe]&256)===256}var iR="svg",sR="math";function Vn(n){for(;Array.isArray(n);)n=n[Qn];return n}function Zv(n,e){return Vn(e[n])}function Ir(n,e){return Vn(e[n.index])}function od(n,e){return n.data[e]}function Er(n,e){let t=e[n];return ti(t)?t:t[Qn]}function Mp(n){return(n[pe]&128)===128}function oR(n){return Yn(n[xt])}function wr(n,e){return e==null?null:n[e]}function eI(n){n[Do]=0}function tI(n){n[pe]&1024||(n[pe]|=1024,Mp(n)&&cd(n))}function aR(n,e){for(;n>0;)e=e[Ao],n--;return e}function ad(n){return!!(n[pe]&9216||n[Tn]?.dirty)}function Op(n){n[vr].changeDetectionScheduler?.notify(8),n[pe]&64&&(n[pe]|=1024),ad(n)&&cd(n)}function cd(n){n[vr].changeDetectionScheduler?.notify(0);let e=ns(n);for(;e!==null&&!(e[pe]&8192||(e[pe]|=8192,!Mp(e)));)e=ns(e)}function nI(n,e){if(ko(n))throw new ke(911,!1);n[Yr]===null&&(n[Yr]=[]),n[Yr].push(e)}function cR(n,e){if(n[Yr]===null)return;let t=n[Yr].indexOf(e);t!==-1&&n[Yr].splice(t,1)}function ns(n){let e=n[xt];return Yn(e)?e[xt]:e}function uR(n){return n[Ac]??=[]}function lR(n){return n.cleanup??=[]}var _e={lFrame:AR(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var Tv=!1;function dR(){return _e.lFrame.elementDepthCount}function hR(){_e.lFrame.elementDepthCount++}function rI(){_e.lFrame.elementDepthCount--}function fR(){return _e.bindingsEnabled}function pR(){return _e.skipHydrationRootTNode!==null}function iI(n){return _e.skipHydrationRootTNode===n}function sI(){_e.skipHydrationRootTNode=null}function Le(){return _e.lFrame.lView}function Jn(){return _e.lFrame.tView}function mR(n){return _e.lFrame.contextLView=n,n[st]}function gR(n){return _e.lFrame.contextLView=null,n}function Tr(){let n=oI();for(;n!==null&&n.type===64;)n=n.parent;return n}function oI(){return _e.lFrame.currentTNode}function yR(){let n=_e.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Rc(n,e){let t=_e.lFrame;t.currentTNode=n,t.isParent=e}function aI(){return _e.lFrame.isParent}function _R(){_e.lFrame.isParent=!1}function cI(){return Tv}function uI(n){let e=Tv;return Tv=n,e}function vR(){return _e.lFrame.bindingIndex}function IR(n){return _e.lFrame.bindingIndex=n}function ud(){return _e.lFrame.bindingIndex++}function Vp(n){let e=_e.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function ER(){return _e.lFrame.inI18n}function wR(n,e){let t=_e.lFrame;t.bindingIndex=t.bindingRootIndex=n,Lp(e)}function TR(){return _e.lFrame.currentDirectiveIndex}function Lp(n){_e.lFrame.currentDirectiveIndex=n}function bR(n){let e=_e.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function lI(n){_e.lFrame.currentQueryIndex=n}function Y2(n){let e=n[de];return e.type===2?e.declTNode:e.type===1?n[On]:null}function dI(n,e,t){if(t&4){let i=e,s=n;for(;i=i.parent,i===null&&!(t&1);)if(i=Y2(s),i===null||(s=s[Ao],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=_e.lFrame=SR();return r.currentTNode=e,r.lView=n,!0}function Fp(n){let e=SR(),t=n[de];_e.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function SR(){let n=_e.lFrame,e=n===null?null:n.child;return e===null?AR(n):e}function AR(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function CR(){let n=_e.lFrame;return _e.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var hI=CR;function Up(){let n=CR();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function DR(n){return(_e.lFrame.contextLView=aR(n,_e.lFrame.contextLView))[st]}function br(){return _e.lFrame.selectedIndex}function os(n){_e.lFrame.selectedIndex=n}function RR(){let n=_e.lFrame;return od(n.tView,n.selectedIndex)}function NR(){return _e.lFrame.currentNamespace}var PR=!0;function jp(){return PR}function Bp(n){PR=n}function bv(n,e=null,t=null,r){let i=fI(n,e,t,r);return i.resolveInjectorInitializers(),i}function fI(n,e=null,t=null,r,i=new Set){let s=[t||dn,XD(n)];return r=r||(typeof n=="object"?void 0:Jr(n)),new wo(s,e||nd(),r||null,i)}var En=class n{static THROW_IF_NOT_FOUND=vo;static NULL=new Jl;static create(e,t){if(Array.isArray(e))return bv({name:""},t,e,"");{let r=e.name??"";return bv({name:r},e.parent,e.providers,r)}}static \u0275prov=Qe({token:n,providedIn:"any",factory:()=>zt(Hv)});static __NG_ELEMENT_ID__=-1},ni=new be(""),Nc=(()=>{class n{static __NG_ELEMENT_ID__=J2;static __NG_ENV_ID__=t=>t}return n})(),Sv=class extends Nc{_lView;constructor(e){super(),this._lView=e}get destroyed(){return ko(this._lView)}onDestroy(e){let t=this._lView;return nI(t,e),()=>cR(t,e)}};function J2(){return new Sv(Le())}var xR=!1,kR=new be(""),Mo=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new zl(!1);debugTaskTracker=se(kR,{optional:!0});get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new me(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),this.debugTaskTracker?.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.debugTaskTracker?.remove(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=Qe({token:n,providedIn:"root",factory:()=>new n})}return n})(),Av=class extends yr{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,nR()&&(this.destroyRef=se(Nc,{optional:!0})??void 0,this.pendingTasks=se(Mo,{optional:!0})??void 0)}emit(e){let t=ie(null);try{super.next(e)}finally{ie(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=this.wrapInTimeout(s),i&&(i=this.wrapInTimeout(i)),o&&(o=this.wrapInTimeout(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof Vt&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{r!==void 0&&this.pendingTasks?.remove(r)}})}}},Qr=Av;function Ep(...n){}function pI(n){let e,t;function r(){n=Ep;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function MR(n){return queueMicrotask(()=>n()),()=>{n=Ep}}var mI="isAngularZone",Xl=mI+"_ID",X2=0,Lt=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new Qr(!1);onMicrotaskEmpty=new Qr(!1);onStable=new Qr(!1);onError=new Qr(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:s=xR}=e;if(typeof Zone>"u")throw new ke(908,!1);Zone.assertZonePatched();let o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!i&&r,o.shouldCoalesceRunChangeDetection=i,o.callbackScheduled=!1,o.scheduleInRootZone=s,tU(o)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(mI)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new ke(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new ke(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,Z2,Ep,Ep);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},Z2={};function gI(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function eU(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){pI(()=>{n.callbackScheduled=!1,Cv(n),n.isCheckStableRunning=!0,gI(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),Cv(n)}function tU(n){let e=()=>{eU(n)},t=X2++;n._inner=n._inner.fork({name:"angular",properties:{[mI]:!0,[Xl]:t,[Xl+t]:!0},onInvokeTask:(r,i,s,o,a,c)=>{if(nU(c))return r.invokeTask(s,o,a,c);try{return qD(n),r.invokeTask(s,o,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&o.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),HD(n)}},onInvoke:(r,i,s,o,a,c,d)=>{try{return qD(n),r.invoke(s,o,a,c,d)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!rU(c)&&e(),HD(n)}},onHasTask:(r,i,s,o)=>{r.hasTask(s,o),i===s&&(o.change=="microTask"?(n._hasPendingMicrotasks=o.microTask,Cv(n),gI(n)):o.change=="macroTask"&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(r,i,s,o)=>(r.handleError(s,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}function Cv(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function qD(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function HD(n){n._nesting--,gI(n)}var Zl=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new Qr;onMicrotaskEmpty=new Qr;onStable=new Qr;onError=new Qr;run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function nU(n){return OR(n,"__ignore_ng_zone__")}function rU(n){return OR(n,"__scheduler_tick__")}function OR(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var Ic=class{_console=console;handleError(e){this._console.error("ERROR",e)}},as=new be("",{factory:()=>{let n=se(Lt),e=se(hn),t;return r=>{n.runOutsideAngular(()=>{e.destroyed&&!t?setTimeout(()=>{throw r}):(t??=e.get(Ic),t.handleError(r))})}}}),VR={provide:bc,useValue:()=>{let n=se(Ic,{optional:!0})},multi:!0},iU=new be("",{factory:()=>{let n=se(ni).defaultView;if(!n)return;let e=se(as),t=s=>{e(s.reason),s.preventDefault()},r=s=>{s.error?e(s.error):e(new Error(s.message,{cause:s})),s.preventDefault()},i=()=>{n.addEventListener("unhandledrejection",t),n.addEventListener("error",r)};typeof Zone<"u"?Zone.root.run(i):i(),se(Nc).onDestroy(()=>{n.removeEventListener("error",r),n.removeEventListener("unhandledrejection",t)})}});function sU(){return Xr([JD(()=>{se(iU)})])}function yI(n,e){let[t,r,i]=K_(n,e?.equal),s=t,o=s[an];return s.set=r,s.update=i,s.asReadonly=LR.bind(s),s}function LR(){let n=this[an];if(n.readonlyFn===void 0){let e=()=>this();e[an]=n,n.readonlyFn=e}return n.readonlyFn}var To=class{},ld=new be("",{factory:()=>!0});var _I=new be(""),Pc=(()=>{class n{internalPendingTasks=se(Mo);scheduler=se(To);errorHandler=se(as);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){let r=this.add();t().catch(this.errorHandler).finally(r)}static \u0275prov=Qe({token:n,providedIn:"root",factory:()=>new n})}return n})(),vI=(()=>{class n{static \u0275prov=Qe({token:n,providedIn:"root",factory:()=>new Dv})}return n})(),Dv=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,r=this.queues.get(t);r.has(e)&&(r.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let r=this.queues.get(t);r.has(e)||r.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,r]of this.queues)t===null?e||=this.flushQueue(r):e||=t.run(()=>this.flushQueue(r));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let r of e)r.dirty&&(this.dirtyEffectCount--,t=!0,r.run());return t}},Rv=class{[an];constructor(e){this[an]=e}destroy(){this[an].destroy()}};function II(n){return Q_(n)}function Fc(n){return{toString:n}.toString()}var $p="__parameters__";function gU(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function yU(n,e,t){return Fc(()=>{let r=gU(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,d,h){let f=c.hasOwnProperty($p)?c[$p]:Object.defineProperty(c,$p,{value:[]})[$p];for(;f.length<=h;)f.push(null);return(f[h]=f[h]||[]).push(o),c}}return i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var ii=QD(yU("Optional"),8);function _U(n){return typeof n=="function"}function m0(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}var Yp=class{previousValue;currentValue;firstChange;constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}},vU=(()=>{let n=()=>g0;return n.ngInherit=!0,n})();function g0(n){return n.type.prototype.ngOnChanges&&(n.setInput=EU),IU}function IU(){let n=_0(this),e=n?.current;if(e){let t=n.previous;if(t===So)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function EU(n,e,t,r,i){let s=this.declaredInputs[r],o=_0(n)||wU(n,{previous:So,current:null}),a=o.current||(o.current={}),c=o.previous,d=c[s];a[s]=new Yp(d&&d.currentValue,t,c===So),m0(n,e,i,t)}var y0="__ngSimpleChanges__";function _0(n){return n[y0]||null}function wU(n,e){return n[y0]=e}var FR=[];var $e=function(n,e=null,t){for(let r=0;r<FR.length;r++){let i=FR[r];i(n,e,t)}},Me=(function(n){return n[n.TemplateCreateStart=0]="TemplateCreateStart",n[n.TemplateCreateEnd=1]="TemplateCreateEnd",n[n.TemplateUpdateStart=2]="TemplateUpdateStart",n[n.TemplateUpdateEnd=3]="TemplateUpdateEnd",n[n.LifecycleHookStart=4]="LifecycleHookStart",n[n.LifecycleHookEnd=5]="LifecycleHookEnd",n[n.OutputStart=6]="OutputStart",n[n.OutputEnd=7]="OutputEnd",n[n.BootstrapApplicationStart=8]="BootstrapApplicationStart",n[n.BootstrapApplicationEnd=9]="BootstrapApplicationEnd",n[n.BootstrapComponentStart=10]="BootstrapComponentStart",n[n.BootstrapComponentEnd=11]="BootstrapComponentEnd",n[n.ChangeDetectionStart=12]="ChangeDetectionStart",n[n.ChangeDetectionEnd=13]="ChangeDetectionEnd",n[n.ChangeDetectionSyncStart=14]="ChangeDetectionSyncStart",n[n.ChangeDetectionSyncEnd=15]="ChangeDetectionSyncEnd",n[n.AfterRenderHooksStart=16]="AfterRenderHooksStart",n[n.AfterRenderHooksEnd=17]="AfterRenderHooksEnd",n[n.ComponentStart=18]="ComponentStart",n[n.ComponentEnd=19]="ComponentEnd",n[n.DeferBlockStateStart=20]="DeferBlockStateStart",n[n.DeferBlockStateEnd=21]="DeferBlockStateEnd",n[n.DynamicComponentStart=22]="DynamicComponentStart",n[n.DynamicComponentEnd=23]="DynamicComponentEnd",n[n.HostBindingsUpdateStart=24]="HostBindingsUpdateStart",n[n.HostBindingsUpdateEnd=25]="HostBindingsUpdateEnd",n})(Me||{});function TU(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=g0(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function bU(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:d,ngOnDestroy:h}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),d&&((n.viewHooks??=[]).push(t,d),(n.viewCheckHooks??=[]).push(t,d)),h!=null&&(n.destroyHooks??=[]).push(t,h)}}function Wp(n,e,t){v0(n,e,3,t)}function Kp(n,e,t,r){(n[pe]&3)===t&&v0(n,e,t,r)}function EI(n,e){let t=n[pe];(t&3)===e&&(t&=16383,t+=1,n[pe]=t)}function v0(n,e,t,r){let i=r!==void 0?n[Do]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[Do]+=65536),(a<s||s==-1)&&(SU(n,t,e,c),n[Do]=(n[Do]&4294901760)+c+2),c++}function UR(n,e){$e(Me.LifecycleHookStart,n,e);let t=ie(null);try{e.call(n)}finally{ie(t),$e(Me.LifecycleHookEnd,n,e)}}function SU(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=n[o];i?n[pe]>>14<n[Do]>>16&&(n[pe]&3)===e&&(n[pe]+=16384,UR(a,s)):UR(a,s)}var kc=-1,fd=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,r,i){this.factory=e,this.name=i,this.canSeeViewProviders=t,this.injectImpl=r}};function AU(n){return(n.flags&8)!==0}function CU(n){return(n.flags&16)!==0}function DU(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{let s=i,o=t[++r];NU(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function RU(n){return n===3||n===4||n===6}function NU(n){return n.charCodeAt(0)===64}function hm(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?jR(n,t,i,null,e[++r]):jR(n,t,i,null,null))}}return n}function jR(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){i!==null&&(n[s+1]=i);return}s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),i!==null&&n.splice(s++,0,i)}function I0(n){return n!==kc}function Jp(n){return n&32767}function PU(n){return n>>16}function Xp(n,e){let t=PU(n),r=e;for(;t>0;)r=r[Ao],t--;return r}var DI=!0;function BR(n){let e=DI;return DI=n,e}var xU=256,E0=xU-1,w0=5,kU=0,Sr={};function MU(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(bo)&&(r=t[bo]),r==null&&(r=t[bo]=kU++);let i=r&E0,s=1<<i;e.data[n+(i>>w0)]|=s}function T0(n,e){let t=b0(n,e);if(t!==-1)return t;let r=e[de];r.firstCreatePass&&(n.injectorIndex=e.length,wI(r.data,n),wI(e,null),wI(r.blueprint,null));let i=iE(n,e),s=n.injectorIndex;if(I0(i)){let o=Jp(i),a=Xp(i,e),c=a[de].data;for(let d=0;d<8;d++)e[s+d]=a[o+d]|c[o+d]}return e[s+8]=i,s}function wI(n,e){n.push(0,0,0,0,0,0,0,0,e)}function b0(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function iE(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=R0(i),r===null)return kc;if(t++,i=i[Ao],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return kc}function OU(n,e,t){MU(n,e,t)}function S0(n,e,t){if(t&8||n!==void 0)return n;Dp(e,"NodeInjector")}function A0(n,e,t,r){if(t&8&&r===void 0&&(r=null),(t&3)===0){let i=n[Zr],s=In(void 0);try{return i?i.get(e,r,t&8):Bv(e,r,t&8)}finally{In(s)}}return S0(r,e,t)}function C0(n,e,t,r=0,i){if(n!==null){if(e[pe]&2048&&!(r&2)){let o=BU(n,e,t,r,Sr);if(o!==Sr)return o}let s=D0(n,e,t,r,Sr);if(s!==Sr)return s}return A0(e,t,r,i)}function D0(n,e,t,r,i){let s=FU(t);if(typeof s=="function"){if(!dI(e,n,r))return r&1?S0(i,t,r):A0(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&8))Dp(t);else return o}finally{hI()}}else if(typeof s=="number"){let o=null,a=b0(n,e),c=kc,d=r&1?e[wn][On]:null;for((a===-1||r&4)&&(c=a===-1?iE(n,e):e[a+8],c===kc||!qR(r,!1)?a=-1:(o=e[de],a=Jp(c),e=Xp(c,e)));a!==-1;){let h=e[de];if($R(s,a,h.data)){let f=VU(a,e,t,o,r,d);if(f!==Sr)return f}c=e[a+8],c!==kc&&qR(r,e[de].data[a+8]===d)&&$R(s,a,e)?(o=h,a=Jp(c),e=Xp(c,e)):a=-1}}return i}function VU(n,e,t,r,i,s){let o=e[de],a=o.data[n+8],c=r==null?Po(a)&&DI:r!=o&&(a.type&3)!==0,d=i&1&&s===a,h=LU(a,o,t,c,d);return h!==null?RI(e,o,h,a,i):Sr}function LU(n,e,t,r,i){let s=n.providerIndexes,o=e.data,a=s&1048575,c=n.directiveStart,d=n.directiveEnd,h=s>>20,f=r?a:a+h,y=i?a+h:d;for(let w=f;w<y;w++){let R=o[w];if(w<c&&t===R||w>=c&&R.type===t)return w}if(i){let w=o[c];if(w&&xo(w)&&w.type===t)return c}return null}function RI(n,e,t,r,i){let s=n[t],o=e.data;if(s instanceof fd){let a=s;if(a.resolving)throw jv("");let c=BR(a.canSeeViewProviders);a.resolving=!0;let d=o[t].type||o[t],h,f=a.injectImpl?In(a.injectImpl):null,y=dI(n,r,0);try{s=n[t]=a.factory(void 0,i,o,n,r),e.firstCreatePass&&t>=r.directiveStart&&TU(t,o[t],e)}finally{f!==null&&In(f),BR(c),a.resolving=!1,hI()}}return s}function FU(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(bo)?n[bo]:void 0;return typeof e=="number"?e>=0?e&E0:UU:e}function $R(n,e,t){let r=1<<n;return!!(t[e+(n>>w0)]&r)}function qR(n,e){return!(n&2)&&!(n&1&&e)}var Oo=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return C0(this._tNode,this._lView,e,Io(r),t)}};function UU(){return new Oo(Tr(),Le())}function jU(n){return Fc(()=>{let e=n.prototype.constructor,t=e[Yl]||NI(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[Yl]||NI(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function NI(n){return xv(n)?()=>{let e=NI(ln(n));return e&&e()}:Eo(n)}function BU(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[pe]&2048&&!Dc(o);){let a=D0(s,o,t,r|2,Sr);if(a!==Sr)return a;let c=s.parent;if(!c){let d=o[Yv];if(d){let h=d.get(t,Sr,r);if(h!==Sr)return h}c=R0(o),o=o[Ao]}s=c}return i}function R0(n){let e=n[de],t=e.type;return t===2?e.declTNode:t===1?n[On]:null}function $U(){return sE(Tr(),Le())}function sE(n,e){return new N0(Ir(n,e))}var N0=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=$U}return n})();function P0(n){return(n.flags&128)===128}var oE=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(oE||{}),x0=new Map,qU=0;function HU(){return qU++}function zU(n){x0.set(n[ei],n)}function PI(n){x0.delete(n[ei])}var HR="__ngContext__";function Mc(n,e){ti(e)?(n[HR]=e[ei],zU(e)):n[HR]=e}function k0(n){return O0(n[Cc])}function M0(n){return O0(n[Mn])}function O0(n){for(;n!==null&&!Yn(n);)n=n[Mn];return n}var xI;function GU(n){xI=n}function V0(){if(xI!==void 0)return xI;if(typeof document<"u")return document;throw new ke(210,!1)}var WU=new be("",{factory:()=>KU}),KU="ng";var L0=new be(""),aE=new be("",{providedIn:"platform",factory:()=>"unknown"});var QU=new be("",{factory:()=>se(ni).body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var F0="r";var U0="di";var j0=!1,B0=new be("",{factory:()=>j0});var YU=(n,e,t,r)=>{};function JU(n,e,t,r){YU(n,e,t,r)}function cE(n){return(n.flags&32)===32}var XU=()=>null;function $0(n,e,t=!1){return XU(n,e,t)}function q0(n,e){let t=n.contentQueries;if(t!==null){let r=ie(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=n.data[o];lI(s),a.contentQueries(2,e[o],o)}}}finally{ie(r)}}}function kI(n,e,t){lI(0);let r=ie(null);try{e(n,t)}finally{ie(r)}}function H0(n,e,t){if(Xv(e)){let r=ie(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=n.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{ie(r)}}}var Vo=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n[n.ExperimentalIsolatedShadowDom=4]="ExperimentalIsolatedShadowDom",n})(Vo||{});var qp;function ZU(){if(qp===void 0&&(qp=null,Ec.trustedTypes))try{qp=Ec.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return qp}function fm(n){return ZU()?.createHTML(n)||n}var Hp;function ej(){if(Hp===void 0&&(Hp=null,Ec.trustedTypes))try{Hp=Ec.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Hp}function zR(n){return ej()?.createHTML(n)||n}var ri=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${wp})`}},MI=class extends ri{getTypeName(){return"HTML"}},OI=class extends ri{getTypeName(){return"Style"}},VI=class extends ri{getTypeName(){return"Script"}},LI=class extends ri{getTypeName(){return"URL"}},FI=class extends ri{getTypeName(){return"ResourceURL"}};function Uc(n){return n instanceof ri?n.changingThisBreaksApplicationSecurity:n}function uE(n,e){let t=z0(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${wp})`)}return t===e}function z0(n){return n instanceof ri&&n.getTypeName()||null}function tj(n){return new MI(n)}function nj(n){return new OI(n)}function rj(n){return new VI(n)}function ij(n){return new LI(n)}function sj(n){return new FI(n)}function oj(n){let e=new jI(n);return aj()?new UI(e):e}var UI=class{inertDocumentHelper;constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{let t=new window.DOMParser().parseFromString(fm(e),"text/html").body;return t===null?this.inertDocumentHelper.getInertBodyElement(e):(t.firstChild?.remove(),t)}catch{return null}}},jI=class{defaultDoc;inertDocument;constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){let t=this.inertDocument.createElement("template");return t.innerHTML=fm(e),t}};function aj(){try{return!!new window.DOMParser().parseFromString(fm(""),"text/html")}catch{return!1}}var cj=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function lE(n){return n=String(n),n.match(cj)?n:"unsafe:"+n}function si(n){let e={};for(let t of n.split(","))e[t]=!0;return e}function Ed(...n){let e={};for(let t of n)for(let r in t)t.hasOwnProperty(r)&&(e[r]=!0);return e}var G0=si("area,br,col,hr,img,wbr"),W0=si("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),K0=si("rp,rt"),uj=Ed(K0,W0),lj=Ed(W0,si("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),dj=Ed(K0,si("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),GR=Ed(G0,lj,dj,uj),Q0=si("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),hj=si("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),fj=si("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext"),pj=Ed(Q0,hj,fj),mj=si("script,style,template"),BI=class{sanitizedSomething=!1;buf=[];sanitizeChildren(e){let t=e.firstChild,r=!0,i=[];for(;t;){if(t.nodeType===Node.ELEMENT_NODE?r=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,r&&t.firstChild){i.push(t),t=_j(t);continue}for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let s=yj(t);if(s){t=s;break}t=i.pop()}}return this.buf.join("")}startElement(e){let t=WR(e).toLowerCase();if(!GR.hasOwnProperty(t))return this.sanitizedSomething=!0,!mj.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);let r=e.attributes;for(let i=0;i<r.length;i++){let s=r.item(i),o=s.name,a=o.toLowerCase();if(!pj.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let c=s.value;Q0[a]&&(c=lE(c)),this.buf.push(" ",o,'="',KR(c),'"')}return this.buf.push(">"),!0}endElement(e){let t=WR(e).toLowerCase();GR.hasOwnProperty(t)&&!G0.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(KR(e))}};function gj(n,e){return(n.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}function yj(n){let e=n.nextSibling;if(e&&n!==e.previousSibling)throw Y0(e);return e}function _j(n){let e=n.firstChild;if(e&&gj(n,e))throw Y0(e);return e}function WR(n){let e=n.nodeName;return typeof e=="string"?e:"FORM"}function Y0(n){return new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`)}var vj=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Ij=/([^\#-~ |!])/g;function KR(n){return n.replace(/&/g,"&amp;").replace(vj,function(e){let t=e.charCodeAt(0),r=e.charCodeAt(1);return"&#"+((t-55296)*1024+(r-56320)+65536)+";"}).replace(Ij,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var zp;function J0(n,e){let t=null;try{zp=zp||oj(n);let r=e?String(e):"";t=zp.getInertBodyElement(r);let i=5,s=r;do{if(i===0)throw new Error("Failed to sanitize html because the input is unstable");i--,r=s,s=t.innerHTML,t=zp.getInertBodyElement(r)}while(r!==s);let a=new BI().sanitizeChildren(QR(t)||t);return fm(a)}finally{if(t){let r=QR(t)||t;for(;r.firstChild;)r.firstChild.remove()}}}function QR(n){return"content"in n&&Ej(n)?n.content:null}function Ej(n){return n.nodeType===Node.ELEMENT_NODE&&n.nodeName==="TEMPLATE"}function wj(n,e){return n.createText(e)}function Tj(n,e,t){n.setValue(e,t)}function X0(n,e,t){return n.createElement(e,t)}function Zp(n,e,t,r,i){n.insertBefore(e,t,r,i)}function Z0(n,e,t){n.appendChild(e,t)}function YR(n,e,t,r,i){r!==null?Zp(n,e,t,r,i):Z0(n,e,t)}function eN(n,e,t,r){n.removeChild(null,e,t,r)}function bj(n,e,t){n.setAttribute(e,"style",t)}function Sj(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function tN(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&DU(n,e,r),i!==null&&Sj(n,e,i),s!==null&&bj(n,e,s)}var pm=(function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n})(pm||{});function Aj(n){let e=nN();return e?zR(e.sanitize(pm.HTML,n)||""):uE(n,"HTML")?zR(Uc(n)):J0(V0(),wc(n))}function Cj(n){let e=nN();return e?e.sanitize(pm.URL,n)||"":uE(n,"URL")?Uc(n):lE(wc(n))}function nN(){let n=Le();return n&&n[vr].sanitizer}function rN(n){return n instanceof Function?n():n}function Dj(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}var iN="ng-template";function Rj(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&Dj(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(dE(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function dE(n){return n.type===4&&n.value!==iN}function Nj(n,e,t){let r=n.type===4&&!t?iN:n.value;return e===r}function Pj(n,e,t){let r=4,i=n.attrs,s=i!==null?Mj(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!Xn(r)&&!Xn(c))return!1;if(o&&Xn(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!Nj(n,c,t)||c===""&&e.length===1){if(Xn(r))return!1;o=!0}}else if(r&8){if(i===null||!Rj(n,i,c,t)){if(Xn(r))return!1;o=!0}}else{let d=e[++a],h=xj(c,i,dE(n),t);if(h===-1){if(Xn(r))return!1;o=!0;continue}if(d!==""){let f;if(h>s?f="":f=i[h+1].toLowerCase(),r&2&&d!==f){if(Xn(r))return!1;o=!0}}}}return Xn(r)||o}function Xn(n){return(n&1)===0}function xj(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return Oj(e,n)}function kj(n,e,t=!1){for(let r=0;r<e.length;r++)if(Pj(n,e[r],t))return!0;return!1}function Mj(n){for(let e=0;e<n.length;e++){let t=n[e];if(RU(t))return e}return n.length}function Oj(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function JR(n,e){return n?":not("+e.trim()+")":e}function Vj(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Xn(o)&&(e+=JR(s,i),i=""),r=o,s=s||!Xn(r);t++}return i!==""&&(e+=JR(s,i)),e}function Lj(n){return n.map(Vj).join(",")}function Fj(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!Xn(i))break;i=s}r++}return t.length&&e.push(1,...t),e}var bn={};function hE(n,e,t,r,i,s,o,a,c,d,h){let f=Ft+r,y=f+i,w=Uj(f,y),R=typeof d=="function"?d():d;return w[de]={type:n,blueprint:w,template:t,queries:null,viewQuery:a,declTNode:e,data:w.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:y,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:R,incompleteFirstPass:!1,ssrId:h}}function Uj(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:bn);return t}function jj(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=hE(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function fE(n,e,t,r,i,s,o,a,c,d,h){let f=e.blueprint.slice();return f[Qn]=i,f[pe]=r|4|128|8|64|1024,(d!==null||n&&n[pe]&2048)&&(f[pe]|=2048),eI(f),f[xt]=f[Ao]=n,f[st]=t,f[vr]=o||n&&n[vr],f[ft]=a||n&&n[ft],f[Zr]=c||n&&n[Zr]||null,f[On]=s,f[ei]=HU(),f[Sc]=h,f[Yv]=d,f[wn]=e.type==2?n[wn]:f,f}function Bj(n,e,t){let r=Ir(e,n),i=jj(t),s=n[vr].rendererFactory,o=pE(n,fE(n,i,null,sN(t),r,e,null,s.createRenderer(r,t),null,null,null));return n[e.index]=o}function sN(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function oN(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function pE(n,e){return n[Cc]?n[Qv][Mn]=e:n[Cc]=e,n[Qv]=e,e}function $j(n=1){aN(Jn(),Le(),br()+n,!1)}function aN(n,e,t,r){if(!r)if((e[pe]&3)===3){let s=n.preOrderCheckHooks;s!==null&&Wp(e,s,t)}else{let s=n.preOrderHooks;s!==null&&Kp(e,s,0,t)}os(t)}var mm=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(mm||{});function $I(n,e,t,r){let i=ie(null);try{let[s,o,a]=n.inputs[t],c=null;(o&mm.SignalBased)!==0&&(c=e[s][an]),c!==null&&c.transformFn!==void 0?r=c.transformFn(r):a!==null&&(r=a.call(e,r)),n.setInput!==null?n.setInput(e,c,r,t,s):m0(e,c,s,r)}finally{ie(i)}}var em=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(em||{}),qj;function mE(n,e){return qj(n,e)}var pd=new Set,gE=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(gE||{}),yE=new be(""),XR=new Set;function Uo(n){XR.has(n)||(XR.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var cN=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=Qe({token:n,providedIn:"root",factory:()=>new n})}return n})();var _E=new be("",{factory:()=>({queue:new Set,isScheduled:!1,scheduler:null,injector:se(hn)})});function uN(n,e,t){let r=n.get(_E);if(Array.isArray(e))for(let i of e)r.queue.add(i),t?.detachedLeaveAnimationFns?.push(i);else r.queue.add(e),t?.detachedLeaveAnimationFns?.push(e);r.scheduler&&r.scheduler(n)}function Hj(n,e){let t=n.get(_E);if(e.detachedLeaveAnimationFns){for(let r of e.detachedLeaveAnimationFns)t.queue.delete(r);e.detachedLeaveAnimationFns=void 0}}function zj(n,e){for(let[t,r]of e)uN(n,r.animateFns)}function Gj(n,e){let t=n.get(_E);if(Array.isArray(e))for(let r of e)t.queue.delete(r);else t.queue.delete(e)}function ZR(n,e,t,r){let i=n?.[No]?.enter;e!==null&&i&&i.has(t.index)&&zj(r,i)}function xc(n,e,t,r,i,s,o,a){if(i!=null){let c,d=!1;Yn(i)?c=i:ti(i)&&(d=!0,i=i[Qn]);let h=Vn(i);n===0&&r!==null?(ZR(a,r,s,t),o==null?Z0(e,r,h):Zp(e,r,h,o||null,!0)):n===1&&r!==null?(ZR(a,r,s,t),Zp(e,r,h,o||null,!0)):n===2?e0(a,s,t,f=>{eN(e,h,d,f)}):n===3&&e0(a,s,t,()=>{e.destroyNode(h)}),c!=null&&sB(e,n,t,c,s,r,o)}}function Wj(n,e){lN(n,e),e[Qn]=null,e[On]=null}function Kj(n,e,t,r,i,s){r[Qn]=i,r[On]=e,ym(n,r,t,1,i,s)}function lN(n,e){e[vr].changeDetectionScheduler?.notify(9),ym(n,e,e[ft],2,null,null)}function Qj(n){let e=n[Cc];if(!e)return TI(n[de],n);for(;e;){let t=null;if(ti(e))t=e[Cc];else{let r=e[ot];r&&(t=r)}if(!t){for(;e&&!e[Mn]&&e!==n;)ti(e)&&TI(e[de],e),e=e[xt];e===null&&(e=n),ti(e)&&TI(e[de],e),t=e&&e[Mn]}e=t}}function vE(n,e){let t=n[sd],r=t.indexOf(e);t.splice(r,1)}function gm(n,e){if(ko(e))return;let t=e[ft];t.destroyNode&&ym(n,e,t,3,null,null),Qj(e)}function TI(n,e){if(ko(e))return;let t=ie(null);try{e[pe]&=-129,e[pe]|=256,e[Tn]&&ql(e[Tn]),Xj(n,e),Jj(n,e),e[de].type===1&&e[ft].destroy();let r=e[Co];if(r!==null&&Yn(e[xt])){r!==e[xt]&&vE(r,e);let i=e[Ro];i!==null&&i.detachView(n)}PI(e)}finally{ie(t)}}function e0(n,e,t,r){let i=n?.[No];if(i?.enter?.has(e.index)&&Gj(t,i.enter.get(e.index).animateFns),i==null||i.leave==null||!i.leave.has(e.index))return r(!1);n&&pd.add(n[ei]),uN(t,()=>{if(i.leave&&i.leave.has(e.index)){let o=i.leave.get(e.index),a=[];if(o){for(let c=0;c<o.animateFns.length;c++){let d=o.animateFns[c],{promise:h}=d();a.push(h)}i.detachedLeaveAnimationFns=void 0}i.running=Promise.allSettled(a),Yj(n,r)}else n&&pd.delete(n[ei]),r(!1)},i)}function Yj(n,e){let t=n[No]?.running;if(t){t.then(()=>{n[No].running=void 0,pd.delete(n[ei]),e(!0)});return}e(!1)}function Jj(n,e){let t=n.cleanup,r=e[Ac];if(t!==null)for(let o=0;o<t.length-1;o+=2)if(typeof t[o]=="string"){let a=t[o+3];a>=0?r[a]():r[-a].unsubscribe(),o+=2}else{let a=r[t[o+1]];t[o].call(a)}r!==null&&(e[Ac]=null);let i=e[Yr];if(i!==null){e[Yr]=null;for(let o=0;o<i.length;o++){let a=i[o];a()}}let s=e[rd];if(s!==null){e[rd]=null;for(let o of s)o.destroy()}}function Xj(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof fd)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];$e(Me.LifecycleHookStart,a,c);try{c.call(a)}finally{$e(Me.LifecycleHookEnd,a,c)}}else{$e(Me.LifecycleHookStart,i,s);try{s.call(i)}finally{$e(Me.LifecycleHookEnd,i,s)}}}}}function Zj(n,e,t){return eB(n,e.parent,t)}function eB(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[Qn];if(Po(r)){let{encapsulation:i}=n.data[r.directiveStart+r.componentOffset];if(i===Vo.None||i===Vo.Emulated)return null}return Ir(r,t)}function tB(n,e,t){return rB(n,e,t)}function nB(n,e,t){return n.type&40?Ir(n,t):null}var rB=nB,t0;function IE(n,e,t,r){let i=Zj(n,r,e),s=e[ft],o=r.parent||e[On],a=tB(o,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)YR(s,i,t[c],a,!1);else YR(s,i,t,a,!1);t0!==void 0&&t0(s,r,e,t,i)}function dd(n,e){if(e!==null){let t=e.type;if(t&3)return Ir(e,n);if(t&4)return qI(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return dd(n,r);{let i=n[e.index];return Yn(i)?qI(-1,i):Vn(i)}}else{if(t&128)return dd(n,e.next);if(t&32)return mE(e,n)()||Vn(n[e.index]);{let r=dN(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=ns(n[wn]);return dd(i,r)}else return dd(n,e.next)}}}return null}function dN(n,e){if(e!==null){let r=n[wn][On],i=e.projection;return r.projection[i]}return null}function qI(n,e){let t=ot+n+1;if(t<e.length){let r=e[t],i=r[de].firstChild;if(i!==null)return dd(r,i)}return e[ss]}function EE(n,e,t,r,i,s,o){for(;t!=null;){let a=r[Zr];if(t.type===128){t=t.next;continue}let c=r[t.index],d=t.type;if(o&&e===0&&(c&&Mc(Vn(c),r),t.flags|=2),!cE(t))if(d&8)EE(n,e,t.child,r,i,s,!1),xc(e,n,a,i,c,t,s,r);else if(d&32){let h=mE(t,r),f;for(;f=h();)xc(e,n,a,i,f,t,s,r);xc(e,n,a,i,c,t,s,r)}else d&16?iB(n,e,r,t,i,s):xc(e,n,a,i,c,t,s,r);t=o?t.projectionNext:t.next}}function ym(n,e,t,r,i,s){EE(t,r,n.firstChild,e,i,s,!1)}function iB(n,e,t,r,i,s){let o=t[wn],c=o[On].projection[r.projection];if(Array.isArray(c))for(let d=0;d<c.length;d++){let h=c[d];xc(e,n,t[Zr],i,h,r,s,t)}else{let d=c,h=o[xt];P0(r)&&(d.flags|=128),EE(n,e,d,h,i,s,!0)}}function sB(n,e,t,r,i,s,o){let a=r[ss],c=Vn(r);a!==c&&xc(e,n,t,s,a,i,o);for(let d=ot;d<r.length;d++){let h=r[d];ym(h[de],h,n,e,s,a)}}function oB(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let s=r.indexOf("-")===-1?void 0:em.DashCase;i==null?n.removeStyle(t,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=em.Important),n.setStyle(t,r,i,s))}}function hN(n,e,t,r,i){let s=br(),o=r&2;try{os(-1),o&&e.length>Ft&&aN(n,e,Ft,!1);let a=o?Me.TemplateUpdateStart:Me.TemplateCreateStart;$e(a,i,t),t(r,i)}finally{os(s);let a=o?Me.TemplateUpdateEnd:Me.TemplateCreateEnd;$e(a,i,t)}}function fN(n,e,t){dB(n,e,t),(t.flags&64)===64&&hB(n,e,t)}function wE(n,e,t=Ir){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(e,n):n[o];n[i++]=a}}}function aB(n,e,t,r){let s=r.get(B0,j0)||t===Vo.ShadowDom||t===Vo.ExperimentalIsolatedShadowDom,o=n.selectRootElement(e,s);return cB(o),o}function cB(n){uB(n)}var uB=()=>null;function lB(n,e,t,r,i,s){if(n.type&3){let o=Ir(n,e);r=s!=null?s(r,n.value||"",t):r,i.setProperty(o,t,r)}else n.type&12}function dB(n,e,t){let r=t.directiveStart,i=t.directiveEnd;Po(t)&&Bj(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||T0(t,e);let s=t.initialInputs;for(let o=r;o<i;o++){let a=n.data[o],c=RI(e,n,o,t);if(Mc(c,e),s!==null&&mB(e,o-r,c,a,t,s),xo(a)){let d=Er(t.index,e);d[st]=RI(e,n,o,t)}}}function hB(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=TR();try{os(s);for(let a=r;a<i;a++){let c=n.data[a],d=e[a];Lp(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&fB(c,d)}}finally{os(-1),Lp(o)}}function fB(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function pB(n,e){let t=n.directiveRegistry,r=null;if(t)for(let i=0;i<t.length;i++){let s=t[i];kj(e,s.selectors,!1)&&(r??=[],xo(s)?r.unshift(s):r.push(s))}return r}function mB(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;a+=2){let c=o[a],d=o[a+1];$I(r,t,c,d)}}function pN(n,e,t,r,i){let s=Ft+t,o=e[de],a=i(o,e,n,r,t);e[s]=a,Rc(n,!0);let c=n.type===2;return c?(tN(e[ft],a,n),(dR()===0||kp(n))&&Mc(a,e),hR()):Mc(a,e),jp()&&(!c||!cE(n))&&IE(o,e,a,n),n}function mN(n){let e=n;return aI()?_R():(e=e.parent,Rc(e,!1)),e}function gB(n,e){let t=n[Zr];if(!t)return;let r;try{r=t.get(as,null)}catch{r=null}r?.(e)}function gN(n,e,t,r,i){let s=n.inputs?.[r],o=n.hostDirectiveInputs?.[r],a=!1;if(o)for(let c=0;c<o.length;c+=2){let d=o[c],h=o[c+1],f=e.data[d];$I(f,t[d],h,i),a=!0}if(s)for(let c of s){let d=t[c],h=e.data[c];$I(h,d,r,i),a=!0}return a}function yB(n,e){let t=Er(e,n),r=t[de];_B(r,t);let i=t[Qn];i!==null&&t[Sc]===null&&(t[Sc]=$0(i,t[Zr])),$e(Me.ComponentStart);try{TE(r,t,t[st])}finally{$e(Me.ComponentEnd,t[st])}}function _B(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function TE(n,e,t){Fp(e);try{let r=n.viewQuery;r!==null&&kI(1,r,t);let i=n.template;i!==null&&hN(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[Ro]?.finishViewCreation(n),n.staticContentQueries&&q0(n,e),n.staticViewQueries&&kI(2,n.viewQuery,t);let s=n.components;s!==null&&vB(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[pe]&=-5,Up()}}function vB(n,e){for(let t=0;t<e.length;t++)yB(n,e[t])}function bE(n,e,t,r){let i=ie(null);try{let s=e.tView,a=n[pe]&4096?4096:16,c=fE(n,s,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),d=n[e.index];c[Co]=d;let h=n[Ro];return h!==null&&(c[Ro]=h.createEmbeddedView(s)),TE(s,c,t),c}finally{ie(i)}}function md(n,e){return!e||e.firstChild===null||P0(n)}function gd(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let s=e[t.index];s!==null&&r.push(Vn(s)),Yn(s)&&yN(s,r);let o=t.type;if(o&8)gd(n,e,t.child,r);else if(o&32){let a=mE(t,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=dN(e,t);if(Array.isArray(a))r.push(...a);else{let c=ns(e[wn]);gd(c[de],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function yN(n,e){for(let t=ot;t<n.length;t++){let r=n[t],i=r[de].firstChild;i!==null&&gd(r[de],r,i,e)}n[ss]!==n[Qn]&&e.push(n[ss])}function _N(n){if(n[xp]!==null){for(let e of n[xp])e.impl.addSequence(e);n[xp].length=0}}var vN=[];function IB(n){return n[Tn]??EB(n)}function EB(n){let e=vN.pop()??Object.create(TB);return e.lView=n,e}function wB(n){n.lView[Tn]!==n&&(n.lView=null,vN.push(n))}var TB=qt(et({},jl),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{cd(n.lView)},consumerOnSignalRead(){this.lView[Tn]=this}});function bB(n){let e=n[Tn]??Object.create(SB);return e.lView=n,e}var SB=qt(et({},jl),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=ns(n.lView);for(;e&&!IN(e[de]);)e=ns(e);e&&tI(e)},consumerOnSignalRead(){this.lView[Tn]=this}});function IN(n){return n.type!==2}function EN(n){if(n[rd]===null)return;let e=!0;for(;e;){let t=!1;for(let r of n[rd])r.dirty&&(t=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=t&&!!(n[pe]&8192)}}var AB=100;function wN(n,e=0){let r=n[vr].rendererFactory,i=!1;i||r.begin?.();try{CB(n,e)}finally{i||r.end?.()}}function CB(n,e){let t=cI();try{uI(!0),HI(n,e);let r=0;for(;ad(n);){if(r===AB)throw new ke(103,!1);r++,HI(n,1)}}finally{uI(t)}}function DB(n,e,t,r){if(ko(e))return;let i=e[pe],s=!1,o=!1;Fp(e);let a=!0,c=null,d=null;s||(IN(n)?(d=IB(e),c=$l(d)):$f()===null?(a=!1,d=bB(e),c=$l(d)):e[Tn]&&(ql(e[Tn]),e[Tn]=null));try{eI(e),IR(n.bindingStartIndex),t!==null&&hN(n,e,t,2,r);let h=(i&3)===3;if(!s)if(h){let w=n.preOrderCheckHooks;w!==null&&Wp(e,w,null)}else{let w=n.preOrderHooks;w!==null&&Kp(e,w,0,null),EI(e,0)}if(o||RB(e),EN(e),TN(e,0),n.contentQueries!==null&&q0(n,e),!s)if(h){let w=n.contentCheckHooks;w!==null&&Wp(e,w)}else{let w=n.contentHooks;w!==null&&Kp(e,w,1),EI(e,1)}PB(n,e);let f=n.components;f!==null&&SN(e,f,0);let y=n.viewQuery;if(y!==null&&kI(2,y,r),!s)if(h){let w=n.viewCheckHooks;w!==null&&Wp(e,w)}else{let w=n.viewHooks;w!==null&&Kp(e,w,2),EI(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Pp]){for(let w of e[Pp])w();e[Pp]=null}s||(_N(e),e[pe]&=-73)}catch(h){throw s||cd(e),h}finally{d!==null&&(qf(d,c),a&&wB(d)),Up()}}function TN(n,e){for(let t=k0(n);t!==null;t=M0(t))for(let r=ot;r<t.length;r++){let i=t[r];bN(i,e)}}function RB(n){for(let e=k0(n);e!==null;e=M0(e)){if(!(e[pe]&2))continue;let t=e[sd];for(let r=0;r<t.length;r++){let i=t[r];tI(i)}}}function NB(n,e,t){$e(Me.ComponentStart);let r=Er(e,n);try{bN(r,t)}finally{$e(Me.ComponentEnd,r[st])}}function bN(n,e){Mp(n)&&HI(n,e)}function HI(n,e){let r=n[de],i=n[pe],s=n[Tn],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&Hf(s)),o||=!1,s&&(s.dirty=!1),n[pe]&=-9217,o)DB(r,n,r.template,n[st]);else if(i&8192){let a=ie(null);try{EN(n),TN(n,1);let c=r.components;c!==null&&SN(n,c,1),_N(n)}finally{ie(a)}}}function SN(n,e,t){for(let r=0;r<e.length;r++)NB(n,e[r],t)}function PB(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)os(~i);else{let s=i,o=t[++r],a=t[++r];wR(o,s);let c=e[s];$e(Me.HostBindingsUpdateStart,c);try{a(2,c)}finally{$e(Me.HostBindingsUpdateEnd,c)}}}}finally{os(-1)}}function SE(n,e){let t=cI()?64:1088;for(n[vr].changeDetectionScheduler?.notify(e);n;){n[pe]|=t;let r=ns(n);if(Dc(n)&&!r)return n;n=r}return null}function AN(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function CN(n,e){let t=ot+e;if(t<n.length)return n[t]}function _m(n,e,t,r=!0){let i=e[de];if(xB(i,e,n,t),r){let o=qI(t,n),a=e[ft],c=a.parentNode(n[ss]);c!==null&&Kj(i,n[On],a,e,c,o)}let s=e[Sc];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function DN(n,e){let t=yd(n,e);return t!==void 0&&gm(t[de],t),t}function yd(n,e){if(n.length<=ot)return;let t=ot+e,r=n[t];if(r){let i=r[Co];i!==null&&i!==n&&vE(i,r),e>0&&(n[t-1][Mn]=r[Mn]);let s=td(n,ot+e);Wj(r[de],r);let o=s[Ro];o!==null&&o.detachView(s[de]),r[xt]=null,r[Mn]=null,r[pe]&=-129}return r}function xB(n,e,t,r){let i=ot+r,s=t.length;r>0&&(t[i-1][Mn]=e),r<s-ot?(e[Mn]=t[i],$v(t,ot+r,e)):(t.push(e),e[Mn]=null),e[xt]=t;let o=e[Co];o!==null&&t!==o&&RN(o,e);let a=e[Ro];a!==null&&a.insertView(n),Op(e),e[pe]|=128}function RN(n,e){let t=n[sd],r=e[xt];if(ti(r))n[pe]|=2;else{let i=r[xt][wn];e[wn]!==i&&(n[pe]|=2)}t===null?n[sd]=[e]:t.push(e)}var Lo=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[de];return gd(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[st]}set context(e){this._lView[st]=e}get destroyed(){return ko(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[xt];if(Yn(e)){let t=e[id],r=t?t.indexOf(this):-1;r>-1&&(yd(e,r),td(t,r))}this._attachedToViewContainer=!1}gm(this._lView[de],this._lView)}onDestroy(e){nI(this._lView,e)}markForCheck(){SE(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[pe]&=-129}reattach(){Op(this._lView),this._lView[pe]|=128}detectChanges(){this._lView[pe]|=1024,wN(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ke(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Dc(this._lView),t=this._lView[Co];t!==null&&!e&&vE(t,this._lView),lN(this._lView[de],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ke(902,!1);this._appRef=e;let t=Dc(this._lView),r=this._lView[Co];r!==null&&!t&&RN(r,this._lView),Op(this._lView)}};function vm(n,e,t,r,i){let s=n.data[e];if(s===null)s=kB(n,e,t,r,i),ER()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=yR();s.injectorIndex=o===null?-1:o.injectorIndex}return Rc(s,!0),s}function kB(n,e,t,r,i){let s=oI(),o=aI(),a=o?s:s&&s.parent,c=n.data[e]=OB(n,a,t,e,r,i);return MB(n,c,s,o),c}function MB(n,e,t,r){n.firstChild===null&&(n.firstChild=e),t!==null&&(r?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function OB(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return pR()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,fieldIndex:-1,customControlIndex:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function VB(n){let e=n[Jv]??[],r=n[xt][ft],i=[];for(let s of e)s.data[U0]!==void 0?i.push(s):LB(s,r);n[Jv]=i}function LB(n,e){let t=0,r=n.firstChild;if(r){let i=n.data[F0];for(;t<i;){let s=r.nextSibling;eN(e,r,!1),r=s,t++}}}var FB=()=>null,UB=()=>null;function zI(n,e){return FB(n,e)}function NN(n,e,t){return UB(n,e,t)}var PN=class{},Im=class{},GI=class{resolveComponentFactory(e){throw new ke(917,!1)}},wd=class{static NULL=new GI},_d=class{};var xN=(()=>{class n{static \u0275prov=Qe({token:n,providedIn:"root",factory:()=>null})}return n})();var Qp={},WI=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){let i=this.injector.get(e,Qp,r);return i!==Qp||t===Qp?i:this.parentInjector.get(e,t,r)}};function tm(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=Tp(i,a);else if(s==2){let c=a,d=e[++o];r=Tp(r,c+": "+d+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}function kN(n,e=0){let t=Le();if(t===null)return zt(n,e);let r=Tr();return C0(r,t,ln(n),e)}function jB(n,e,t,r,i){let s=r===null?null:{"":-1},o=i(n,t);if(o!==null){let a=o,c=null,d=null;for(let h of o)if(h.resolveHostDirectives!==null){[a,c,d]=h.resolveHostDirectives(o);break}qB(n,e,t,a,s,c,d)}s!==null&&r!==null&&BB(t,r,s)}function BB(n,e,t){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new ke(-301,!1);r.push(e[i],s)}}function $B(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function qB(n,e,t,r,i,s,o){let a=r.length,c=null;for(let y=0;y<a;y++){let w=r[y];c===null&&xo(w)&&(c=w,$B(n,t,y)),OU(T0(t,e),n,w.type)}QB(t,n.data.length,a),c?.viewProvidersResolver&&c.viewProvidersResolver(c);for(let y=0;y<a;y++){let w=r[y];w.providersResolver&&w.providersResolver(w)}let d=!1,h=!1,f=oN(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let y=0;y<a;y++){let w=r[y];if(t.mergedAttrs=hm(t.mergedAttrs,w.hostAttrs),zB(n,t,e,f,w),KB(f,w,i),o!==null&&o.has(w)){let[N,P]=o.get(w);t.directiveToIndex.set(w.type,[f,N+t.directiveStart,P+t.directiveStart])}else(s===null||!s.has(w))&&t.directiveToIndex.set(w.type,f);w.contentQueries!==null&&(t.flags|=4),(w.hostBindings!==null||w.hostAttrs!==null||w.hostVars!==0)&&(t.flags|=64);let R=w.type.prototype;!d&&(R.ngOnChanges||R.ngOnInit||R.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),d=!0),!h&&(R.ngOnChanges||R.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),h=!0),f++}HB(n,t,s)}function HB(n,e,t){for(let r=e.directiveStart;r<e.directiveEnd;r++){let i=n.data[r];if(t===null||!t.has(i))n0(0,e,i,r),n0(1,e,i,r),i0(e,r,!1);else{let s=t.get(i);r0(0,e,s,r),r0(1,e,s,r),i0(e,r,!0)}}}function n0(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let s in i)if(i.hasOwnProperty(s)){let o;n===0?o=e.inputs??={}:o=e.outputs??={},o[s]??=[],o[s].push(r),MN(e,s)}}function r0(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let s in i)if(i.hasOwnProperty(s)){let o=i[s],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[o]??=[],a[o].push(r,s),MN(e,o)}}function MN(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function i0(n,e,t){let{attrs:r,inputs:i,hostDirectiveInputs:s}=n;if(r===null||!t&&i===null||t&&s===null||dE(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let o=null,a=0;for(;a<r.length;){let c=r[a];if(c===0){a+=4;continue}else if(c===5){a+=2;continue}else if(typeof c=="number")break;if(!t&&i.hasOwnProperty(c)){let d=i[c];for(let h of d)if(h===e){o??=[],o.push(c,r[a+1]);break}}else if(t&&s.hasOwnProperty(c)){let d=s[c];for(let h=0;h<d.length;h+=2)if(d[h]===e){o??=[],o.push(d[h+1],r[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(o)}function zB(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=Eo(i.type,!0)),o=new fd(s,xo(i),kN,null);n.blueprint[r]=o,t[r]=o,GB(n,e,r,oN(n,t,i.hostVars,bn),i)}function GB(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;WB(o)!=a&&o.push(a),o.push(t,r,s)}}function WB(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function KB(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;xo(e)&&(t[""]=n)}}function QB(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function ON(n,e,t,r,i,s,o,a){let c=e[de],d=c.consts,h=wr(d,o),f=vm(c,n,t,r,h);return s&&jB(c,e,f,wr(d,a),i),f.mergedAttrs=hm(f.mergedAttrs,f.attrs),f.attrs!==null&&tm(f,f.attrs,!1),f.mergedAttrs!==null&&tm(f,f.mergedAttrs,!0),c.queries!==null&&c.queries.elementStart(c,f),f}function VN(n,e){bU(n,e),Xv(e)&&n.queries.elementEnd(e)}function YB(n,e,t,r,i,s){let o=e.consts,a=wr(o,i),c=vm(e,n,t,r,a);if(c.mergedAttrs=hm(c.mergedAttrs,c.attrs),s!=null){let d=wr(o,s);c.localNames=[];for(let h=0;h<d.length;h+=2)c.localNames.push(d[h],-1)}return c.attrs!==null&&tm(c,c.attrs,!1),c.mergedAttrs!==null&&tm(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function cs(n,e,t){if(t===bn)return!1;let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function JB(n,e,t,r){let i=cs(n,e,t);return cs(n,e+1,r)||i}function XB(n,e,t){return function r(i){let s=Po(n)?Er(n.index,e):e;SE(s,5);let o=e[st],a=s0(e,o,t,i),c=r.__ngNextListenerFn__;for(;c;)a=s0(e,o,c,i)&&a,c=c.__ngNextListenerFn__;return a}}function s0(n,e,t,r){let i=ie(null);try{return $e(Me.OutputStart,e,t),t(r)!==!1}catch(s){return gB(n,s),!1}finally{$e(Me.OutputEnd,e,t),ie(i)}}function ZB(n,e,t,r,i,s,o,a){let c=kp(n),d=!1,h=null;if(!r&&c&&(h=t4(e,t,s,n.index)),h!==null){let f=h.__ngLastListenerFn__||h;f.__ngNextListenerFn__=o,h.__ngLastListenerFn__=o,d=!0}else{let f=Ir(n,t),y=r?r(f):f;JU(t,y,s,a);let w=i.listen(y,s,a);if(!e4(s)){let R=r?N=>r(Vn(N[n.index])):n.index;n4(R,e,t,s,a,w,!1)}}return d}function e4(n){return n.startsWith("animation")||n.startsWith("transition")}function t4(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let a=e[Ac],c=i[s+2];return a&&a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function n4(n,e,t,r,i,s,o){let a=e.firstCreatePass?lR(e):null,c=uR(t),d=c.length;c.push(i,s),a&&a.push(r,n,d,(d+1)*(o?-1:1))}var KI=Symbol("BINDING");var nm=class extends wd{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=rs(e);return new Oc(t,this.ngModule)}};function r4(n){return Object.keys(n).map(e=>{let[t,r,i]=n[e],s={propName:t,templateName:e,isSignal:(r&mm.SignalBased)!==0};return i&&(s.transform=i),s})}function i4(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function s4(n,e,t){let r=e instanceof hn?e:e?.injector;return r&&n.getStandaloneInjector!==null&&(r=n.getStandaloneInjector(r)||r),r?new WI(t,r):t}function o4(n){let e=n.get(_d,null);if(e===null)throw new ke(407,!1);let t=n.get(xN,null),r=n.get(To,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:r,ngReflect:!1}}function a4(n,e){let t=LN(n);return X0(e,t,t==="svg"?iR:t==="math"?sR:null)}function LN(n){return(n.selectors[0][0]||"div").toLowerCase()}var Oc=class extends Im{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=r4(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=i4(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=Lj(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,r,i,s,o){$e(Me.DynamicComponentStart);let a=ie(null);try{let c=this.componentDef,d=c4(r,c,o,s),h=s4(c,i||this.ngModule,e),f=o4(h),y=f.rendererFactory.createRenderer(null,c),w=r?aB(y,r,c.encapsulation,h):a4(c,y),R=o?.some(o0)||s?.some(F=>typeof F!="function"&&F.bindings.some(o0)),N=fE(null,d,null,512|sN(c),null,null,f,y,h,null,$0(w,h,!0));N[Ft]=w,Fp(N);let P=null;try{let F=ON(Ft,N,2,"#host",()=>d.directiveRegistry,!0,0);tN(y,w,F),Mc(w,N),fN(d,N,F),H0(d,F,N),VN(d,F),t!==void 0&&l4(F,this.ngContentSelectors,t),P=Er(F.index,N),N[st]=P[st],TE(d,N,null)}catch(F){throw P!==null&&PI(P),PI(N),F}finally{$e(Me.DynamicComponentEnd),Up()}return new rm(this.componentType,N,!!R)}finally{ie(a)}}};function c4(n,e,t,r){let i=n?["ng-version","21.1.4"]:Fj(e.selectors[0]),s=null,o=null,a=0;if(t)for(let h of t)a+=h[KI].requiredVars,h.create&&(h.targetIdx=0,(s??=[]).push(h)),h.update&&(h.targetIdx=0,(o??=[]).push(h));if(r)for(let h=0;h<r.length;h++){let f=r[h];if(typeof f!="function")for(let y of f.bindings){a+=y[KI].requiredVars;let w=h+1;y.create&&(y.targetIdx=w,(s??=[]).push(y)),y.update&&(y.targetIdx=w,(o??=[]).push(y))}}let c=[e];if(r)for(let h of r){let f=typeof h=="function"?h:h.type,y=Uv(f);c.push(y)}return hE(0,null,u4(s,o),1,a,c,null,null,null,[i],null)}function u4(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let r of n)r.create();if(t&2&&e)for(let r of e)r.update()}}function o0(n){let e=n[KI].kind;return e==="input"||e==="twoWay"}var rm=class extends PN{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,r){super(),this._rootLView=t,this._hasInputBindings=r,this._tNode=od(t[de],Ft),this.location=sE(this._tNode,t),this.instance=Er(this._tNode.index,t)[st],this.hostView=this.changeDetectorRef=new Lo(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let i=this._rootLView,s=gN(r,i[de],i,e,t);this.previousInputValues.set(e,t);let o=Er(r.index,i);SE(o,1)}get injector(){return new Oo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function l4(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null&&s.length?Array.from(s):null)}}var FN=(()=>{class n{static __NG_ELEMENT_ID__=d4}return n})();function d4(){let n=Tr();return f4(n,Le())}var h4=FN,UN=class extends h4{_lContainer;_hostTNode;_hostLView;constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return sE(this._hostTNode,this._hostLView)}get injector(){return new Oo(this._hostTNode,this._hostLView)}get parentInjector(){let e=iE(this._hostTNode,this._hostLView);if(I0(e)){let t=Xp(e,this._hostLView),r=Jp(e),i=t[de].data[r+8];return new Oo(i,t)}else return new Oo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=a0(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-ot}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=zI(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,md(this._hostTNode,o)),a}createComponent(e,t,r,i,s,o,a){let c=e&&!_U(e),d;if(c)d=t;else{let P=t||{};d=P.index,r=P.injector,i=P.projectableNodes,s=P.environmentInjector||P.ngModuleRef,o=P.directives,a=P.bindings}let h=c?e:new Oc(rs(e)),f=r||this.parentInjector;if(!s&&h.ngModule==null){let F=(c?f:this.parentInjector).get(hn,null);F&&(s=F)}let y=rs(h.componentType??{}),w=zI(this._lContainer,y?.id??null),R=w?.firstChild??null,N=h.create(f,i,R,s,o,a);return this.insertImpl(N.hostView,d,md(this._hostTNode,w)),N}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(oR(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[xt],d=new UN(c,c[On],c[xt]);d.detach(d.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return _m(o,i,s,r),e.attachToViewContainerRef(),$v(bI(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=a0(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=yd(this._lContainer,t);r&&(td(bI(this._lContainer),t),gm(r[de],r))}detach(e){let t=this._adjustIndex(e,-1),r=yd(this._lContainer,t);return r&&td(bI(this._lContainer),t)!=null?new Lo(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function a0(n){return n[id]}function bI(n){return n[id]||(n[id]=[])}function f4(n,e){let t,r=e[n.index];return Yn(r)?t=r:(t=AN(r,e,null,n),e[n.index]=t,pE(e,t)),m4(t,e,n,r),new UN(t,n,e)}function p4(n,e){let t=n[ft],r=t.createComment(""),i=Ir(e,n),s=t.parentNode(i);return Zp(t,s,r,t.nextSibling(i),!1),r}var m4=_4,g4=()=>!1;function y4(n,e,t){return g4(n,e,t)}function _4(n,e,t,r){if(n[ss])return;let i;t.type&8?i=Vn(r):i=p4(e,t),n[ss]=i}var Vc=class{},jN=class{};var im=class extends Vc{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new nm(this);constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t;let s=Fv(e);this._bootstrapComponents=rN(s.bootstrap),this._r3Injector=fI(e,t,[{provide:Vc,useValue:this},{provide:wd,useValue:this.componentFactoryResolver},...r],Jr(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},sm=class extends jN{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new im(this.moduleType,e,[])}};var vd=class extends Vc{injector;componentFactoryResolver=new nm(this);instance=null;constructor(e){super();let t=new wo([...e.providers,{provide:Vc,useValue:this},{provide:wd,useValue:this.componentFactoryResolver}],e.parent||nd(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function BN(n,e,t=null){return new vd({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var v4=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=Gv(!1,t.type),i=r.length>0?BN([r],this._injector,""):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=Qe({token:n,providedIn:"environment",factory:()=>new n(zt(hn))})}return n})();function I4(n){return Fc(()=>{let e=$N(n),t=qt(et({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===oE.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get(v4).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Vo.Emulated,styles:n.styles||dn,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&Uo("NgStandalone"),qN(t);let r=n.dependencies;return t.directiveDefs=c0(r,E4),t.pipeDefs=c0(r,zD),t.id=S4(t),t})}function E4(n){return rs(n)||Uv(n)}function AE(n){return Fc(()=>({type:n.type,bootstrap:n.bootstrap||dn,declarations:n.declarations||dn,imports:n.imports||dn,exports:n.exports||dn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function w4(n,e){if(n==null)return So;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,a,c;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s,c=i[3]||null):(s=i,o=i,a=mm.None,c=null),t[s]=[r,a,c],e[s]=o}return t}function T4(n){if(n==null)return So;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function b4(n){return Fc(()=>{let e=$N(n);return qN(e),e})}function $N(n){let e={};return{type:n.type,providersResolver:null,viewProvidersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||So,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||dn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:w4(n.inputs,e),outputs:T4(n.outputs),debugInfo:null}}function qN(n){n.features?.forEach(e=>e(n))}function c0(n,e){return n?()=>{let t=typeof n=="function"?n():n,r=[];for(let i of t){let s=e(i);s!==null&&r.push(s)}return r}:null}function S4(n){let e=0,t=typeof n.consts=="function"?"":n.consts,r=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let s of r.join("|"))e=Math.imul(31,e)+s.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function A4(n,e,t,r,i,s,o,a){if(t.firstCreatePass){n.mergedAttrs=hm(n.mergedAttrs,n.attrs);let h=n.tView=hE(2,n,i,s,o,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),h.queries=t.queries.embeddedTView(n))}a&&(n.flags|=a),Rc(n,!1);let c=C4(t,e,n,r);jp()&&IE(t,e,c,n),Mc(c,e);let d=AN(c,e,c,n);e[r+Ft]=d,pE(e,d),y4(d,n,e)}function om(n,e,t,r,i,s,o,a,c,d,h){let f=t+Ft,y;if(e.firstCreatePass){if(y=vm(e,f,4,o||null,a||null),d!=null){let w=wr(e.consts,d);y.localNames=[];for(let R=0;R<w.length;R+=2)y.localNames.push(w[R],-1)}}else y=e.data[f];return A4(y,n,e,t,r,i,s,c),d!=null&&wE(n,y,h),y}var C4=D4;function D4(n,e,t,r){return Bp(!0),e[ft].createComment("")}var R4=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var HN=new be("");function CE(n){return!!n&&typeof n.then=="function"}function zN(n){return!!n&&typeof n.subscribe=="function"}var GN=new be("");var DE=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r});appInits=se(GN,{optional:!0})??[];injector=se(En);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let s=is(this.injector,i);if(CE(s))t.push(s);else if(zN(s)){let o=new Promise((a,c)=>{s.subscribe({complete:a,error:c})});t.push(o)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),WN=new be("");function KN(){W_(()=>{let n="";throw new ke(600,n)})}function QN(n){return n.isBoundToModule}var N4=10;var Em=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=se(as);afterRenderManager=se(cN);zonelessEnabled=se(ld);rootEffectScheduler=se(vI);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new yr;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=se(Mo);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(un(t=>!t))}constructor(){se(yE,{optional:!0})}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}_injector=se(hn);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,r){return this.bootstrapImpl(t,r)}bootstrapImpl(t,r,i=En.NULL){return this._injector.get(Lt).run(()=>{$e(Me.BootstrapComponentStart);let o=t instanceof Im;if(!this._injector.get(DE).done){let R="";throw new ke(405,R)}let c;o?c=t:c=this._injector.get(wd).resolveComponentFactory(t),this.componentTypes.push(c.componentType);let d=QN(c)?void 0:this._injector.get(Vc),h=r||c.selector,f=c.create(i,[],h,d),y=f.location.nativeElement,w=f.injector.get(HN,null);return w?.registerApplication(y),f.onDestroy(()=>{this.detachView(f.hostView),hd(this.components,f),w?.unregisterApplication(y)}),this._loadComponent(f),$e(Me.BootstrapComponentEnd,f),f})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){$e(Me.ChangeDetectionStart),this.tracingSnapshot!==null?this.tracingSnapshot.run(gE.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw $e(Me.ChangeDetectionEnd),new ke(101,!1);let t=ie(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,ie(t),this.afterTick.next(),$e(Me.ChangeDetectionEnd)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(_d,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<N4;){$e(Me.ChangeDetectionSyncStart);try{this.synchronizeOnce()}finally{$e(Me.ChangeDetectionSyncEnd)}}}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:i}of this.allViews){if(!r&&!ad(i))continue;let s=r&&!this.zonelessEnabled?0:1;wN(i,s),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>ad(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;hd(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(i){this.internalErrorHandler(i)}this.components.push(t),this._injector.get(WN,[]).forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>hd(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ke(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function hd(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}var CZ=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";var QI=class{destroy(e){}updateValue(e,t){}swap(e,t){let r=Math.min(e,t),i=Math.max(e,t),s=this.detach(i);if(i-r>1){let o=this.detach(r);this.attach(r,s),this.attach(i,o)}else this.attach(r,s)}move(e,t){this.attach(t,this.detach(e))}};function SI(n,e,t,r,i){return n===t&&Object.is(e,r)?1:Object.is(i(n,e),i(t,r))?-1:0}function P4(n,e,t,r){let i,s,o=0,a=n.length-1,c=void 0;if(Array.isArray(e)){ie(r);let d=e.length-1;for(ie(null);o<=a&&o<=d;){let h=n.at(o),f=e[o],y=SI(o,h,o,f,t);if(y!==0){y<0&&n.updateValue(o,f),o++;continue}let w=n.at(a),R=e[d],N=SI(a,w,d,R,t);if(N!==0){N<0&&n.updateValue(a,R),a--,d--;continue}let P=t(o,h),F=t(a,w),q=t(o,f);if(Object.is(q,F)){let $=t(d,R);Object.is($,P)?(n.swap(o,a),n.updateValue(a,R),d--,a--):n.move(a,o),n.updateValue(o,f),o++;continue}if(i??=new am,s??=l0(n,o,a,t),YI(n,i,o,q))n.updateValue(o,f),o++,a++;else if(s.has(q))i.set(P,n.detach(o)),a--;else{let $=n.create(o,e[o]);n.attach(o,$),o++,a++}}for(;o<=d;)u0(n,i,t,o,e[o]),o++}else if(e!=null){ie(r);let d=e[Symbol.iterator]();ie(null);let h=d.next();for(;!h.done&&o<=a;){let f=n.at(o),y=h.value,w=SI(o,f,o,y,t);if(w!==0)w<0&&n.updateValue(o,y),o++,h=d.next();else{i??=new am,s??=l0(n,o,a,t);let R=t(o,y);if(YI(n,i,o,R))n.updateValue(o,y),o++,a++,h=d.next();else if(!s.has(R))n.attach(o,n.create(o,y)),o++,a++,h=d.next();else{let N=t(o,f);i.set(N,n.detach(o)),a--}}}for(;!h.done;)u0(n,i,t,n.length,h.value),h=d.next()}for(;o<=a;)n.destroy(n.detach(a--));i?.forEach(d=>{n.destroy(d)})}function YI(n,e,t,r){return e!==void 0&&e.has(r)?(n.attach(t,e.get(r)),e.delete(r),!0):!1}function u0(n,e,t,r,i){if(YI(n,e,r,t(r,i)))n.updateValue(r,i);else{let s=n.create(r,i);n.attach(r,s)}}function l0(n,e,t,r){let i=new Set;for(let s=e;s<=t;s++)i.add(r(s,n.at(s)));return i}var am=class{kvMap=new Map;_vMap=void 0;has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let r=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let i=this._vMap;for(;i.has(r);)r=i.get(r);i.set(r,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,r]of this.kvMap)if(e(r,t),this._vMap!==void 0){let i=this._vMap;for(;i.has(r);)r=i.get(r),e(r,t)}}};function x4(n,e,t,r,i,s,o,a){Uo("NgControlFlow");let c=Le(),d=Jn(),h=wr(d.consts,s);return om(c,d,n,e,t,r,i,h,256,o,a),RE}function RE(n,e,t,r,i,s,o,a){Uo("NgControlFlow");let c=Le(),d=Jn(),h=wr(d.consts,s);return om(c,d,n,e,t,r,i,h,512,o,a),RE}function k4(n,e){Uo("NgControlFlow");let t=Le(),r=ud(),i=t[r]!==bn?t[r]:-1,s=i!==-1?cm(t,Ft+i):void 0,o=0;if(cs(t,r,n)){let a=ie(null);try{if(s!==void 0&&DN(s,o),n!==-1){let c=Ft+n,d=cm(t,c),h=eE(t[de],c),f=NN(d,h,t),y=bE(t,h,e,{dehydratedView:f});_m(d,y,o,md(h,f))}}finally{ie(a)}}else if(s!==void 0){let a=CN(s,o);a!==void 0&&(a[st]=e)}}var JI=class{lContainer;$implicit;$index;constructor(e,t,r){this.lContainer=e,this.$implicit=t,this.$index=r}get $count(){return this.lContainer.length-ot}};function M4(n,e){return e}var XI=class{hasEmptyBlock;trackByFn;liveCollection;constructor(e,t,r){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=r}};function O4(n,e,t,r,i,s,o,a,c,d,h,f,y){Uo("NgControlFlow");let w=Le(),R=Jn(),N=c!==void 0,P=Le(),F=a?o.bind(P[wn][st]):o,q=new XI(N,F);P[Ft+n]=q,om(w,R,n+1,e,t,r,i,wr(R.consts,s),256),N&&om(w,R,n+2,c,d,h,f,wr(R.consts,y),512)}var ZI=class extends QI{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(e,t,r){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=r}get length(){return this.lContainer.length-ot}at(e){return this.getLView(e)[st].$implicit}attach(e,t){let r=t[Sc];this.needsIndexUpdate||=e!==this.length,_m(this.lContainer,t,e,md(this.templateTNode,r)),L4(this.lContainer,e)}detach(e){return this.needsIndexUpdate||=e!==this.length-1,F4(this.lContainer,e),U4(this.lContainer,e)}create(e,t){let r=zI(this.lContainer,this.templateTNode.tView.ssrId);return bE(this.hostLView,this.templateTNode,new JI(this.lContainer,t,e),{dehydratedView:r})}destroy(e){gm(e[de],e)}updateValue(e,t){this.getLView(e)[st].$implicit=t}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[st].$index=e}getLView(e){return j4(this.lContainer,e)}};function V4(n){let e=ie(null),t=br();try{let r=Le(),i=r[de],s=r[t],o=t+1,a=cm(r,o);if(s.liveCollection===void 0){let d=eE(i,o);s.liveCollection=new ZI(a,r,d)}else s.liveCollection.reset();let c=s.liveCollection;if(P4(c,n,s.trackByFn,e),c.updateIndexes(),s.hasEmptyBlock){let d=ud(),h=c.length===0;if(cs(r,d,h)){let f=t+2,y=cm(r,f);if(h){let w=eE(i,f),R=NN(y,w,r),N=bE(r,w,void 0,{dehydratedView:R});_m(y,N,0,md(w,R))}else i.firstUpdatePass&&VB(y),DN(y,0)}}}finally{ie(e)}}function cm(n,e){return n[e]}function L4(n,e){if(n.length<=ot)return;let t=ot+e,r=n[t],i=r?r[No]:void 0;if(r&&i&&i.detachedLeaveAnimationFns&&i.detachedLeaveAnimationFns.length>0){let s=r[Zr];Hj(s,i),pd.delete(r[ei]),i.detachedLeaveAnimationFns=void 0}}function F4(n,e){if(n.length<=ot)return;let t=ot+e,r=n[t],i=r?r[No]:void 0;i&&i.leave&&i.leave.size>0&&(i.detachedLeaveAnimationFns=[])}function U4(n,e){return yd(n,e)}function j4(n,e){return CN(n,e)}function eE(n,e){return od(n,e)}function tE(n,e,t,r,i){gN(e,n,t,i?"class":"style",r)}function NE(n,e,t,r){let i=Le(),s=i[de],o=n+Ft,a=s.firstCreatePass?ON(o,i,2,e,pB,fR(),t,r):s.data[o];if(pN(a,i,n,e,XN),kp(a)){let c=i[de];fN(c,i,a),H0(c,a,i)}return r!=null&&wE(i,a),NE}function PE(){let n=Jn(),e=Tr(),t=mN(e);return n.firstCreatePass&&VN(n,t),iI(t)&&sI(),rI(),t.classesWithoutHost!=null&&AU(t)&&tE(n,t,Le(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&CU(t)&&tE(n,t,Le(),t.stylesWithoutHost,!1),PE}function YN(n,e,t,r){return NE(n,e,t,r),PE(),YN}function xE(n,e,t,r){let i=Le(),s=i[de],o=n+Ft,a=s.firstCreatePass?YB(o,s,2,e,t,r):s.data[o];return pN(a,i,n,e,XN),r!=null&&wE(i,a),xE}function kE(){let n=Tr(),e=mN(n);return iI(e)&&sI(),rI(),kE}function JN(n,e,t,r){return xE(n,e,t,r),kE(),JN}var XN=(n,e,t,r,i)=>(Bp(!0),X0(e[ft],r,NR()));function B4(){return Le()}function ZN(n,e,t){let r=Le(),i=ud();if(cs(r,i,e)){let s=Jn(),o=RR();lB(o,r,n,e,r[ft],t)}return ZN}var Td="en-US";var $4=Td;function eP(n){typeof n=="string"&&($4=n.toLowerCase().replace(/_/g,"-"))}function tP(n,e,t){let r=Le(),i=Jn(),s=Tr();return(s.type&3||t)&&ZB(s,i,r,t,r[ft],n,e,XB(s,r,e)),tP}function q4(n=1){return DR(n)}function Gp(n,e){return n<<17|e<<2}function Fo(n){return n>>17&32767}function H4(n){return(n&2)==2}function z4(n,e){return n&131071|e<<17}function nE(n){return n|2}function Lc(n){return(n&131068)>>2}function AI(n,e){return n&-131069|e<<2}function G4(n){return(n&1)===1}function rE(n){return n|1}function W4(n,e,t,r,i,s){let o=s?e.classBindings:e.styleBindings,a=Fo(o),c=Lc(o);n[r]=t;let d=!1,h;if(Array.isArray(t)){let f=t;h=f[1],(h===null||Tc(f,h)>0)&&(d=!0)}else h=t;if(i)if(c!==0){let y=Fo(n[a+1]);n[r+1]=Gp(y,a),y!==0&&(n[y+1]=AI(n[y+1],r)),n[a+1]=z4(n[a+1],r)}else n[r+1]=Gp(a,0),a!==0&&(n[a+1]=AI(n[a+1],r)),a=r;else n[r+1]=Gp(c,0),a===0?a=r:n[c+1]=AI(n[c+1],r),c=r;d&&(n[r+1]=nE(n[r+1])),d0(n,h,r,!0),d0(n,h,r,!1),K4(e,h,n,r,s),o=Gp(a,c),s?e.classBindings=o:e.styleBindings=o}function K4(n,e,t,r,i){let s=i?n.residualClasses:n.residualStyles;s!=null&&typeof e=="string"&&Tc(s,e)>=0&&(t[r+1]=rE(t[r+1]))}function d0(n,e,t,r){let i=n[t+1],s=e===null,o=r?Fo(i):Lc(i),a=!1;for(;o!==0&&(a===!1||s);){let c=n[o],d=n[o+1];Q4(c,e)&&(a=!0,n[o+1]=r?rE(d):nE(d)),o=r?Fo(d):Lc(d)}a&&(n[t+1]=r?nE(i):rE(i))}function Q4(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?Tc(n,e)>=0:!1}var en={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Y4(n){return n.substring(en.key,en.keyEnd)}function J4(n){return n.substring(en.value,en.valueEnd)}function X4(n){return Z4(n),nP(n,um(n,0,en.textEnd))}function nP(n,e){let t=en.textEnd,r=en.key=um(n,e,t);return t===r?-1:(r=en.keyEnd=e$(n,r,t),r=h0(n,r,t,58),r=en.value=um(n,r,t),r=en.valueEnd=t$(n,r,t),h0(n,r,t,59))}function Z4(n){en.key=0,en.keyEnd=0,en.value=0,en.valueEnd=0,en.textEnd=n.length}function um(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function e$(n,e,t){let r;for(;e<t&&((r=n.charCodeAt(e))===45||r===95||(r&-33)>=65&&(r&-33)<=90||r>=48&&r<=57);)e++;return e}function h0(n,e,t,r){return e=um(n,e,t),e<t&&e++,e}function t$(n,e,t){let r=-1,i=-1,s=-1,o=e,a=o;for(;o<t;){let c=n.charCodeAt(o++);if(c===59)return a;c===34||c===39?a=o=f0(n,c,o,t):e===o-4&&s===85&&i===82&&r===76&&c===40?a=o=f0(n,41,o,t):c>32&&(a=o),s=i,i=r,r=c&-33}return a}function f0(n,e,t,r){let i=-1,s=t;for(;s<r;){let o=n.charCodeAt(s++);if(o==e&&i!==92)return s;o==92&&i===92?i=0:i=o}throw new Error}function rP(n,e){return i$(n,e,null,!0),rP}function n$(n){s$(oP,r$,n,!1)}function r$(n,e){for(let t=X4(e);t>=0;t=nP(e,t))oP(n,Y4(e),J4(e))}function i$(n,e,t,r){let i=Le(),s=Jn(),o=Vp(2);if(s.firstUpdatePass&&sP(s,n,o,r),e!==bn&&cs(i,o,e)){let a=s.data[br()];aP(s,a,i,i[ft],n,i[o+1]=h$(e,t),r,o)}}function s$(n,e,t,r){let i=Jn(),s=Vp(2);i.firstUpdatePass&&sP(i,null,s,r);let o=Le();if(t!==bn&&cs(o,s,t)){let a=i.data[br()];if(cP(a,r)&&!iP(i,s)){let c=r?a.classesWithoutHost:a.stylesWithoutHost;c!==null&&(t=Tp(c,t||"")),tE(i,a,o,t,r)}else d$(i,a,o,o[ft],o[s+1],o[s+1]=l$(n,e,t),r,s)}}function iP(n,e){return e>=n.expandoStartIndex}function sP(n,e,t,r){let i=n.data;if(i[t+1]===null){let s=i[br()],o=iP(n,t);cP(s,r)&&e===null&&!o&&(e=!1),e=o$(i,s,e,r),W4(i,s,e,t,o,r)}}function o$(n,e,t,r){let i=bR(n),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=CI(null,n,e,t,r),t=Id(t,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||n[o]!==i)if(t=CI(i,n,e,t,r),s===null){let c=a$(n,e,r);c!==void 0&&Array.isArray(c)&&(c=CI(null,n,e,c[1],r),c=Id(c,e.attrs,r),c$(n,e,r,c))}else s=u$(n,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),t}function a$(n,e,t){let r=t?e.classBindings:e.styleBindings;if(Lc(r)!==0)return n[Fo(r)]}function c$(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[Fo(i)]=r}function u$(n,e,t){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=n[s].hostAttrs;r=Id(r,o,t)}return Id(r,e.attrs,t)}function CI(n,e,t,r,i){let s=null,o=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<o&&(s=e[a],r=Id(r,s.hostAttrs,i),s!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function Id(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),qv(n,o,t?!0:e[++s]))}return n===void 0?null:n}function l$(n,e,t){if(t==null||t==="")return dn;let r=[],i=Uc(t);if(Array.isArray(i))for(let s=0;s<i.length;s++)n(r,i[s],!0);else if(i instanceof Set)for(let s of i)n(r,s,!0);else if(typeof i=="object")for(let s in i)i.hasOwnProperty(s)&&n(r,s,i[s]);else typeof i=="string"&&e(r,i);return r}function oP(n,e,t){qv(n,e,Uc(t))}function d$(n,e,t,r,i,s,o,a){i===bn&&(i=dn);let c=0,d=0,h=0<i.length?i[0]:null,f=0<s.length?s[0]:null;for(;h!==null||f!==null;){let y=c<i.length?i[c+1]:void 0,w=d<s.length?s[d+1]:void 0,R=null,N;h===f?(c+=2,d+=2,y!==w&&(R=f,N=w)):f===null||h!==null&&h<f?(c+=2,R=h):(d+=2,R=f,N=w),R!==null&&aP(n,e,t,r,R,N,o,a),h=c<i.length?i[c]:null,f=d<s.length?s[d]:null}}function aP(n,e,t,r,i,s,o,a){if(!(e.type&3))return;let c=n.data,d=c[a+1],h=G4(d)?p0(c,e,t,i,Lc(d),o):void 0;if(!lm(h)){lm(s)||H4(d)&&(s=p0(c,null,t,i,a,o));let f=Zv(br(),t);oB(r,o,f,i,s)}}function p0(n,e,t,r,i,s){let o=e===null,a;for(;i>0;){let c=n[i],d=Array.isArray(c),h=d?c[1]:c,f=h===null,y=t[i+1];y===bn&&(y=f?dn:void 0);let w=f?Np(y,r):h===r?y:void 0;if(d&&!lm(w)&&(w=Np(c,r)),lm(w)&&(a=w,o))return a;let R=n[i+1];i=o?Fo(R):Lc(R)}if(e!==null){let c=s?e.residualClasses:e.residualStyles;c!=null&&(a=Np(c,r))}return a}function lm(n){return n!==void 0}function h$(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=Jr(Uc(n)))),n}function cP(n,e){return(n.flags&(e?8:16))!==0}function f$(n,e=""){let t=Le(),r=Jn(),i=n+Ft,s=r.firstCreatePass?vm(r,i,1,e,null):r.data[i],o=p$(r,t,s,e);t[i]=o,jp()&&IE(r,t,o,s),Rc(s,!1)}var p$=(n,e,t,r)=>(Bp(!0),wj(e[ft],r));function uP(n,e,t,r=""){return cs(n,ud(),t)?e+wc(t)+r:bn}function m$(n,e,t,r,i,s=""){let o=vR(),a=JB(n,o,t,i);return Vp(2),a?e+wc(t)+r+wc(i)+s:bn}function lP(n){return ME("",n),lP}function ME(n,e,t){let r=Le(),i=uP(r,n,e,t);return i!==bn&&hP(r,br(),i),ME}function dP(n,e,t,r,i){let s=Le(),o=m$(s,n,e,t,r,i);return o!==bn&&hP(s,br(),o),dP}function hP(n,e,t){let r=Zv(e,n);Tj(n[ft],r,t)}function g$(n,e,t=""){return uP(Le(),n,e,t)}var dm=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},y$=(()=>{class n{compileModuleSync(t){return new sm(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=Fv(t),s=rN(i.declarations).reduce((o,a)=>{let c=rs(a);return c&&o.push(new Oc(c)),o},[]);return new dm(r,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var fP=(()=>{class n{applicationErrorHandler=se(as);appRef=se(Em);taskService=se(Mo);ngZone=se(Lt);zonelessEnabled=se(ld);tracing=se(yE,{optional:!0});zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Vt;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Xl):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(se(_I,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{let t=this.taskService.add();if(!this.runningTick&&(this.cleanup(),!this.zonelessEnabled||this.appRef.includeAllTestViews)){this.taskService.remove(t);return}this.switchToMicrotaskScheduler(),this.taskService.remove(t)})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()}))}switchToMicrotaskScheduler(){this.ngZone.runOutsideAngular(()=>{let t=this.taskService.add();this.useMicrotaskScheduler=!0,queueMicrotask(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})})}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2;break}case 12:{this.appRef.dirtyFlags|=16;break}case 13:{this.appRef.dirtyFlags|=2;break}case 11:break;default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?MR:pI;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Xl+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){this.applicationErrorHandler(r)}finally{this.taskService.remove(t),this.cleanup()}}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function _$(){return Uo("NgZoneless"),Xr([...OE(),[]])}function OE(){return[{provide:To,useExisting:fP},{provide:Lt,useClass:Zl},{provide:ld,useValue:!0}]}function v$(){return typeof $localize<"u"&&$localize.locale||Td}var VE=new be("",{factory:()=>se(VE,{optional:!0,skipSelf:!0})||v$()});function I$(n,e){return zf(n,e?.equal)}var mP=Symbol("InputSignalNode#UNSET"),b$=qt(et({},Gf),{transformFn:void 0,applyValueToInputSignal(n,e){Hl(n,e)}});function gP(n,e){let t=Object.create(b$);t.value=n,t.transformFn=e?.transform;function r(){if(Bl(t),t.value===mP){let i=null;throw new ke(-950,i)}return t.value}return r[an]=t,r}function pP(n,e){return gP(n,e)}function S$(n){return gP(mP,n)}var poe=(pP.required=S$,pP);var LE=new be(""),A$=new be("");function bd(n){return!n.moduleRef}function C$(n){let e=bd(n)?n.r3Injector:n.moduleRef.injector,t=e.get(Lt);return t.run(()=>{bd(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(as),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:r})}),bd(n)){let s=()=>e.destroy(),o=n.platformInjector.get(LE);o.add(s),e.onDestroy(()=>{i.unsubscribe(),o.delete(s)})}else{let s=()=>n.moduleRef.destroy(),o=n.platformInjector.get(LE);o.add(s),n.moduleRef.onDestroy(()=>{hd(n.allPlatformModules,n.moduleRef),i.unsubscribe(),o.delete(s)})}return R$(r,t,()=>{let s=e.get(Mo),o=s.add(),a=e.get(DE);return a.runInitializers(),a.donePromise.then(()=>{let c=e.get(VE,Td);if(eP(c||Td),!e.get(A$,!0))return bd(n)?e.get(Em):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(bd(n)){let h=e.get(Em);return n.rootComponent!==void 0&&h.bootstrap(n.rootComponent),h}else return D$?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>{s.remove(o)})})})}var D$;function R$(n,e,t){try{let r=t();return CE(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n(r)),r}}var wm=null;function N$(n=[],e){return En.create({name:e,providers:[{provide:Kv,useValue:"platform"},{provide:LE,useValue:new Set([()=>wm=null])},...n]})}function P$(n=[]){if(wm)return wm;let e=N$(n);return wm=e,KN(),x$(e),e}function x$(n){let e=n.get(L0,null);is(n,()=>{e?.forEach(t=>t())})}function FE(){return!1}var k$=1e4;var moe=k$-1e3;var goe=(()=>{class n{static __NG_ELEMENT_ID__=M$}return n})();function M$(n){return O$(Tr(),Le(),(n&16)===16)}function O$(n,e,t){if(Po(n)&&!t){let r=Er(n.index,e);return new Lo(r,r)}else if(n.type&175){let r=e[wn];return new Lo(r,e)}return null}function yoe(n){let{rootComponent:e,appProviders:t,platformProviders:r,platformRef:i}=n;$e(Me.BootstrapApplicationStart);try{let s=i?.injector??P$(r),o=[OE(),VR,...t||[]],a=new vd({providers:o,parent:s,debugName:"",runEnvironmentInitializers:!1});return C$({r3Injector:a.injector,platformInjector:s,rootComponent:e})}catch(s){return Promise.reject(s)}finally{$e(Me.BootstrapApplicationEnd)}}var yP=()=>{};var IP=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},V$=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},bm={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,d=c?n[i+2]:0,h=s>>2,f=(s&3)<<4|a>>4,y=(a&15)<<2|d>>6,w=d&63;c||(w=64,o||(y=64)),r.push(t[h],t[f],t[y],t[w])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(IP(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):V$(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let f=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||d==null||f==null)throw new jE;let y=s<<2|a>>4;if(r.push(y),d!==64){let w=a<<4&240|d>>2;if(r.push(w),f!==64){let R=d<<6&192|f;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},jE=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},L$=function(n){let e=IP(n);return bm.encodeByteArray(e,!0)},Ad=function(n){return L$(n).replace(/\./g,"")},Sm=function(n){try{return bm.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Am(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var F$=()=>Am().__FIREBASE_DEFAULTS__,U$=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},j$=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Sm(n[1]);return e&&JSON.parse(e)},Cm=()=>{try{return yP()||F$()||U$()||j$()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},EP=n=>{var e,t;return(t=(e=Cm())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},wP=n=>{let e=EP(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},$E=()=>{var n;return(n=Cm())===null||n===void 0?void 0:n.config},TP=n=>{var e;return(e=Cm())===null||e===void 0?void 0:e[`_${n}`]};var jo=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function us(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Dm(n){return(await fetch(n,{credentials:"include"})).ok}function bP(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Ad(JSON.stringify(t)),Ad(JSON.stringify(o)),""].join(".")}var Sd={};function B$(){let n={prod:[],emulator:[]};for(let e of Object.keys(Sd))Sd[e]?n.emulator.push(e):n.prod.push(e);return n}function $$(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var _P=!1;function qE(n,e){if(typeof window>"u"||typeof document>"u"||!us(window.location.host)||Sd[n]===e||Sd[n]||_P)return;Sd[n]=e;function t(y){return`__firebase__banner__${y}`}let r="__firebase__banner",s=B$().prod.length>0;function o(){let y=document.getElementById(r);y&&y.remove()}function a(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function c(y,w){y.setAttribute("width","24"),y.setAttribute("id",w),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function d(){let y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{_P=!0,o()},y}function h(y,w){y.setAttribute("id",w),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function f(){let y=$$(r),w=t("text"),R=document.getElementById(w)||document.createElement("span"),N=t("learnmore"),P=document.getElementById(N)||document.createElement("a"),F=t("preprendIcon"),q=document.getElementById(F)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){let $=y.element;a($),h(P,N);let ee=d();c(q,F),$.append(q,R,P,ee),document.body.appendChild($)}s?(R.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,R.innerText="Preview backend running in this workspace."),R.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}function Gt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function SP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Gt())}function AP(){var n;let e=(n=Cm())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function CP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function DP(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function RP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function HE(){return!AP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function zE(){return!AP()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function jc(){try{return typeof indexedDB=="object"}catch{return!1}}function NP(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var q$="FirebaseError",Ln=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=q$,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Zn.prototype.create)}},Zn=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?H$(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Ln(i,a,r)}};function H$(n,e){return n.replace(z$,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var z$=/\{\$([^}]+)}/g;function er(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(vP(s)&&vP(o)){if(!er(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function vP(n){return n!==null&&typeof n=="object"}function GE(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function PP(n,e){let t=new BE(n,e);return t.subscribe.bind(t)}var BE=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");G$(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=UE),i.error===void 0&&(i.error=UE),i.complete===void 0&&(i.complete=UE);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function G$(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function UE(){}var boe=14400*1e3;function ze(n){return n&&n._delegate?n._delegate:n}var tn=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Bo="[DEFAULT]";var WE=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new jo;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(K$(e))try{this.getOrInitializeService({instanceIdentifier:Bo})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Bo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Bo){return this.instances.has(e)}getOptions(e=Bo){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:W$(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Bo){return this.component?this.component.multipleInstances?e:Bo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function W$(n){return n===Bo?void 0:n}function K$(n){return n.instantiationMode==="EAGER"}var Rm=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new WE(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var Q$=[],ve=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(ve||{}),Y$={debug:ve.DEBUG,verbose:ve.VERBOSE,info:ve.INFO,warn:ve.WARN,error:ve.ERROR,silent:ve.SILENT},J$=ve.INFO,X$={[ve.DEBUG]:"log",[ve.VERBOSE]:"log",[ve.INFO]:"info",[ve.WARN]:"warn",[ve.ERROR]:"error"},Z$=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=X$[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Ar=class{constructor(e){this.name=e,this._logLevel=J$,this._logHandler=Z$,this._userLogHandler=null,Q$.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ve))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Y$[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ve.DEBUG,...e),this._logHandler(this,ve.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ve.VERBOSE,...e),this._logHandler(this,ve.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ve.INFO,...e),this._logHandler(this,ve.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ve.WARN,...e),this._logHandler(this,ve.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ve.ERROR,...e),this._logHandler(this,ve.ERROR,...e)}};var eq=(n,e)=>e.some(t=>n instanceof t),xP,kP;function tq(){return xP||(xP=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function nq(){return kP||(kP=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var MP=new WeakMap,QE=new WeakMap,OP=new WeakMap,KE=new WeakMap,JE=new WeakMap;function rq(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Cr(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&MP.set(t,n)}).catch(()=>{}),JE.set(e,n),e}function iq(n){if(QE.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});QE.set(n,e)}var YE={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return QE.get(n);if(e==="objectStoreNames")return n.objectStoreNames||OP.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Cr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function VP(n){YE=n(YE)}function sq(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Nm(this),e,...t);return OP.set(r,e.sort?e.sort():[e]),Cr(r)}:nq().includes(n)?function(...e){return n.apply(Nm(this),e),Cr(MP.get(this))}:function(...e){return Cr(n.apply(Nm(this),e))}}function oq(n){return typeof n=="function"?sq(n):(n instanceof IDBTransaction&&iq(n),eq(n,tq())?new Proxy(n,YE):n)}function Cr(n){if(n instanceof IDBRequest)return rq(n);if(KE.has(n))return KE.get(n);let e=oq(n);return e!==n&&(KE.set(n,e),JE.set(e,n)),e}var Nm=n=>JE.get(n);function Pm(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),a=Cr(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Cr(o.result),c.oldVersion,c.newVersion,Cr(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}var aq=["get","getKey","getAll","getAllKeys","count"],cq=["put","add","delete","clear"],XE=new Map;function LP(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(XE.get(e))return XE.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=cq.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||aq.includes(t)))return;let s=async function(o,...a){let c=this.transaction(o,i?"readwrite":"readonly"),d=c.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[t](...a),i&&c.done]))[0]};return XE.set(e,s),s}VP(n=>qt(et({},n),{get:(e,t,r)=>LP(e,t)||n.get(e,t,r),has:(e,t)=>!!LP(e,t)||n.has(e,t)}));var ew=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(uq(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function uq(n){let e=n.getComponent();return e?.type==="VERSION"}var tw="@firebase/app",FP="0.13.2";var oi=new Ar("@firebase/app"),lq="@firebase/app-compat",dq="@firebase/analytics-compat",hq="@firebase/analytics",fq="@firebase/app-check-compat",pq="@firebase/app-check",mq="@firebase/auth",gq="@firebase/auth-compat",yq="@firebase/database",_q="@firebase/data-connect",vq="@firebase/database-compat",Iq="@firebase/functions",Eq="@firebase/functions-compat",wq="@firebase/installations",Tq="@firebase/installations-compat",bq="@firebase/messaging",Sq="@firebase/messaging-compat",Aq="@firebase/performance",Cq="@firebase/performance-compat",Dq="@firebase/remote-config",Rq="@firebase/remote-config-compat",Nq="@firebase/storage",Pq="@firebase/storage-compat",xq="@firebase/firestore",kq="@firebase/ai",Mq="@firebase/firestore-compat",Oq="firebase",Vq="11.10.0";var xm="[DEFAULT]",Lq={[tw]:"fire-core",[lq]:"fire-core-compat",[hq]:"fire-analytics",[dq]:"fire-analytics-compat",[pq]:"fire-app-check",[fq]:"fire-app-check-compat",[mq]:"fire-auth",[gq]:"fire-auth-compat",[yq]:"fire-rtdb",[_q]:"fire-data-connect",[vq]:"fire-rtdb-compat",[Iq]:"fire-fn",[Eq]:"fire-fn-compat",[wq]:"fire-iid",[Tq]:"fire-iid-compat",[bq]:"fire-fcm",[Sq]:"fire-fcm-compat",[Aq]:"fire-perf",[Cq]:"fire-perf-compat",[Dq]:"fire-rc",[Rq]:"fire-rc-compat",[Nq]:"fire-gcs",[Pq]:"fire-gcs-compat",[xq]:"fire-fst",[Mq]:"fire-fst-compat",[kq]:"fire-vertex","fire-js":"fire-js",[Oq]:"fire-js-all"};var Cd=new Map,Fq=new Map,nw=new Map;function UP(n,e){try{n.container.addComponent(e)}catch(t){oi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function tr(n){let e=n.name;if(nw.has(e))return oi.debug(`There were multiple attempts to register component ${e}.`),!1;nw.set(e,n);for(let t of Cd.values())UP(t,n);for(let t of Fq.values())UP(t,n);return!0}function Bc(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function qP(n,e,t=xm){Bc(n,e).clearInstance(t)}function ai(n){return n==null?!1:n.settings!==void 0}var Uq={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ls=new Zn("app","Firebase",Uq);var rw=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new tn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ls.create("app-deleted",{appName:this._name})}};var $c=Vq;function ow(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:xm,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw ls.create("bad-app-name",{appName:String(i)});if(t||(t=$E()),!t)throw ls.create("no-options");let s=Cd.get(i);if(s){if(er(t,s.options)&&er(r,s.config))return s;throw ls.create("duplicate-app",{appName:i})}let o=new Rm(i);for(let c of nw.values())o.addComponent(c);let a=new rw(t,r,o);return Cd.set(i,a),a}function qc(n=xm){let e=Cd.get(n);if(!e&&n===xm&&$E())return ow();if(!e)throw ls.create("no-app",{appName:n});return e}function km(){return Array.from(Cd.values())}function nt(n,e,t){var r;let i=(r=Lq[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),oi.warn(a.join(" "));return}tr(new tn(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var jq="firebase-heartbeat-database",Bq=1,Dd="firebase-heartbeat-store",ZE=null;function HP(){return ZE||(ZE=Pm(jq,Bq,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Dd)}catch(t){console.warn(t)}}}}).catch(n=>{throw ls.create("idb-open",{originalErrorMessage:n.message})})),ZE}async function $q(n){try{let t=(await HP()).transaction(Dd),r=await t.objectStore(Dd).get(zP(n));return await t.done,r}catch(e){if(e instanceof Ln)oi.warn(e.message);else{let t=ls.create("idb-get",{originalErrorMessage:e?.message});oi.warn(t.message)}}}async function jP(n,e){try{let r=(await HP()).transaction(Dd,"readwrite");await r.objectStore(Dd).put(e,zP(n)),await r.done}catch(t){if(t instanceof Ln)oi.warn(t.message);else{let r=ls.create("idb-set",{originalErrorMessage:t?.message});oi.warn(r.message)}}}function zP(n){return`${n.name}!${n.options.appId}`}var qq=1024,Hq=30,iw=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new sw(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=BP();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>Hq){let o=Gq(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){oi.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=BP(),{heartbeatsToSend:r,unsentEntries:i}=zq(this._heartbeatsCache.heartbeats),s=Ad(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return oi.warn(t),""}}};function BP(){return new Date().toISOString().substring(0,10)}function zq(n,e=qq){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),$P(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),$P(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var sw=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return jc()?NP().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await $q(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){let i=await this.read();return jP(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){let i=await this.read();return jP(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}};function $P(n){return Ad(JSON.stringify({version:2,heartbeats:n})).length}function Gq(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function Wq(n){tr(new tn("platform-logger",e=>new ew(e),"PRIVATE")),tr(new tn("heartbeat",e=>new iw(e),"PRIVATE")),nt(tw,FP,n),nt(tw,FP,"esm2017"),nt("fire-js","")}Wq("");var Kq="firebase",Qq="11.10.0";nt(Kq,Qq,"app");function GP(n){n===void 0&&(n=se(En));let e=n.get(Pc);return t=>new me(r=>{let i=e.add(),s=!1;function o(){s||(i(),s=!0)}let a=t.subscribe({next:c=>{r.next(c),o()},complete:()=>{r.complete(),o()},error:c=>{r.error(c),o()}});return a.add(()=>{r.unsubscribe(),o()}),a})}var ds=new vc("ANGULARFIRE2_VERSION");function Om(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var qo=(n,e)=>{let t=e?[e]:km(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Hc=(function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n})(Hc||{}),WP=FE()&&typeof Zone<"u"?Hc.WARN:Hc.SILENT;var Mm=class{zone;delegate;constructor(e,t=sv){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(o){i?i.runGuarded(()=>{e.apply(this,[o])}):e.apply(this,[o])};return this.delegate.schedule(s,t,r)}},Ho=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=se(Lt);this.outsideAngular=t.runOutsideAngular(()=>new Mm(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new Mm(typeof Zone>"u"?void 0:Zone.current,ep))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),KP=!1;function Yq(n,e){!KP&&(WP>Hc.SILENT||FE())&&(KP=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),WP>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function Jq(n){let e=se(Lt,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function $o(n){let e=se(Lt,{optional:!0});return e?e.run(()=>n()):n()}var Xq=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),is(t,()=>$o(()=>n.apply(void 0,r)))),Q=(n,e,t)=>(t||=e?Hc.WARN:Hc.VERBOSE,function(){let r,i=arguments,s,o,a;try{s=se(Ho),o=se(Pc),a=se(hn)}catch{return Yq(n,t),n.apply(this,i)}for(let d=0;d<arguments.length;d++)typeof i[d]=="function"&&(e&&(r||=$o(()=>o.add())),i[d]=Xq(i[d],r,a));let c=Jq(()=>n.apply(this,i));return e?c instanceof me?c.pipe(ts(s.outsideAngular),es(s.insideAngular),GP(a)):c instanceof Promise?$o(()=>{let d=o.add();return new Promise((h,f)=>{c.then(y=>is(a,()=>$o(()=>h(y))),y=>is(a,()=>$o(()=>f(y)))).finally(d)})}):typeof c=="function"&&r?function(){return setTimeout(r,0),c.apply(this,arguments)}:$o(()=>c):c instanceof me?c.pipe(ts(s.outsideAngular),es(s.insideAngular)):$o(()=>c)});var zo=class{constructor(e){return e}},Rd=class{constructor(){return km()}};function Zq(n){return n&&n.length===1?n[0]:new zo(qc())}var aw=new be("angularfire2._apps"),eH={provide:zo,useFactory:Zq,deps:[[new ii,aw]]},tH={provide:Rd,deps:[[new ii,aw]]};function nH(n){return(e,t)=>{let r=t.get(aE);nt("angularfire",ds.full,"core"),nt("angularfire",ds.full,"app"),nt("angular",Nv.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new zo(i)}}function gae(n,...e){return Xr([eH,tH,{provide:aw,useFactory:nH(n),multi:!0,deps:[Lt,En,Ho,...e]}])}var yae=Q(ow,!0);var QP=null;function Vm(){return QP}function rH(n){QP??=n}var cw=class{},Lm=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Qe({token:n,factory:()=>se(YP),providedIn:"platform"})}return n})();var YP=(()=>{class n extends Lm{_location;_history;_doc=se(ni);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Vm().getBaseHref(this._doc)}onPopState(t){let r=Vm().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=Vm().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Qe({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function ZP(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function JP(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function hs(n){return n&&n[0]!=="?"?`?${n}`:n}var Fm=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Qe({token:n,factory:()=>se(sH),providedIn:"root"})}return n})(),iH=new be(""),sH=(()=>{class n extends Fm{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??se(ni).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return ZP(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+hs(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+hs(s));this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+hs(s));this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(zt(Lm),zt(iH,8))};static \u0275prov=Qe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ex=(()=>{class n{_subject=new yr;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=cH(JP(XP(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+hs(r))}normalize(t){return n.stripTrailingSlash(aH(this._basePath,XP(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+hs(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+hs(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=hs;static joinWithSlash=ZP;static stripTrailingSlash=JP;static \u0275fac=function(r){return new(r||n)(zt(Fm))};static \u0275prov=Qe({token:n,factory:()=>oH(),providedIn:"root"})}return n})();function oH(){return new ex(zt(Fm))}function aH(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function XP(n){return n.replace(/\/index.html$/,"")}function cH(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function uH(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var uw=class{};var kae="browser";var lH=new Map,dH={activated:!1,tokenObservers:[]},hH={initialized:!1,enabled:!1};function nr(n){return lH.get(n)||Object.assign({},dH)}function ix(){return hH}var fH="https://content-firebaseappcheck.googleapis.com/v1";var pH="exchangeDebugToken",tx={OFFSET_DURATION:300*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:960*1e3},zae=1440*60*1e3;var hw=class{constructor(e,t,r,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new jo,this.pending.promise.catch(t=>{}),await mH(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new jo,this.pending.promise.catch(t=>{}),await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function mH(n){return new Promise(e=>{setTimeout(e,n)})}var gH={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},fs=new Zn("appCheck","AppCheck",gH);function sx(n){if(!nr(n).activated)throw fs.create("use-before-activation",{appName:n.name})}async function ox({url:n,body:e},t){let r={"Content-Type":"application/json"},i=t.getImmediate({optional:!0});if(i){let f=await i.getHeartbeatsHeader();f&&(r["X-Firebase-Client"]=f)}let s={method:"POST",body:JSON.stringify(e),headers:r},o;try{o=await fetch(n,s)}catch(f){throw fs.create("fetch-network-error",{originalErrorMessage:f?.message})}if(o.status!==200)throw fs.create("fetch-status-error",{httpStatus:o.status});let a;try{a=await o.json()}catch(f){throw fs.create("fetch-parse-error",{originalErrorMessage:f?.message})}let c=a.ttl.match(/^([\d.]+)(s)$/);if(!c||!c[2]||isNaN(Number(c[1])))throw fs.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${a.ttl}`});let d=Number(c[1])*1e3,h=Date.now();return{token:a.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}}function ax(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${fH}/projects/${t}/apps/${r}:${pH}?key=${i}`,body:{debug_token:e}}}var yH="firebase-app-check-database",_H=1,fw="firebase-app-check-store";var Um=null;function vH(){return Um||(Um=new Promise((n,e)=>{try{let t=indexedDB.open(yH,_H);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(fs.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;r.oldVersion===0&&i.createObjectStore(fw,{keyPath:"compositeKey"})}}catch(t){e(fs.create("storage-open",{originalErrorMessage:t?.message}))}}),Um)}function IH(n,e){return EH(wH(n),e)}async function EH(n,e){let r=(await vH()).transaction(fw,"readwrite"),s=r.objectStore(fw).put({compositeKey:n,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},r.onerror=c=>{var d;a(fs.create("storage-set",{originalErrorMessage:(d=c.target.error)===null||d===void 0?void 0:d.message}))}})}function wH(n){return`${n.options.appId}-${n.name}`}var Nd=new Ar("@firebase/app-check");function lw(n,e){return jc()?IH(n,e).catch(t=>{Nd.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function cx(){return ix().enabled}async function ux(){let n=ix();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}var TH={error:"UNKNOWN_ERROR"};function bH(n){return bm.encodeString(JSON.stringify(n),!1)}async function pw(n,e=!1,t=!1){let r=n.app;sx(r);let i=nr(r),s=i.token,o;if(s&&!Pd(s)&&(i.token=void 0,s=void 0),!s){let d=await i.cachedTokenPromise;d&&(Pd(d)?s=d:await lw(r,void 0))}if(!e&&s&&Pd(s))return{token:s.token};let a=!1;if(cx())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=ox(ax(r,await ux()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),a=!0);let d=await i.exchangeTokenPromise;return await lw(r,d),i.token=d,{token:d.token}}catch(d){return d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?Nd.warn(d.message):t&&Nd.error(d),dw(d)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),a=!0),s=await nr(r).exchangeTokenPromise}catch(d){d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?Nd.warn(d.message):t&&Nd.error(d),o=d}let c;return s?o?Pd(s)?c={token:s.token,internalError:o}:c=dw(o):(c={token:s.token},i.token=s,await lw(r,s)):c=dw(o),a&&DH(r,c),c}async function SH(n){let e=n.app;sx(e);let{provider:t}=nr(e);if(cx()){let r=await ux(),{token:i}=await ox(ax(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=await t.getToken();return{token:r}}}function AH(n,e,t,r){let{app:i}=n,s=nr(i),o={next:t,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Pd(s.token)){let a=s.token;Promise.resolve().then(()=>{t({token:a.token}),nx(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>nx(n))}function lx(n,e){let t=nr(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function nx(n){let{app:e}=n,t=nr(e),r=t.tokenRefresher;r||(r=CH(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function CH(n){let{app:e}=n;return new hw(async()=>{let t=nr(e),r;if(t.token?r=await pw(n,!0):r=await pw(n),r.error)throw r.error;if(r.internalError)throw r.internalError},()=>!0,()=>{let t=nr(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-300*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},tx.RETRIAL_MIN_WAIT,tx.RETRIAL_MAX_WAIT)}function DH(n,e){let t=nr(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Pd(n){return n.expireTimeMillis-Date.now()>0}function dw(n){return{token:bH(TH),error:n}}var mw=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=nr(this.app);for(let t of e)lx(this.app,t.next);return Promise.resolve()}};function RH(n,e){return new mw(n,e)}function NH(n){return{getToken:e=>pw(n,e),getLimitedUseToken:()=>SH(n),addTokenListener:e=>AH(n,"INTERNAL",e),removeTokenListener:e=>lx(n.app,e)}}var PH="@firebase/app-check",xH="0.10.1";var kH="app-check",rx="app-check-internal";function MH(){tr(new tn(kH,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return RH(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(rx).initialize()})),tr(new tn(rx,n=>{let e=n.getProvider("app-check").getImmediate();return NH(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),nt(PH,xH)}MH();var OH="app-check";var jm=class{constructor(){return qo(OH)}};var VH=["localhost","0.0.0.0","127.0.0.1"],rce=typeof window<"u"&&VH.includes(window.location.hostname);var dx=()=>{};var hx=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},LH=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},fx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,d=c?n[i+2]:0,h=s>>2,f=(s&3)<<4|a>>4,y=(a&15)<<2|d>>6,w=d&63;c||(w=64,o||(y=64)),r.push(t[h],t[f],t[y],t[w])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(hx(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):LH(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let f=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||d==null||f==null)throw new gw;let y=s<<2|a>>4;if(r.push(y),d!==64){let w=a<<4&240|d>>2;if(r.push(w),f!==64){let R=d<<6&192|f;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},gw=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},FH=function(n){let e=hx(n);return fx.encodeByteArray(e,!0)},yw=function(n){return FH(n).replace(/\./g,"")},px=function(n){try{return fx.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function mx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var UH=()=>mx().__FIREBASE_DEFAULTS__,jH=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},BH=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&px(n[1]);return e&&JSON.parse(e)},$H=()=>{try{return dx()||UH()||jH()||BH()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}};function gx(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}function yx(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function qH(){let n=$H()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function _x(){return!qH()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _w(){try{return typeof indexedDB=="object"}catch{return!1}}function vx(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}var HH="FirebaseError",ci=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=HH,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xd.prototype.create)}},xd=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?zH(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new ci(i,a,r)}};function zH(n,e){return n.replace(GH,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var GH=/\{\$([^}]+)}/g;var cce=14400*1e3;function zc(n){return n&&n._delegate?n._delegate:n}var ps=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var WH=[],Ae=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(Ae||{}),KH={debug:Ae.DEBUG,verbose:Ae.VERBOSE,info:Ae.INFO,warn:Ae.WARN,error:Ae.ERROR,silent:Ae.SILENT},QH=Ae.INFO,YH={[Ae.DEBUG]:"log",[Ae.VERBOSE]:"log",[Ae.INFO]:"info",[Ae.WARN]:"warn",[Ae.ERROR]:"error"},JH=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=YH[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Gc=class{constructor(e){this.name=e,this._logLevel=QH,this._logHandler=JH,this._userLogHandler=null,WH.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ae))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?KH[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ae.DEBUG,...e),this._logHandler(this,Ae.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ae.VERBOSE,...e),this._logHandler(this,Ae.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ae.INFO,...e),this._logHandler(this,Ae.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ae.WARN,...e),this._logHandler(this,Ae.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ae.ERROR,...e),this._logHandler(this,Ae.ERROR,...e)}};var Iw=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(XH(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function XH(n){return n.getComponent()?.type==="VERSION"}var Ew="@firebase/app",Ix="0.14.8";var ui=new Gc("@firebase/app"),ZH="@firebase/app-compat",e6="@firebase/analytics-compat",t6="@firebase/analytics",n6="@firebase/app-check-compat",r6="@firebase/app-check",i6="@firebase/auth",s6="@firebase/auth-compat",o6="@firebase/database",a6="@firebase/data-connect",c6="@firebase/database-compat",u6="@firebase/functions",l6="@firebase/functions-compat",d6="@firebase/installations",h6="@firebase/installations-compat",f6="@firebase/messaging",p6="@firebase/messaging-compat",m6="@firebase/performance",g6="@firebase/performance-compat",y6="@firebase/remote-config",_6="@firebase/remote-config-compat",v6="@firebase/storage",I6="@firebase/storage-compat",E6="@firebase/firestore",w6="@firebase/ai",T6="@firebase/firestore-compat",b6="firebase",S6="12.9.0";var A6={[Ew]:"fire-core",[ZH]:"fire-core-compat",[t6]:"fire-analytics",[e6]:"fire-analytics-compat",[r6]:"fire-app-check",[n6]:"fire-app-check-compat",[i6]:"fire-auth",[s6]:"fire-auth-compat",[o6]:"fire-rtdb",[a6]:"fire-data-connect",[c6]:"fire-rtdb-compat",[u6]:"fire-fn",[l6]:"fire-fn-compat",[d6]:"fire-iid",[h6]:"fire-iid-compat",[f6]:"fire-fcm",[p6]:"fire-fcm-compat",[m6]:"fire-perf",[g6]:"fire-perf-compat",[y6]:"fire-rc",[_6]:"fire-rc-compat",[v6]:"fire-gcs",[I6]:"fire-gcs-compat",[E6]:"fire-fst",[T6]:"fire-fst-compat",[w6]:"fire-vertex","fire-js":"fire-js",[b6]:"fire-js-all"};var C6=new Map,D6=new Map,Ex=new Map;function wx(n,e){try{n.container.addComponent(e)}catch(t){ui.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function kd(n){let e=n.name;if(Ex.has(e))return ui.debug(`There were multiple attempts to register component ${e}.`),!1;Ex.set(e,n);for(let t of C6.values())wx(t,n);for(let t of D6.values())wx(t,n);return!0}function Cx(n){return n==null?!1:n.settings!==void 0}var R6={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},bw=new xd("app","Firebase",R6);var Dx=S6;function Wc(n,e,t){let r=A6[n]??n;t&&(r+=`-${t}`);let i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){let o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ui.warn(o.join(" "));return}kd(new ps(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var N6="firebase-heartbeat-database",P6=1,Md="firebase-heartbeat-store",vw=null;function Rx(){return vw||(vw=Pm(N6,P6,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Md)}catch(t){console.warn(t)}}}}).catch(n=>{throw bw.create("idb-open",{originalErrorMessage:n.message})})),vw}async function x6(n){try{let t=(await Rx()).transaction(Md),r=await t.objectStore(Md).get(Nx(n));return await t.done,r}catch(e){if(e instanceof ci)ui.warn(e.message);else{let t=bw.create("idb-get",{originalErrorMessage:e?.message});ui.warn(t.message)}}}async function Tx(n,e){try{let r=(await Rx()).transaction(Md,"readwrite");await r.objectStore(Md).put(e,Nx(n)),await r.done}catch(t){if(t instanceof ci)ui.warn(t.message);else{let r=bw.create("idb-set",{originalErrorMessage:t?.message});ui.warn(r.message)}}}function Nx(n){return`${n.name}!${n.options.appId}`}var k6=1024,M6=30,ww=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Tw(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=bx();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>M6){let i=V6(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ui.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=bx(),{heartbeatsToSend:t,unsentEntries:r}=O6(this._heartbeatsCache.heartbeats),i=yw(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return ui.warn(e),""}}};function bx(){return new Date().toISOString().substring(0,10)}function O6(n,e=k6){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Sx(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Sx(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Tw=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return _w()?vx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await x6(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return Tx(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return Tx(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}};function Sx(n){return yw(JSON.stringify({version:2,heartbeats:n})).length}function V6(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function L6(n){kd(new ps("platform-logger",e=>new Iw(e),"PRIVATE")),kd(new ps("heartbeat",e=>new ww(e),"PRIVATE")),Wc(Ew,Ix,n),Wc(Ew,Ix,"esm2020"),Wc("fire-js","")}L6("");function Fx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Ux=Fx,jx=new Zn("auth","Firebase",Fx());var Hm=new Ar("@firebase/auth");function F6(n,...e){Hm.logLevel<=ve.WARN&&Hm.warn(`Auth (${$c}): ${n}`,...e)}function $m(n,...e){Hm.logLevel<=ve.ERROR&&Hm.error(`Auth (${$c}): ${n}`,...e)}function Px(n,...e){throw Vw(n,...e)}function Ow(n,...e){return Vw(n,...e)}function Bx(n,e,t){let r=Object.assign(Object.assign({},Ux()),{[e]:t});return new Zn("auth","Firebase",r).create(e,{appName:n.name})}function qm(n){return Bx(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Vw(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return jx.create(n,...e)}function Oe(n,e,...t){if(!n)throw Vw(e,...t)}function Od(n){let e="INTERNAL ASSERTION FAILED: "+n;throw $m(e),new Error(e)}function zm(n,e){n||Od(e)}function U6(){return xx()==="http:"||xx()==="https:"}function xx(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function j6(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(U6()||DP()||"connection"in navigator)?navigator.onLine:!0}function B6(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Ko=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,zm(t>e,"Short delay should be less than long delay!"),this.isMobile=SP()||RP()}get(){return j6()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function $6(n,e){zm(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Gm=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Od("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Od("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Od("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var q6={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var H6=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],z6=new Ko(3e4,6e4);function $x(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Jm(n,e,t,r,i={}){return qx(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});let a=GE(Object.assign({key:n.config.apiKey},o)).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);let d=Object.assign({method:e,headers:c},s);return CP()||(d.referrerPolicy="no-referrer"),n.emulatorConfig&&us(n.emulatorConfig.host)&&(d.credentials="include"),Gm.fetch()(await Hx(n,n.config.apiHost,t,a),d)})}async function qx(n,e,t){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},q6),e);try{let i=new Cw(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=await s.json();if("needConfirmation"in o)throw Bm(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,d]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Bm(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Bm(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Bm(n,"user-disabled",o);let h=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Bx(n,h,d);Px(n,h)}}catch(i){if(i instanceof Ln)throw i;Px(n,"network-request-failed",{message:String(i)})}}async function Hx(n,e,t,r){let i=`${e}${t}?${r}`,s=n,o=s.config.emulator?$6(n.config,i):`${n.config.apiScheme}://${i}`;return H6.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}var Cw=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ow(this.auth,"network-request-failed")),z6.get())})}};function Bm(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Ow(n,e,r);return i.customData._tokenResponse=t,i}async function G6(n,e){return Jm(n,"POST","/v1/accounts:delete",e)}async function Wm(n,e){return Jm(n,"POST","/v1/accounts:lookup",e)}function Vd(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Lw(n,e=!1){let t=ze(n),r=await t.getIdToken(e),i=zx(r);Oe(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:Vd(Sw(i.auth_time)),issuedAtTime:Vd(Sw(i.iat)),expirationTime:Vd(Sw(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function Sw(n){return Number(n)*1e3}function zx(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return $m("JWT malformed, contained fewer than 3 sections"),null;try{let i=Sm(t);return i?JSON.parse(i):($m("Failed to decode base64 JWT payload"),null)}catch(i){return $m("Caught error parsing JWT payload as JSON",i?.toString()),null}}function kx(n){let e=zx(n);return Oe(e,"internal-error"),Oe(typeof e.exp<"u","internal-error"),Oe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Dw(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Ln&&W6(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function W6({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Rw=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var Fd=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Vd(this.lastLoginAt),this.creationTime=Vd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function Km(n){var e;let t=n.auth,r=await n.getIdToken(),i=await Dw(n,Wm(t,{idToken:r}));Oe(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Gx(s.providerUserInfo):[],a=K6(n.providerData,o),c=n.isAnonymous,d=!(n.email&&s.passwordHash)&&!a?.length,h=c?d:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Fd(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function Fw(n){let e=ze(n);await Km(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function K6(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Gx(n){return n.map(e=>{var{providerId:t}=e,r=ov(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}async function Q6(n,e){let t=await qx(n,{},async()=>{let r=GE({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=await Hx(n,i,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";let c={method:"POST",headers:a,body:r};return n.emulatorConfig&&us(n.emulatorConfig.host)&&(c.credentials="include"),Gm.fetch()(o,c)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Y6(n,e){return Jm(n,"POST","/v2/accounts:revokeToken",$x(n,e))}var Ld=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Oe(e.idToken,"internal-error"),Oe(typeof e.idToken<"u","internal-error"),Oe(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):kx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Oe(e.length!==0,"internal-error");let t=kx(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Oe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:i,expiresIn:s}=await Q6(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(Oe(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Oe(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(Oe(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Od("not implemented")}};function ms(n,e){Oe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Go=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=ov(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Rw(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Fd(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){let t=await Dw(this,this.stsTokenManager.getToken(this.auth,e));return Oe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Lw(this,e)}reload(){return Fw(this)}_assign(e){this!==e&&(Oe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Km(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ai(this.auth.app))return Promise.reject(qm(this.auth));let e=await this.getIdToken();return await Dw(this,G6(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,c,d,h;let f=(r=t.displayName)!==null&&r!==void 0?r:void 0,y=(i=t.email)!==null&&i!==void 0?i:void 0,w=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,R=(o=t.photoURL)!==null&&o!==void 0?o:void 0,N=(a=t.tenantId)!==null&&a!==void 0?a:void 0,P=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,F=(d=t.createdAt)!==null&&d!==void 0?d:void 0,q=(h=t.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:$,emailVerified:ee,isAnonymous:ue,providerData:Z,stsTokenManager:T}=t;Oe($&&T,e,"internal-error");let v=Ld.fromJSON(this.name,T);Oe(typeof $=="string",e,"internal-error"),ms(f,e.name),ms(y,e.name),Oe(typeof ee=="boolean",e,"internal-error"),Oe(typeof ue=="boolean",e,"internal-error"),ms(w,e.name),ms(R,e.name),ms(N,e.name),ms(P,e.name),ms(F,e.name),ms(q,e.name);let E=new n({uid:$,auth:e,email:y,emailVerified:ee,displayName:f,isAnonymous:ue,photoURL:R,phoneNumber:w,tenantId:N,stsTokenManager:v,createdAt:F,lastLoginAt:q});return Z&&Array.isArray(Z)&&(E.providerData=Z.map(S=>Object.assign({},S))),P&&(E._redirectEventId=P),E}static async _fromIdTokenResponse(e,t,r=!1){let i=new Ld;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Km(s),s}static async _fromGetAccountInfoResponse(e,t,r){let i=t.users[0];Oe(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?Gx(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new Ld;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Fd(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,d),c}};var Mx=new Map;function Wo(n){zm(n instanceof Function,"Expected a class definition");let e=Mx.get(n);return e?(zm(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Mx.set(n,e),e)}var J6=(()=>{class n{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){let r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Nw=J6;function Aw(n,e,t){return`firebase:${n}:${e}:${t}`}var Qm=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Aw(this.userKey,i.apiKey,s),this.fullPersistenceKey=Aw("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await Wm(this.auth,{idToken:e}).catch(()=>{});return t?Go._fromGetAccountInfoResponse(this.auth,t,e):null}return Go._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new n(Wo(Nw),e,r);let i=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d),s=i[0]||Wo(Nw),o=Aw(r,e.config.apiKey,e.name),a=null;for(let d of t)try{let h=await d._get(o);if(h){let f;if(typeof h=="string"){let y=await Wm(e,{idToken:h}).catch(()=>{});if(!y)break;f=await Go._fromGetAccountInfoResponse(e,y,h)}else f=Go._fromJSON(e,h);d!==s&&(a=f),s=d;break}}catch{}let c=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,r):(s=c[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async d=>{if(d!==s)try{await d._remove(o)}catch{}})),new n(s,e,r))}};function Ox(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(t9(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(X6(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(r9(e))return"Blackberry";if(i9(e))return"Webos";if(Z6(e))return"Safari";if((e.includes("chrome/")||e9(e))&&!e.includes("edge/"))return"Chrome";if(n9(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function X6(n=Gt()){return/firefox\//i.test(n)}function Z6(n=Gt()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function e9(n=Gt()){return/crios\//i.test(n)}function t9(n=Gt()){return/iemobile/i.test(n)}function n9(n=Gt()){return/android/i.test(n)}function r9(n=Gt()){return/blackberry/i.test(n)}function i9(n=Gt()){return/webos/i.test(n)}function Wx(n,e=[]){let t;switch(n){case"Browser":t=Ox(Gt());break;case"Worker":t=`${Ox(Gt())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${$c}/${r}`}var Pw=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}};async function s9(n,e={}){return Jm(n,"GET","/v2/passwordPolicy",$x(n,e))}var o9=6,xw=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:o9,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var kw=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ym(this),this.idTokenSubscription=new Ym(this),this.beforeStateQueue=new Pw(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=jx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Wo(t)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await Qm.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await Wm(this,{idToken:e}),r=await Go._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(ai(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=await this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Oe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Km(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=B6()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ai(this.app))return Promise.reject(qm(this));let t=e?ze(e):null;return t&&Oe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Oe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ai(this.app)?Promise.reject(qm(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ai(this.app)?Promise.reject(qm(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Wo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await s9(this),t=new xw(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Zn("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await Y6(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&Wo(e)||this._popupRedirectResolver;Oe(t,this,"argument-error"),this.redirectPersistenceManager=await Qm.create(this,[Wo(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Oe(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(t);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Wx(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);let i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;if(ai(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&F6(`Error while retrieving App Check token: ${t.error}`),t?.token}};function a9(n){return ze(n)}var Ym=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=PP(t=>this.observer=t)}get next(){return Oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var c9={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function u9(n){c9=n}function l9(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function d9(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Wo);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}var Lce=l9("rcb"),Fce=new Ko(3e4,6e4);var Uce=new Ko(2e3,1e4);var jce=600*1e3;var Bce=new Ko(3e4,6e4);var $ce=new Ko(5e3,15e3);var qce=encodeURIComponent("fac");var Vx="@firebase/auth",Lx="1.10.8";var Mw=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function h9(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function f9(n){tr(new tn("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;Oe(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Wx(n)},d=new kw(r,i,s,c);return d9(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),tr(new tn("auth-internal",e=>{let t=a9(e.getProvider("auth").getImmediate());return(r=>new Mw(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),nt(Vx,Lx,h9(n)),nt(Vx,Lx,"esm2017")}var p9=300,Hce=TP("authIdTokenMaxAge")||p9;function m9(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}u9({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=Ow("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",m9().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});f9("Browser");var fz="auth";var Xm=class{constructor(){return qo(fz)}};var Kx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Qx={};var li,Uw;(function(){var n;function e(T,v){function E(){}E.prototype=v.prototype,T.F=v.prototype,T.prototype=new E,T.prototype.constructor=T,T.D=function(S,b,D){for(var I=Array(arguments.length-2),Ke=2;Ke<arguments.length;Ke++)I[Ke-2]=arguments[Ke];return v.prototype[b].apply(S,I)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,v,E){E||(E=0);let S=Array(16);if(typeof v=="string")for(var b=0;b<16;++b)S[b]=v.charCodeAt(E++)|v.charCodeAt(E++)<<8|v.charCodeAt(E++)<<16|v.charCodeAt(E++)<<24;else for(b=0;b<16;++b)S[b]=v[E++]|v[E++]<<8|v[E++]<<16|v[E++]<<24;v=T.g[0],E=T.g[1],b=T.g[2];let D=T.g[3],I;I=v+(D^E&(b^D))+S[0]+3614090360&4294967295,v=E+(I<<7&4294967295|I>>>25),I=D+(b^v&(E^b))+S[1]+3905402710&4294967295,D=v+(I<<12&4294967295|I>>>20),I=b+(E^D&(v^E))+S[2]+606105819&4294967295,b=D+(I<<17&4294967295|I>>>15),I=E+(v^b&(D^v))+S[3]+3250441966&4294967295,E=b+(I<<22&4294967295|I>>>10),I=v+(D^E&(b^D))+S[4]+4118548399&4294967295,v=E+(I<<7&4294967295|I>>>25),I=D+(b^v&(E^b))+S[5]+1200080426&4294967295,D=v+(I<<12&4294967295|I>>>20),I=b+(E^D&(v^E))+S[6]+2821735955&4294967295,b=D+(I<<17&4294967295|I>>>15),I=E+(v^b&(D^v))+S[7]+4249261313&4294967295,E=b+(I<<22&4294967295|I>>>10),I=v+(D^E&(b^D))+S[8]+1770035416&4294967295,v=E+(I<<7&4294967295|I>>>25),I=D+(b^v&(E^b))+S[9]+2336552879&4294967295,D=v+(I<<12&4294967295|I>>>20),I=b+(E^D&(v^E))+S[10]+4294925233&4294967295,b=D+(I<<17&4294967295|I>>>15),I=E+(v^b&(D^v))+S[11]+2304563134&4294967295,E=b+(I<<22&4294967295|I>>>10),I=v+(D^E&(b^D))+S[12]+1804603682&4294967295,v=E+(I<<7&4294967295|I>>>25),I=D+(b^v&(E^b))+S[13]+4254626195&4294967295,D=v+(I<<12&4294967295|I>>>20),I=b+(E^D&(v^E))+S[14]+2792965006&4294967295,b=D+(I<<17&4294967295|I>>>15),I=E+(v^b&(D^v))+S[15]+1236535329&4294967295,E=b+(I<<22&4294967295|I>>>10),I=v+(b^D&(E^b))+S[1]+4129170786&4294967295,v=E+(I<<5&4294967295|I>>>27),I=D+(E^b&(v^E))+S[6]+3225465664&4294967295,D=v+(I<<9&4294967295|I>>>23),I=b+(v^E&(D^v))+S[11]+643717713&4294967295,b=D+(I<<14&4294967295|I>>>18),I=E+(D^v&(b^D))+S[0]+3921069994&4294967295,E=b+(I<<20&4294967295|I>>>12),I=v+(b^D&(E^b))+S[5]+3593408605&4294967295,v=E+(I<<5&4294967295|I>>>27),I=D+(E^b&(v^E))+S[10]+38016083&4294967295,D=v+(I<<9&4294967295|I>>>23),I=b+(v^E&(D^v))+S[15]+3634488961&4294967295,b=D+(I<<14&4294967295|I>>>18),I=E+(D^v&(b^D))+S[4]+3889429448&4294967295,E=b+(I<<20&4294967295|I>>>12),I=v+(b^D&(E^b))+S[9]+568446438&4294967295,v=E+(I<<5&4294967295|I>>>27),I=D+(E^b&(v^E))+S[14]+3275163606&4294967295,D=v+(I<<9&4294967295|I>>>23),I=b+(v^E&(D^v))+S[3]+4107603335&4294967295,b=D+(I<<14&4294967295|I>>>18),I=E+(D^v&(b^D))+S[8]+1163531501&4294967295,E=b+(I<<20&4294967295|I>>>12),I=v+(b^D&(E^b))+S[13]+2850285829&4294967295,v=E+(I<<5&4294967295|I>>>27),I=D+(E^b&(v^E))+S[2]+4243563512&4294967295,D=v+(I<<9&4294967295|I>>>23),I=b+(v^E&(D^v))+S[7]+1735328473&4294967295,b=D+(I<<14&4294967295|I>>>18),I=E+(D^v&(b^D))+S[12]+2368359562&4294967295,E=b+(I<<20&4294967295|I>>>12),I=v+(E^b^D)+S[5]+4294588738&4294967295,v=E+(I<<4&4294967295|I>>>28),I=D+(v^E^b)+S[8]+2272392833&4294967295,D=v+(I<<11&4294967295|I>>>21),I=b+(D^v^E)+S[11]+1839030562&4294967295,b=D+(I<<16&4294967295|I>>>16),I=E+(b^D^v)+S[14]+4259657740&4294967295,E=b+(I<<23&4294967295|I>>>9),I=v+(E^b^D)+S[1]+2763975236&4294967295,v=E+(I<<4&4294967295|I>>>28),I=D+(v^E^b)+S[4]+1272893353&4294967295,D=v+(I<<11&4294967295|I>>>21),I=b+(D^v^E)+S[7]+4139469664&4294967295,b=D+(I<<16&4294967295|I>>>16),I=E+(b^D^v)+S[10]+3200236656&4294967295,E=b+(I<<23&4294967295|I>>>9),I=v+(E^b^D)+S[13]+681279174&4294967295,v=E+(I<<4&4294967295|I>>>28),I=D+(v^E^b)+S[0]+3936430074&4294967295,D=v+(I<<11&4294967295|I>>>21),I=b+(D^v^E)+S[3]+3572445317&4294967295,b=D+(I<<16&4294967295|I>>>16),I=E+(b^D^v)+S[6]+76029189&4294967295,E=b+(I<<23&4294967295|I>>>9),I=v+(E^b^D)+S[9]+3654602809&4294967295,v=E+(I<<4&4294967295|I>>>28),I=D+(v^E^b)+S[12]+3873151461&4294967295,D=v+(I<<11&4294967295|I>>>21),I=b+(D^v^E)+S[15]+530742520&4294967295,b=D+(I<<16&4294967295|I>>>16),I=E+(b^D^v)+S[2]+3299628645&4294967295,E=b+(I<<23&4294967295|I>>>9),I=v+(b^(E|~D))+S[0]+4096336452&4294967295,v=E+(I<<6&4294967295|I>>>26),I=D+(E^(v|~b))+S[7]+1126891415&4294967295,D=v+(I<<10&4294967295|I>>>22),I=b+(v^(D|~E))+S[14]+2878612391&4294967295,b=D+(I<<15&4294967295|I>>>17),I=E+(D^(b|~v))+S[5]+4237533241&4294967295,E=b+(I<<21&4294967295|I>>>11),I=v+(b^(E|~D))+S[12]+1700485571&4294967295,v=E+(I<<6&4294967295|I>>>26),I=D+(E^(v|~b))+S[3]+2399980690&4294967295,D=v+(I<<10&4294967295|I>>>22),I=b+(v^(D|~E))+S[10]+4293915773&4294967295,b=D+(I<<15&4294967295|I>>>17),I=E+(D^(b|~v))+S[1]+2240044497&4294967295,E=b+(I<<21&4294967295|I>>>11),I=v+(b^(E|~D))+S[8]+1873313359&4294967295,v=E+(I<<6&4294967295|I>>>26),I=D+(E^(v|~b))+S[15]+4264355552&4294967295,D=v+(I<<10&4294967295|I>>>22),I=b+(v^(D|~E))+S[6]+2734768916&4294967295,b=D+(I<<15&4294967295|I>>>17),I=E+(D^(b|~v))+S[13]+1309151649&4294967295,E=b+(I<<21&4294967295|I>>>11),I=v+(b^(E|~D))+S[4]+4149444226&4294967295,v=E+(I<<6&4294967295|I>>>26),I=D+(E^(v|~b))+S[11]+3174756917&4294967295,D=v+(I<<10&4294967295|I>>>22),I=b+(v^(D|~E))+S[2]+718787259&4294967295,b=D+(I<<15&4294967295|I>>>17),I=E+(D^(b|~v))+S[9]+3951481745&4294967295,T.g[0]=T.g[0]+v&4294967295,T.g[1]=T.g[1]+(b+(I<<21&4294967295|I>>>11))&4294967295,T.g[2]=T.g[2]+b&4294967295,T.g[3]=T.g[3]+D&4294967295}r.prototype.v=function(T,v){v===void 0&&(v=T.length);let E=v-this.blockSize,S=this.C,b=this.h,D=0;for(;D<v;){if(b==0)for(;D<=E;)i(this,T,D),D+=this.blockSize;if(typeof T=="string"){for(;D<v;)if(S[b++]=T.charCodeAt(D++),b==this.blockSize){i(this,S),b=0;break}}else for(;D<v;)if(S[b++]=T[D++],b==this.blockSize){i(this,S),b=0;break}}this.h=b,this.o+=v},r.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var v=1;v<T.length-8;++v)T[v]=0;v=this.o*8;for(var E=T.length-8;E<T.length;++E)T[E]=v&255,v/=256;for(this.v(T),T=Array(16),v=0,E=0;E<4;++E)for(let S=0;S<32;S+=8)T[v++]=this.g[E]>>>S&255;return T};function s(T,v){var E=a;return Object.prototype.hasOwnProperty.call(E,T)?E[T]:E[T]=v(T)}function o(T,v){this.h=v;let E=[],S=!0;for(let b=T.length-1;b>=0;b--){let D=T[b]|0;S&&D==v||(E[b]=D,S=!1)}this.g=E}var a={};function c(T){return-128<=T&&T<128?s(T,function(v){return new o([v|0],v<0?-1:0)}):new o([T|0],T<0?-1:0)}function d(T){if(isNaN(T)||!isFinite(T))return f;if(T<0)return P(d(-T));let v=[],E=1;for(let S=0;T>=E;S++)v[S]=T/E|0,E*=4294967296;return new o(v,0)}function h(T,v){if(T.length==0)throw Error("number format error: empty string");if(v=v||10,v<2||36<v)throw Error("radix out of range: "+v);if(T.charAt(0)=="-")return P(h(T.substring(1),v));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');let E=d(Math.pow(v,8)),S=f;for(let D=0;D<T.length;D+=8){var b=Math.min(8,T.length-D);let I=parseInt(T.substring(D,D+b),v);b<8?(b=d(Math.pow(v,b)),S=S.j(b).add(d(I))):(S=S.j(E),S=S.add(d(I)))}return S}var f=c(0),y=c(1),w=c(16777216);n=o.prototype,n.m=function(){if(N(this))return-P(this).m();let T=0,v=1;for(let E=0;E<this.g.length;E++){let S=this.i(E);T+=(S>=0?S:4294967296+S)*v,v*=4294967296}return T},n.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(R(this))return"0";if(N(this))return"-"+P(this).toString(T);let v=d(Math.pow(T,6));var E=this;let S="";for(;;){let b=ee(E,v).g;E=F(E,b.j(v));let D=((E.g.length>0?E.g[0]:E.h)>>>0).toString(T);if(E=b,R(E))return D+S;for(;D.length<6;)D="0"+D;S=D+S}},n.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function R(T){if(T.h!=0)return!1;for(let v=0;v<T.g.length;v++)if(T.g[v]!=0)return!1;return!0}function N(T){return T.h==-1}n.l=function(T){return T=F(this,T),N(T)?-1:R(T)?0:1};function P(T){let v=T.g.length,E=[];for(let S=0;S<v;S++)E[S]=~T.g[S];return new o(E,~T.h).add(y)}n.abs=function(){return N(this)?P(this):this},n.add=function(T){let v=Math.max(this.g.length,T.g.length),E=[],S=0;for(let b=0;b<=v;b++){let D=S+(this.i(b)&65535)+(T.i(b)&65535),I=(D>>>16)+(this.i(b)>>>16)+(T.i(b)>>>16);S=I>>>16,D&=65535,I&=65535,E[b]=I<<16|D}return new o(E,E[E.length-1]&-2147483648?-1:0)};function F(T,v){return T.add(P(v))}n.j=function(T){if(R(this)||R(T))return f;if(N(this))return N(T)?P(this).j(P(T)):P(P(this).j(T));if(N(T))return P(this.j(P(T)));if(this.l(w)<0&&T.l(w)<0)return d(this.m()*T.m());let v=this.g.length+T.g.length,E=[];for(var S=0;S<2*v;S++)E[S]=0;for(S=0;S<this.g.length;S++)for(let b=0;b<T.g.length;b++){let D=this.i(S)>>>16,I=this.i(S)&65535,Ke=T.i(b)>>>16,rn=T.i(b)&65535;E[2*S+2*b]+=I*rn,q(E,2*S+2*b),E[2*S+2*b+1]+=D*rn,q(E,2*S+2*b+1),E[2*S+2*b+1]+=I*Ke,q(E,2*S+2*b+1),E[2*S+2*b+2]+=D*Ke,q(E,2*S+2*b+2)}for(T=0;T<v;T++)E[T]=E[2*T+1]<<16|E[2*T];for(T=v;T<2*v;T++)E[T]=0;return new o(E,0)};function q(T,v){for(;(T[v]&65535)!=T[v];)T[v+1]+=T[v]>>>16,T[v]&=65535,v++}function $(T,v){this.g=T,this.h=v}function ee(T,v){if(R(v))throw Error("division by zero");if(R(T))return new $(f,f);if(N(T))return v=ee(P(T),v),new $(P(v.g),P(v.h));if(N(v))return v=ee(T,P(v)),new $(P(v.g),v.h);if(T.g.length>30){if(N(T)||N(v))throw Error("slowDivide_ only works with positive integers.");for(var E=y,S=v;S.l(T)<=0;)E=ue(E),S=ue(S);var b=Z(E,1),D=Z(S,1);for(S=Z(S,2),E=Z(E,2);!R(S);){var I=D.add(S);I.l(T)<=0&&(b=b.add(E),D=I),S=Z(S,1),E=Z(E,1)}return v=F(T,b.j(v)),new $(b,v)}for(b=f;T.l(v)>=0;){for(E=Math.max(1,Math.floor(T.m()/v.m())),S=Math.ceil(Math.log(E)/Math.LN2),S=S<=48?1:Math.pow(2,S-48),D=d(E),I=D.j(v);N(I)||I.l(T)>0;)E-=S,D=d(E),I=D.j(v);R(D)&&(D=y),b=b.add(D),T=F(T,I)}return new $(b,T)}n.B=function(T){return ee(this,T).h},n.and=function(T){let v=Math.max(this.g.length,T.g.length),E=[];for(let S=0;S<v;S++)E[S]=this.i(S)&T.i(S);return new o(E,this.h&T.h)},n.or=function(T){let v=Math.max(this.g.length,T.g.length),E=[];for(let S=0;S<v;S++)E[S]=this.i(S)|T.i(S);return new o(E,this.h|T.h)},n.xor=function(T){let v=Math.max(this.g.length,T.g.length),E=[];for(let S=0;S<v;S++)E[S]=this.i(S)^T.i(S);return new o(E,this.h^T.h)};function ue(T){let v=T.g.length+1,E=[];for(let S=0;S<v;S++)E[S]=T.i(S)<<1|T.i(S-1)>>>31;return new o(E,T.h)}function Z(T,v){let E=v>>5;v%=32;let S=T.g.length-E,b=[];for(let D=0;D<S;D++)b[D]=v>0?T.i(D+E)>>>v|T.i(D+E+1)<<32-v:T.i(D+E);return new o(b,T.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Uw=Qx.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,li=Qx.Integer=o}).apply(typeof Kx<"u"?Kx:typeof self<"u"?self:typeof window<"u"?window:{});var Zm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},di={};var jw,pz,Kc,Bw,Ud,eg,$w,qw,Hw;(function(){var n,e=Object.defineProperty;function t(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Zm=="object"&&Zm];for(var m=0;m<l.length;++m){var _=l[m];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var r=t(this);function i(l,m){if(m)e:{var _=r;l=l.split(".");for(var C=0;C<l.length-1;C++){var x=l[C];if(!(x in _))break e;_=_[x]}l=l[l.length-1],C=_[l],m=m(C),m!=C&&m!=null&&e(_,l,{configurable:!0,writable:!0,value:m})}}i("Symbol.dispose",function(l){return l||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(l){return l||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(l){return l||function(m){var _=[],C;for(C in m)Object.prototype.hasOwnProperty.call(m,C)&&_.push([C,m[C]]);return _}});var s=s||{},o=this||self;function a(l){var m=typeof l;return m=="object"&&l!=null||m=="function"}function c(l,m,_){return l.call.apply(l.bind,arguments)}function d(l,m,_){return d=c,d.apply(null,arguments)}function h(l,m){var _=Array.prototype.slice.call(arguments,1);return function(){var C=_.slice();return C.push.apply(C,arguments),l.apply(this,C)}}function f(l,m){function _(){}_.prototype=m.prototype,l.Z=m.prototype,l.prototype=new _,l.prototype.constructor=l,l.Ob=function(C,x,V){for(var z=Array(arguments.length-2),ae=2;ae<arguments.length;ae++)z[ae-2]=arguments[ae];return m.prototype[x].apply(C,z)}}var y=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?l=>l&&AsyncContext.Snapshot.wrap(l):l=>l;function w(l){let m=l.length;if(m>0){let _=Array(m);for(let C=0;C<m;C++)_[C]=l[C];return _}return[]}function R(l,m){for(let C=1;C<arguments.length;C++){let x=arguments[C];var _=typeof x;if(_=_!="object"?_:x?Array.isArray(x)?"array":_:"null",_=="array"||_=="object"&&typeof x.length=="number"){_=l.length||0;let V=x.length||0;l.length=_+V;for(let z=0;z<V;z++)l[_+z]=x[z]}else l.push(x)}}class N{constructor(m,_){this.i=m,this.j=_,this.h=0,this.g=null}get(){let m;return this.h>0?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}function P(l){o.setTimeout(()=>{throw l},0)}function F(){var l=T;let m=null;return l.g&&(m=l.g,l.g=l.g.next,l.g||(l.h=null),m.next=null),m}class q{constructor(){this.h=this.g=null}add(m,_){let C=$.get();C.set(m,_),this.h?this.h.next=C:this.g=C,this.h=C}}var $=new N(()=>new ee,l=>l.reset());class ee{constructor(){this.next=this.g=this.h=null}set(m,_){this.h=m,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let ue,Z=!1,T=new q,v=()=>{let l=Promise.resolve(void 0);ue=()=>{l.then(E)}};function E(){for(var l;l=F();){try{l.h.call(l.g)}catch(_){P(_)}var m=$;m.j(l),m.h<100&&(m.h++,l.next=m.g,m.g=l)}Z=!1}function S(){this.u=this.u,this.C=this.C}S.prototype.u=!1,S.prototype.dispose=function(){this.u||(this.u=!0,this.N())},S.prototype[Symbol.dispose]=function(){this.dispose()},S.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function b(l,m){this.type=l,this.g=this.target=m,this.defaultPrevented=!1}b.prototype.h=function(){this.defaultPrevented=!0};var D=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var l=!1,m=Object.defineProperty({},"passive",{get:function(){l=!0}});try{let _=()=>{};o.addEventListener("test",_,m),o.removeEventListener("test",_,m)}catch{}return l})();function I(l){return/^[\s\xa0]*$/.test(l)}function Ke(l,m){b.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l&&this.init(l,m)}f(Ke,b),Ke.prototype.init=function(l,m){let _=this.type=l.type,C=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;this.target=l.target||l.srcElement,this.g=m,m=l.relatedTarget,m||(_=="mouseover"?m=l.fromElement:_=="mouseout"&&(m=l.toElement)),this.relatedTarget=m,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=l.pointerType,this.state=l.state,this.i=l,l.defaultPrevented&&Ke.Z.h.call(this)},Ke.prototype.h=function(){Ke.Z.h.call(this);let l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var rn="closure_listenable_"+(Math.random()*1e6|0),k_=0;function Ks(l,m,_,C,x){this.listener=l,this.proxy=null,this.src=m,this.type=_,this.capture=!!C,this.ha=x,this.key=++k_,this.da=this.fa=!1}function lr(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Ni(l,m,_){for(let C in l)m.call(_,l[C],C,l)}function ff(l,m){for(let _ in l)m.call(void 0,l[_],_,l)}function pf(l){let m={};for(let _ in l)m[_]=l[_];return m}let Bn="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function St(l,m){let _,C;for(let x=1;x<arguments.length;x++){C=arguments[x];for(_ in C)l[_]=C[_];for(let V=0;V<Bn.length;V++)_=Bn[V],Object.prototype.hasOwnProperty.call(C,_)&&(l[_]=C[_])}}function Oa(l){this.src=l,this.g={},this.h=0}Oa.prototype.add=function(l,m,_,C,x){let V=l.toString();l=this.g[V],l||(l=this.g[V]=[],this.h++);let z=yl(l,m,C,x);return z>-1?(m=l[z],_||(m.fa=!1)):(m=new Ks(m,this.src,V,!!C,x),m.fa=_,l.push(m)),m};function Br(l,m){let _=m.type;if(_ in l.g){var C=l.g[_],x=Array.prototype.indexOf.call(C,m,void 0),V;(V=x>=0)&&Array.prototype.splice.call(C,x,1),V&&(lr(m),l.g[_].length==0&&(delete l.g[_],l.h--))}}function yl(l,m,_,C){for(let x=0;x<l.length;++x){let V=l[x];if(!V.da&&V.listener==m&&V.capture==!!_&&V.ha==C)return x}return-1}var $r="closure_lm_"+(Math.random()*1e6|0),_l={};function mf(l,m,_,C,x){if(C&&C.once)return La(l,m,_,C,x);if(Array.isArray(m)){for(let V=0;V<m.length;V++)mf(l,m[V],_,C,x);return null}return _=Ba(_),l&&l[rn]?l.J(m,_,a(C)?!!C.capture:!!C,x):Qs(l,m,_,!1,C,x)}function Qs(l,m,_,C,x,V){if(!m)throw Error("Invalid event type");let z=a(x)?!!x.capture:!!x,ae=ja(l);if(ae||(l[$r]=ae=new Oa(l)),_=ae.add(m,_,C,z,V),_.proxy)return _;if(C=Va(),_.proxy=C,C.src=l,C.listener=_,l.addEventListener)D||(x=z),x===void 0&&(x=!1),l.addEventListener(m.toString(),C,x);else if(l.attachEvent)l.attachEvent(Ua(m.toString()),C);else if(l.addListener&&l.removeListener)l.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return _}function Va(){function l(_){return m.call(l.src,l.listener,_)}let m=gf;return l}function La(l,m,_,C,x){if(Array.isArray(m)){for(let V=0;V<m.length;V++)La(l,m[V],_,C,x);return null}return _=Ba(_),l&&l[rn]?l.K(m,_,a(C)?!!C.capture:!!C,x):Qs(l,m,_,!0,C,x)}function Fa(l,m,_,C,x){if(Array.isArray(m))for(var V=0;V<m.length;V++)Fa(l,m[V],_,C,x);else C=a(C)?!!C.capture:!!C,_=Ba(_),l&&l[rn]?(l=l.i,V=String(m).toString(),V in l.g&&(m=l.g[V],_=yl(m,_,C,x),_>-1&&(lr(m[_]),Array.prototype.splice.call(m,_,1),m.length==0&&(delete l.g[V],l.h--)))):l&&(l=ja(l))&&(m=l.g[m.toString()],l=-1,m&&(l=yl(m,_,C,x)),(_=l>-1?m[l]:null)&&Ys(_))}function Ys(l){if(typeof l!="number"&&l&&!l.da){var m=l.src;if(m&&m[rn])Br(m.i,l);else{var _=l.type,C=l.proxy;m.removeEventListener?m.removeEventListener(_,C,l.capture):m.detachEvent?m.detachEvent(Ua(_),C):m.addListener&&m.removeListener&&m.removeListener(C),(_=ja(m))?(Br(_,l),_.h==0&&(_.src=null,m[$r]=null)):lr(l)}}}function Ua(l){return l in _l?_l[l]:_l[l]="on"+l}function gf(l,m){if(l.da)l=!0;else{m=new Ke(m,this);let _=l.listener,C=l.ha||l.src;l.fa&&Ys(l),l=_.call(C,m)}return l}function ja(l){return l=l[$r],l instanceof Oa?l:null}var vl="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ba(l){return typeof l=="function"?l:(l[vl]||(l[vl]=function(m){return l.handleEvent(m)}),l[vl])}function At(){S.call(this),this.i=new Oa(this),this.M=this,this.G=null}f(At,S),At.prototype[rn]=!0,At.prototype.removeEventListener=function(l,m,_,C){Fa(this,l,m,_,C)};function Ct(l,m){var _,C=l.G;if(C)for(_=[];C;C=C.G)_.push(C);if(l=l.M,C=m.type||m,typeof m=="string")m=new b(m,l);else if(m instanceof b)m.target=m.target||l;else{var x=m;m=new b(C,l),St(m,x)}x=!0;let V,z;if(_)for(z=_.length-1;z>=0;z--)V=m.g=_[z],x=Js(V,C,!0,m)&&x;if(V=m.g=l,x=Js(V,C,!0,m)&&x,x=Js(V,C,!1,m)&&x,_)for(z=0;z<_.length;z++)V=m.g=_[z],x=Js(V,C,!1,m)&&x}At.prototype.N=function(){if(At.Z.N.call(this),this.i){var l=this.i;for(let m in l.g){let _=l.g[m];for(let C=0;C<_.length;C++)lr(_[C]);delete l.g[m],l.h--}}this.G=null},At.prototype.J=function(l,m,_,C){return this.i.add(String(l),m,!1,_,C)},At.prototype.K=function(l,m,_,C){return this.i.add(String(l),m,!0,_,C)};function Js(l,m,_,C){if(m=l.i.g[String(m)],!m)return!0;m=m.concat();let x=!0;for(let V=0;V<m.length;++V){let z=m[V];if(z&&!z.da&&z.capture==_){let ae=z.listener,u=z.ha||z.src;z.fa&&Br(l.i,z),x=ae.call(u,C)!==!1&&x}}return x&&!C.defaultPrevented}function M_(l,m){if(typeof l!="function")if(l&&typeof l.handleEvent=="function")l=d(l.handleEvent,l);else throw Error("Invalid listener argument");return Number(m)>2147483647?-1:o.setTimeout(l,m||0)}function $a(l){l.g=M_(()=>{l.g=null,l.i&&(l.i=!1,$a(l))},l.l);let m=l.h;l.h=null,l.m.apply(null,m)}class Il extends S{constructor(m,_){super(),this.m=m,this.l=_,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:$a(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function qr(l){S.call(this),this.h=l,this.g={}}f(qr,S);var Dt=[];function Pt(l){Ni(l.g,function(m,_){this.g.hasOwnProperty(_)&&Ys(m)},l),l.g={}}qr.prototype.N=function(){qr.Z.N.call(this),Pt(this)},qr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Pi=o.JSON.stringify,yf=o.JSON.parse,_f=class{stringify(l){return o.JSON.stringify(l,void 0)}parse(l){return o.JSON.parse(l,void 0)}};function vf(){}function xi(){}var ki={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function qa(){b.call(this,"d")}f(qa,b);function Xs(){b.call(this,"c")}f(Xs,b);var Hr={},If=null;function Mi(){return If=If||new At}Hr.Ia="serverreachability";function El(l){b.call(this,Hr.Ia,l)}f(El,b);function Oi(l){let m=Mi();Ct(m,new El(m))}Hr.STAT_EVENT="statevent";function Vi(l,m){b.call(this,Hr.STAT_EVENT,l),this.stat=m}f(Vi,b);function Rt(l){let m=Mi();Ct(m,new Vi(m,l))}Hr.Ja="timingevent";function Ha(l,m){b.call(this,Hr.Ja,l),this.size=m}f(Ha,b);function mn(l,m){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){l()},m)}function Li(){this.g=!0}Li.prototype.ua=function(){this.g=!1};function za(l,m,_,C,x,V){l.info(function(){if(l.g)if(V){var z="",ae=V.split("&");for(let p=0;p<ae.length;p++){var u=ae[p].split("=");if(u.length>1){let g=u[0];u=u[1];let A=g.split("_");z=A.length>=2&&A[1]=="type"?z+(g+"="+u+"&"):z+(g+"=redacted&")}}}else z=null;else z=V;return"XMLHTTP REQ ("+C+") [attempt "+x+"]: "+m+`
`+_+`
`+z})}function Ef(l,m,_,C,x,V,z){l.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+x+"]: "+m+`
`+_+`
`+V+" "+z})}function Pn(l,m,_,C){l.info(function(){return"XMLHTTP TEXT ("+m+"): "+Ot(l,_)+(C?" "+C:"")})}function wf(l,m){l.info(function(){return"TIMEOUT: "+m})}Li.prototype.info=function(){};function Ot(l,m){if(!l.g)return m;if(!m)return null;try{let V=JSON.parse(m);if(V){for(l=0;l<V.length;l++)if(Array.isArray(V[l])){var _=V[l];if(!(_.length<2)){var C=_[1];if(Array.isArray(C)&&!(C.length<1)){var x=C[0];if(x!="noop"&&x!="stop"&&x!="close")for(let z=1;z<C.length;z++)C[z]=""}}}}return Pi(V)}catch{return m}}var Zs={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Fi={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ui;function wl(){}f(wl,vf),wl.prototype.g=function(){return new XMLHttpRequest},Ui=new wl;function eo(l){return encodeURIComponent(String(l))}function ji(l){var m=1;l=l.split(":");let _=[];for(;m>0&&l.length;)_.push(l.shift()),m--;return l.length&&_.push(l.join(":")),_}function dr(l,m,_,C){this.j=l,this.i=m,this.l=_,this.S=C||1,this.V=new qr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Tf}function Tf(){this.i=null,this.g="",this.h=!1}var to={},Ga={};function no(l,m,_){l.M=1,l.A=oo(gn(m)),l.u=_,l.R=!0,ro(l,null)}function ro(l,m){l.F=Date.now(),Bi(l),l.B=gn(l.A);var _=l.B,C=l.S;Array.isArray(C)||(C=[String(C)]),Rf(_.i,"t",C),l.C=0,_=l.j.L,l.h=new Tf,l.g=sc(l.j,_?m:null,!l.u),l.P>0&&(l.O=new Il(d(l.Y,l,l.g),l.P)),m=l.V,_=l.g,C=l.ba;var x="readystatechange";Array.isArray(x)||(x&&(Dt[0]=x.toString()),x=Dt);for(let V=0;V<x.length;V++){let z=mf(_,x[V],C||m.handleEvent,!1,m.h||m);if(!z)break;m.g[z.key]=z}m=l.J?pf(l.J):{},l.u?(l.v||(l.v="POST"),m["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.B,l.v,l.u,m)):(l.v="GET",l.g.ea(l.B,l.v,null,m)),Oi(),za(l.i,l.v,l.B,l.l,l.S,l.u)}dr.prototype.ba=function(l){l=l.target;let m=this.O;m&&xe(l)==3?m.j():this.Y(l)},dr.prototype.Y=function(l){try{if(l==this.g)e:{let ae=xe(this.g),u=this.g.ya(),p=this.g.ca();if(!(ae<3)&&(ae!=3||this.g&&(this.h.h||this.g.la()||Vf(this.g)))){this.K||ae!=4||u==7||(u==8||p<=0?Oi(3):Oi(2)),Ka(this);var m=this.g.ca();this.X=m;var _=hr(this);if(this.o=m==200,Ef(this.i,this.v,this.B,this.l,this.S,ae,m),this.o){if(this.U&&!this.L){t:{if(this.g){var C,x=this.g;if((C=x.g?x.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(C)){var V=C;break t}}V=null}if(l=V)Pn(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,qi(this,l);else{this.o=!1,this.m=3,Rt(12),zr(this),$i(this);break e}}if(this.R){l=!0;let g;for(;!this.K&&this.C<_.length;)if(g=bf(this,_),g==Ga){ae==4&&(this.m=4,Rt(14),l=!1),Pn(this.i,this.l,null,"[Incomplete Response]");break}else if(g==to){this.m=4,Rt(15),Pn(this.i,this.l,_,"[Invalid Chunk]"),l=!1;break}else Pn(this.i,this.l,g,null),qi(this,g);if(Tl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ae!=4||_.length!=0||this.h.h||(this.m=1,Rt(16),l=!1),this.o=this.o&&l,!l)Pn(this.i,this.l,_,"[Invalid Chunked Response]"),zr(this),$i(this);else if(_.length>0&&!this.W){this.W=!0;var z=this.j;z.g==this&&z.aa&&!z.P&&(z.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),nc(z),z.P=!0,Rt(11))}}else Pn(this.i,this.l,_,null),qi(this,_);ae==4&&zr(this),this.o&&!this.K&&(ae==4?Vl(this.j,this):(this.o=!1,Bi(this)))}else O_(this.g),m==400&&_.indexOf("Unknown SID")>0?(this.m=3,Rt(12)):(this.m=0,Rt(13)),zr(this),$i(this)}}}catch{}};function hr(l){if(!Tl(l))return l.g.la();let m=Vf(l.g);if(m==="")return"";let _="",C=m.length,x=xe(l.g)==4;if(!l.h.i){if(typeof TextDecoder>"u")return zr(l),$i(l),"";l.h.i=new o.TextDecoder}for(let V=0;V<C;V++)l.h.h=!0,_+=l.h.i.decode(m[V],{stream:!(x&&V==C-1)});return m.length=0,l.h.g+=_,l.C=0,l.h.g}function Tl(l){return l.g?l.v=="GET"&&l.M!=2&&l.j.Aa:!1}function bf(l,m){var _=l.C,C=m.indexOf(`
`,_);return C==-1?Ga:(_=Number(m.substring(_,C)),isNaN(_)?to:(C+=1,C+_>m.length?Ga:(m=m.slice(C,C+_),l.C=C+_,m)))}dr.prototype.cancel=function(){this.K=!0,zr(this)};function Bi(l){l.T=Date.now()+l.H,Wa(l,l.H)}function Wa(l,m){if(l.D!=null)throw Error("WatchDog timer not null");l.D=mn(d(l.aa,l),m)}function Ka(l){l.D&&(o.clearTimeout(l.D),l.D=null)}dr.prototype.aa=function(){this.D=null;let l=Date.now();l-this.T>=0?(wf(this.i,this.B),this.M!=2&&(Oi(),Rt(17)),zr(this),this.m=2,$i(this)):Wa(this,this.T-l)};function $i(l){l.j.I==0||l.K||Vl(l.j,l)}function zr(l){Ka(l);var m=l.O;m&&typeof m.dispose=="function"&&m.dispose(),l.O=null,Pt(l.V),l.g&&(m=l.g,l.g=null,m.abort(),m.dispose())}function qi(l,m){try{var _=l.j;if(_.I!=0&&(_.g==l||io(_.h,l))){if(!l.L&&io(_.h,l)&&_.I==3){try{var C=_.Ba.g.parse(m)}catch{C=null}if(Array.isArray(C)&&C.length==3){var x=C;if(x[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<l.F)rc(_),Gr(_);else break e;Ji(_),Rt(18)}}else _.xa=x[1],0<_.xa-_.K&&x[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=mn(d(_.Va,_),6e3));fr(_.h)<=1&&_.ta&&(_.ta=void 0)}else mr(_,11)}else if((l.L||_.g==l)&&rc(_),!I(m))for(x=_.Ba.g.parse(m),m=0;m<x.length;m++){let p=x[m],g=p[0];if(!(g<=_.K))if(_.K=g,p=p[1],_.I==2)if(p[0]=="c"){_.M=p[1],_.ba=p[2];let A=p[3];A!=null&&(_.ka=A,_.j.info("VER="+_.ka));let k=p[4];k!=null&&(_.za=k,_.j.info("SVER="+_.za));let L=p[5];L!=null&&typeof L=="number"&&L>0&&(C=1.5*L,_.O=C,_.j.info("backChannelRequestTimeoutMs_="+C)),C=_;let H=l.g;if(H){let Ne=H.g?H.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ne){var V=C.h;V.g||Ne.indexOf("spdy")==-1&&Ne.indexOf("quic")==-1&&Ne.indexOf("h2")==-1||(V.j=V.l,V.g=new Set,V.h&&(bl(V,V.h),V.h=null))}if(C.G){let it=H.g?H.g.getResponseHeader("X-HTTP-Session-Id"):null;it&&(C.wa=it,je(C.J,C.G,it))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-l.F,_.j.info("Handshake RTT: "+_.T+"ms")),C=_;var z=l;if(C.na=ic(C,C.L?C.ba:null,C.W),z.L){Sl(C.h,z);var ae=z,u=C.O;u&&(ae.H=u),ae.D&&(Ka(ae),Bi(ae)),C.g=z}else tc(C);_.i.length>0&&on(_)}else p[0]!="stop"&&p[0]!="close"||mr(_,7);else _.I==3&&(p[0]=="stop"||p[0]=="close"?p[0]=="stop"?mr(_,7):ec(_):p[0]!="noop"&&_.l&&_.l.qa(p),_.A=0)}}Oi(4)}catch{}}var Sf=class{constructor(l,m){this.g=l,this.map=m}};function Qa(l){this.l=l||10,o.PerformanceNavigationTiming?(l=o.performance.getEntriesByType("navigation"),l=l.length>0&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Hi(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function fr(l){return l.h?1:l.g?l.g.size:0}function io(l,m){return l.h?l.h==m:l.g?l.g.has(m):!1}function bl(l,m){l.g?l.g.add(m):l.h=m}function Sl(l,m){l.h&&l.h==m?l.h=null:l.g&&l.g.has(m)&&l.g.delete(m)}Qa.prototype.cancel=function(){if(this.i=Al(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let l of this.g.values())l.cancel();this.g.clear()}};function Al(l){if(l.h!=null)return l.i.concat(l.h.G);if(l.g!=null&&l.g.size!==0){let m=l.i;for(let _ of l.g.values())m=m.concat(_.G);return m}return w(l.i)}var Cl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Dl(l,m){if(l){l=l.split("&");for(let _=0;_<l.length;_++){let C=l[_].indexOf("="),x,V=null;C>=0?(x=l[_].substring(0,C),V=l[_].substring(C+1)):x=l[_],m(x,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function xn(l){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let m;l instanceof xn?(this.l=l.l,zi(this,l.j),this.o=l.o,this.g=l.g,so(this,l.u),this.h=l.h,Rl(this,Nf(l.i)),this.m=l.m):l&&(m=String(l).match(Cl))?(this.l=!1,zi(this,m[1]||"",!0),this.o=ao(m[2]||""),this.g=ao(m[3]||"",!0),so(this,m[4]),this.h=ao(m[5]||"",!0),Rl(this,m[6]||"",!0),this.m=ao(m[7]||"")):(this.l=!1,this.i=new qn(null,this.l))}xn.prototype.toString=function(){let l=[];var m=this.j;m&&l.push(yn(m,co,!0),":");var _=this.g;return(_||m=="file")&&(l.push("//"),(m=this.o)&&l.push(yn(m,co,!0),"@"),l.push(eo(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&l.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&l.push("/"),l.push(yn(_,_.charAt(0)=="/"?Af:Ya,!0))),(_=this.i.toString())&&l.push("?",_),(_=this.m)&&l.push("#",yn(_,Ja)),l.join("")},xn.prototype.resolve=function(l){let m=gn(this),_=!!l.j;_?zi(m,l.j):_=!!l.o,_?m.o=l.o:_=!!l.g,_?m.g=l.g:_=l.u!=null;var C=l.h;if(_)so(m,l.u);else if(_=!!l.h){if(C.charAt(0)!="/")if(this.g&&!this.h)C="/"+C;else{var x=m.h.lastIndexOf("/");x!=-1&&(C=m.h.slice(0,x+1)+C)}if(x=C,x==".."||x==".")C="";else if(x.indexOf("./")!=-1||x.indexOf("/.")!=-1){C=x.lastIndexOf("/",0)==0,x=x.split("/");let V=[];for(let z=0;z<x.length;){let ae=x[z++];ae=="."?C&&z==x.length&&V.push(""):ae==".."?((V.length>1||V.length==1&&V[0]!="")&&V.pop(),C&&z==x.length&&V.push("")):(V.push(ae),C=!0)}C=V.join("/")}else C=x}return _?m.h=C:_=l.i.toString()!=="",_?Rl(m,Nf(l.i)):_=!!l.m,_&&(m.m=l.m),m};function gn(l){return new xn(l)}function zi(l,m,_){l.j=_?ao(m,!0):m,l.j&&(l.j=l.j.replace(/:$/,""))}function so(l,m){if(m){if(m=Number(m),isNaN(m)||m<0)throw Error("Bad port number "+m);l.u=m}else l.u=null}function Rl(l,m,_){m instanceof qn?(l.i=m,uo(l.i,l.l)):(_||(m=yn(m,He)),l.i=new qn(m,l.l))}function je(l,m,_){l.i.set(m,_)}function oo(l){return je(l,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),l}function ao(l,m){return l?m?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function yn(l,m,_){return typeof l=="string"?(l=encodeURI(l).replace(m,$n),_&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function $n(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var co=/[#\/\?@]/g,Ya=/[#\?:]/g,Af=/[#\?]/g,He=/[#\?@]/g,Ja=/#/g;function qn(l,m){this.h=this.g=null,this.i=l||null,this.j=!!m}function _n(l){l.g||(l.g=new Map,l.h=0,l.i&&Dl(l.i,function(m,_){l.add(decodeURIComponent(m.replace(/\+/g," ")),_)}))}n=qn.prototype,n.add=function(l,m){_n(this),this.i=null,l=Gi(this,l);let _=this.g.get(l);return _||this.g.set(l,_=[]),_.push(m),this.h+=1,this};function Cf(l,m){_n(l),m=Gi(l,m),l.g.has(m)&&(l.i=null,l.h-=l.g.get(m).length,l.g.delete(m))}function Nl(l,m){return _n(l),m=Gi(l,m),l.g.has(m)}n.forEach=function(l,m){_n(this),this.g.forEach(function(_,C){_.forEach(function(x){l.call(m,x,C,this)},this)},this)};function Df(l,m){_n(l);let _=[];if(typeof m=="string")Nl(l,m)&&(_=_.concat(l.g.get(Gi(l,m))));else for(l=Array.from(l.g.values()),m=0;m<l.length;m++)_=_.concat(l[m]);return _}n.set=function(l,m){return _n(this),this.i=null,l=Gi(this,l),Nl(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[m]),this.h+=1,this},n.get=function(l,m){return l?(l=Df(this,l),l.length>0?String(l[0]):m):m};function Rf(l,m,_){Cf(l,m),_.length>0&&(l.i=null,l.g.set(Gi(l,m),w(_)),l.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let l=[],m=Array.from(this.g.keys());for(let C=0;C<m.length;C++){var _=m[C];let x=eo(_);_=Df(this,_);for(let V=0;V<_.length;V++){let z=x;_[V]!==""&&(z+="="+eo(_[V])),l.push(z)}}return this.i=l.join("&")};function Nf(l){let m=new qn;return m.i=l.i,l.g&&(m.g=new Map(l.g),m.h=l.h),m}function Gi(l,m){return m=String(m),l.j&&(m=m.toLowerCase()),m}function uo(l,m){m&&!l.j&&(_n(l),l.i=null,l.g.forEach(function(_,C){let x=C.toLowerCase();C!=x&&(Cf(this,C),Rf(this,x,_))},l)),l.j=m}function pr(l,m){let _=new Li;if(o.Image){let C=new Image;C.onload=h(Hn,_,"TestLoadImage: loaded",!0,m,C),C.onerror=h(Hn,_,"TestLoadImage: error",!1,m,C),C.onabort=h(Hn,_,"TestLoadImage: abort",!1,m,C),C.ontimeout=h(Hn,_,"TestLoadImage: timeout",!1,m,C),o.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=l}else m(!1)}function Pf(l,m){let _=new Li,C=new AbortController,x=setTimeout(()=>{C.abort(),Hn(_,"TestPingServer: timeout",!1,m)},1e4);fetch(l,{signal:C.signal}).then(V=>{clearTimeout(x),V.ok?Hn(_,"TestPingServer: ok",!0,m):Hn(_,"TestPingServer: server error",!1,m)}).catch(()=>{clearTimeout(x),Hn(_,"TestPingServer: error",!1,m)})}function Hn(l,m,_,C,x){try{x&&(x.onload=null,x.onerror=null,x.onabort=null,x.ontimeout=null),C(_)}catch{}}function xf(){this.g=new _f}function zn(l){this.i=l.Sb||null,this.h=l.ab||!1}f(zn,vf),zn.prototype.g=function(){return new Xa(this.i,this.h)};function Xa(l,m){At.call(this),this.H=l,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(Xa,At),n=Xa.prototype,n.open=function(l,m){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=l,this.D=m,this.readyState=1,sn(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let m={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};l&&(m.body=l),(this.H||o).fetch(new Request(this.D,m)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,lo(this)),this.readyState=0},n.Pa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,sn(this)),this.g&&(this.readyState=3,sn(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;kf(this)}else l.text().then(this.Oa.bind(this),this.ga.bind(this))};function kf(l){l.j.read().then(l.Ma.bind(l)).catch(l.ga.bind(l))}n.Ma=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var m=l.value?l.value:new Uint8Array(0);(m=this.B.decode(m,{stream:!l.done}))&&(this.response=this.responseText+=m)}l.done?lo(this):sn(this),this.readyState==3&&kf(this)}},n.Oa=function(l){this.g&&(this.response=this.responseText=l,lo(this))},n.Na=function(l){this.g&&(this.response=l,lo(this))},n.ga=function(){this.g&&lo(this)};function lo(l){l.readyState=4,l.l=null,l.j=null,l.B=null,sn(l)}n.setRequestHeader=function(l,m){this.A.append(l,m)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let l=[],m=this.h.entries();for(var _=m.next();!_.done;)_=_.value,l.push(_[0]+": "+_[1]),_=m.next();return l.join(`\r
`)};function sn(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Xa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Mf(l){let m="";return Ni(l,function(_,C){m+=C,m+=":",m+=_,m+=`\r
`}),m}function Pl(l,m,_){e:{for(C in _){var C=!1;break e}C=!0}C||(_=Mf(_),typeof l=="string"?_!=null&&eo(_):je(l,m,_))}function Be(l){At.call(this),this.headers=new Map,this.L=l||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(Be,At);var Za=/^https?$/i,Of=["POST","PUT"];n=Be.prototype,n.Fa=function(l){this.H=l},n.ea=function(l,m,_,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);m=m?m.toUpperCase():"GET",this.D=l,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ui.g(),this.g.onreadystatechange=y(d(this.Ca,this));try{this.B=!0,this.g.open(m,String(l),!0),this.B=!1}catch(V){Wi(this,V);return}if(l=_||"",_=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var x in C)_.set(x,C[x]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(let V of C.keys())_.set(V,C.get(V));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(_.keys()).find(V=>V.toLowerCase()=="content-type"),x=o.FormData&&l instanceof o.FormData,!(Array.prototype.indexOf.call(Of,m,void 0)>=0)||C||x||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[V,z]of _)this.g.setRequestHeader(V,z);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(l),this.v=!1}catch(V){Wi(this,V)}};function Wi(l,m){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=m,l.o=5,Ki(l),Qi(l)}function Ki(l){l.A||(l.A=!0,Ct(l,"complete"),Ct(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=l||7,Ct(this,"complete"),Ct(this,"abort"),Qi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Qi(this,!0)),Be.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?xl(this):this.Xa())},n.Xa=function(){xl(this)};function xl(l){if(l.h&&typeof s<"u"){if(l.v&&xe(l)==4)setTimeout(l.Ca.bind(l),0);else if(Ct(l,"readystatechange"),xe(l)==4){l.h=!1;try{let V=l.ca();e:switch(V){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break e;default:m=!1}var _;if(!(_=m)){var C;if(C=V===0){let z=String(l.D).match(Cl)[1]||null;!z&&o.self&&o.self.location&&(z=o.self.location.protocol.slice(0,-1)),C=!Za.test(z?z.toLowerCase():"")}_=C}if(_)Ct(l,"complete"),Ct(l,"success");else{l.o=6;try{var x=xe(l)>2?l.g.statusText:""}catch{x=""}l.l=x+" ["+l.ca()+"]",Ki(l)}}finally{Qi(l)}}}}function Qi(l,m){if(l.g){l.m&&(clearTimeout(l.m),l.m=null);let _=l.g;l.g=null,m||Ct(l,"ready");try{_.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function xe(l){return l.g?l.g.readyState:0}n.ca=function(){try{return xe(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(l){if(this.g){var m=this.g.responseText;return l&&m.indexOf(l)==0&&(m=m.substring(l.length)),yf(m)}};function Vf(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.F){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function O_(l){let m={};l=(l.g&&xe(l)>=2&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<l.length;C++){if(I(l[C]))continue;var _=ji(l[C]);let x=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();let V=m[x]||[];m[x]=V,V.push(_)}ff(m,function(C){return C.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Yi(l,m,_){return _&&_.internalChannelParams&&_.internalChannelParams[l]||m}function kl(l){this.za=0,this.i=[],this.j=new Li,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Yi("failFast",!1,l),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Yi("baseRetryDelayMs",5e3,l),this.Za=Yi("retryDelaySeedMs",1e4,l),this.Ta=Yi("forwardChannelMaxRetries",2,l),this.va=Yi("forwardChannelRequestTimeoutMs",2e4,l),this.ma=l&&l.xmlHttpFactory||void 0,this.Ua=l&&l.Rb||void 0,this.Aa=l&&l.useFetchStreams||!1,this.O=void 0,this.L=l&&l.supportsCrossDomainXhr||!1,this.M="",this.h=new Qa(l&&l.concurrentRequestLimit),this.Ba=new xf,this.S=l&&l.fastHandshake||!1,this.R=l&&l.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=l&&l.Pb||!1,l&&l.ua&&this.j.ua(),l&&l.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&l&&l.detectBufferingProxy||!1,this.ia=void 0,l&&l.longPollingTimeout&&l.longPollingTimeout>0&&(this.ia=l.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=kl.prototype,n.ka=8,n.I=1,n.connect=function(l,m,_,C){Rt(0),this.W=l,this.H=m||{},_&&C!==void 0&&(this.H.OSID=_,this.H.OAID=C),this.F=this.X,this.J=ic(this,null,this.W),on(this)};function ec(l){if(Ml(l),l.I==3){var m=l.V++,_=gn(l.J);if(je(_,"SID",l.M),je(_,"RID",m),je(_,"TYPE","terminate"),Gn(l,_),m=new dr(l,l.j,m),m.M=2,m.A=oo(gn(_)),_=!1,o.navigator&&o.navigator.sendBeacon)try{_=o.navigator.sendBeacon(m.A.toString(),"")}catch{}!_&&o.Image&&(new Image().src=m.A,_=!0),_||(m.g=sc(m.j,null),m.g.ea(m.A)),m.F=Date.now(),Bi(m)}Ll(l)}function Gr(l){l.g&&(nc(l),l.g.cancel(),l.g=null)}function Ml(l){Gr(l),l.v&&(o.clearTimeout(l.v),l.v=null),rc(l),l.h.cancel(),l.m&&(typeof l.m=="number"&&o.clearTimeout(l.m),l.m=null)}function on(l){if(!Hi(l.h)&&!l.m){l.m=!0;var m=l.Ea;ue||v(),Z||(ue(),Z=!0),T.add(m,l),l.D=0}}function Lf(l,m){return fr(l.h)>=l.h.j-(l.m?1:0)?!1:l.m?(l.i=m.G.concat(l.i),!0):l.I==1||l.I==2||l.D>=(l.Sa?0:l.Ta)?!1:(l.m=mn(d(l.Ea,l,m),Xi(l,l.D)),l.D++,!0)}n.Ea=function(l){if(this.m)if(this.m=null,this.I==1){if(!l){this.V=Math.floor(Math.random()*1e5),l=this.V++;let x=new dr(this,this.j,l),V=this.o;if(this.U&&(V?(V=pf(V),St(V,this.U)):V=this.U),this.u!==null||this.R||(x.J=V,V=null),this.S)e:{for(var m=0,_=0;_<this.i.length;_++){t:{var C=this.i[_];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(m+=C,m>4096){m=_;break e}if(m===4096||_===this.i.length-1){m=_+1;break e}}m=1e3}else m=1e3;m=Ol(this,x,m),_=gn(this.J),je(_,"RID",l),je(_,"CVER",22),this.G&&je(_,"X-HTTP-Session-Id",this.G),Gn(this,_),V&&(this.R?m="headers="+eo(Mf(V))+"&"+m:this.u&&Pl(_,this.u,V)),bl(this.h,x),this.Ra&&je(_,"TYPE","init"),this.S?(je(_,"$req",m),je(_,"SID","null"),x.U=!0,no(x,_,null)):no(x,_,m),this.I=2}}else this.I==3&&(l?Ff(this,l):this.i.length==0||Hi(this.h)||Ff(this))};function Ff(l,m){var _;m?_=m.l:_=l.V++;let C=gn(l.J);je(C,"SID",l.M),je(C,"RID",_),je(C,"AID",l.K),Gn(l,C),l.u&&l.o&&Pl(C,l.u,l.o),_=new dr(l,l.j,_,l.D+1),l.u===null&&(_.J=l.o),m&&(l.i=m.G.concat(l.i)),m=Ol(l,_,1e3),_.H=Math.round(l.va*.5)+Math.round(l.va*.5*Math.random()),bl(l.h,_),no(_,C,m)}function Gn(l,m){l.H&&Ni(l.H,function(_,C){je(m,C,_)}),l.l&&Ni({},function(_,C){je(m,C,_)})}function Ol(l,m,_){_=Math.min(l.i.length,_);let C=l.l?d(l.l.Ka,l.l,l):null;e:{var x=l.i;let ae=-1;for(;;){let u=["count="+_];ae==-1?_>0?(ae=x[0].g,u.push("ofs="+ae)):ae=0:u.push("ofs="+ae);let p=!0;for(let g=0;g<_;g++){var V=x[g].g;let A=x[g].map;if(V-=ae,V<0)ae=Math.max(0,x[g].g-100),p=!1;else try{V="req"+V+"_"||"";try{var z=A instanceof Map?A:Object.entries(A);for(let[k,L]of z){let H=L;a(L)&&(H=Pi(L)),u.push(V+k+"="+encodeURIComponent(H))}}catch(k){throw u.push(V+"type="+encodeURIComponent("_badmap")),k}}catch{C&&C(A)}}if(p){z=u.join("&");break e}}z=void 0}return l=l.i.splice(0,_),m.G=l,z}function tc(l){if(!l.g&&!l.v){l.Y=1;var m=l.Da;ue||v(),Z||(ue(),Z=!0),T.add(m,l),l.A=0}}function Ji(l){return l.g||l.v||l.A>=3?!1:(l.Y++,l.v=mn(d(l.Da,l),Xi(l,l.A)),l.A++,!0)}n.Da=function(){if(this.v=null,ho(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var l=4*this.T;this.j.info("BP detection timer enabled: "+l),this.B=mn(d(this.Wa,this),l)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Rt(10),Gr(this),ho(this))};function nc(l){l.B!=null&&(o.clearTimeout(l.B),l.B=null)}function ho(l){l.g=new dr(l,l.j,"rpc",l.Y),l.u===null&&(l.g.J=l.o),l.g.P=0;var m=gn(l.na);je(m,"RID","rpc"),je(m,"SID",l.M),je(m,"AID",l.K),je(m,"CI",l.F?"0":"1"),!l.F&&l.ia&&je(m,"TO",l.ia),je(m,"TYPE","xmlhttp"),Gn(l,m),l.u&&l.o&&Pl(m,l.u,l.o),l.O&&(l.g.H=l.O);var _=l.g;l=l.ba,_.M=1,_.A=oo(gn(m)),_.u=null,_.R=!0,ro(_,l)}n.Va=function(){this.C!=null&&(this.C=null,Gr(this),Ji(this),Rt(19))};function rc(l){l.C!=null&&(o.clearTimeout(l.C),l.C=null)}function Vl(l,m){var _=null;if(l.g==m){rc(l),nc(l),l.g=null;var C=2}else if(io(l.h,m))_=m.G,Sl(l.h,m),C=1;else return;if(l.I!=0){if(m.o)if(C==1){_=m.u?m.u.length:0,m=Date.now()-m.F;var x=l.D;C=Mi(),Ct(C,new Ha(C,_)),on(l)}else tc(l);else if(x=m.m,x==3||x==0&&m.X>0||!(C==1&&Lf(l,m)||C==2&&Ji(l)))switch(_&&_.length>0&&(m=l.h,m.i=m.i.concat(_)),x){case 1:mr(l,5);break;case 4:mr(l,10);break;case 3:mr(l,6);break;default:mr(l,2)}}}function Xi(l,m){let _=l.Qa+Math.floor(Math.random()*l.Za);return l.isActive()||(_*=2),_*m}function mr(l,m){if(l.j.info("Error code "+m),m==2){var _=d(l.bb,l),C=l.Ua;let x=!C;C=new xn(C||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||zi(C,"https"),oo(C),x?pr(C.toString(),_):Pf(C.toString(),_)}else Rt(2);l.I=0,l.l&&l.l.pa(m),Ll(l),Ml(l)}n.bb=function(l){l?(this.j.info("Successfully pinged google.com"),Rt(2)):(this.j.info("Failed to ping google.com"),Rt(1))};function Ll(l){if(l.I=0,l.ja=[],l.l){let m=Al(l.h);(m.length!=0||l.i.length!=0)&&(R(l.ja,m),R(l.ja,l.i),l.h.i.length=0,w(l.i),l.i.length=0),l.l.oa()}}function ic(l,m,_){var C=_ instanceof xn?gn(_):new xn(_);if(C.g!="")m&&(C.g=m+"."+C.g),so(C,C.u);else{var x=o.location;C=x.protocol,m=m?m+"."+x.hostname:x.hostname,x=+x.port;let V=new xn(null);C&&zi(V,C),m&&(V.g=m),x&&so(V,x),_&&(V.h=_),C=V}return _=l.G,m=l.wa,_&&m&&je(C,_,m),je(C,"VER",l.ka),Gn(l,C),C}function sc(l,m,_){if(m&&!l.L)throw Error("Can't create secondary domain capable XhrIo object.");return m=l.Aa&&!l.ma?new Be(new zn({ab:_})):new Be(l.ma),m.Fa(l.L),m}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Fl(){}n=Fl.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Wr(){}Wr.prototype.g=function(l,m){return new jt(l,m)};function jt(l,m){At.call(this),this.g=new kl(m),this.l=l,this.h=m&&m.messageUrlParams||null,l=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(l?l["X-WebChannel-Content-Type"]=m.messageContentType:l={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.sa&&(l?l["X-WebChannel-Client-Profile"]=m.sa:l={"X-WebChannel-Client-Profile":m.sa}),this.g.U=l,(l=m&&m.Qb)&&!I(l)&&(this.g.u=l),this.A=m&&m.supportsCrossDomainXhr||!1,this.v=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!I(m)&&(this.g.G=m,l=this.h,l!==null&&m in l&&(l=this.h,m in l&&delete l[m])),this.j=new Kr(this)}f(jt,At),jt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},jt.prototype.close=function(){ec(this.g)},jt.prototype.o=function(l){var m=this.g;if(typeof l=="string"){var _={};_.__data__=l,l=_}else this.v&&(_={},_.__data__=Pi(l),l=_);m.i.push(new Sf(m.Ya++,l)),m.I==3&&on(m)},jt.prototype.N=function(){this.g.l=null,delete this.j,ec(this.g),delete this.g,jt.Z.N.call(this)};function Ul(l){qa.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var m=l.__sm__;if(m){e:{for(let _ in m){l=_;break e}l=void 0}(this.i=l)&&(l=this.i,m=m!==null&&l in m?m[l]:void 0),this.data=m}else this.data=l}f(Ul,qa);function gr(){Xs.call(this),this.status=1}f(gr,Xs);function Kr(l){this.g=l}f(Kr,Fl),Kr.prototype.ra=function(){Ct(this.g,"a")},Kr.prototype.qa=function(l){Ct(this.g,new Ul(l))},Kr.prototype.pa=function(l){Ct(this.g,new gr)},Kr.prototype.oa=function(){Ct(this.g,"b")},Wr.prototype.createWebChannel=Wr.prototype.g,jt.prototype.send=jt.prototype.o,jt.prototype.open=jt.prototype.m,jt.prototype.close=jt.prototype.close,Hw=di.createWebChannelTransport=function(){return new Wr},qw=di.getStatEventTarget=function(){return Mi()},$w=di.Event=Hr,eg=di.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Zs.NO_ERROR=0,Zs.TIMEOUT=8,Zs.HTTP_ERROR=6,Ud=di.ErrorCode=Zs,Fi.COMPLETE="complete",Bw=di.EventType=Fi,xi.EventType=ki,ki.OPEN="a",ki.CLOSE="b",ki.ERROR="c",ki.MESSAGE="d",At.prototype.listen=At.prototype.J,Kc=di.WebChannel=xi,pz=di.FetchXmlHttpFactory=zn,Be.prototype.listenOnce=Be.prototype.K,Be.prototype.getLastError=Be.prototype.Ha,Be.prototype.getLastErrorCode=Be.prototype.ya,Be.prototype.getStatus=Be.prototype.ca,Be.prototype.getResponseJson=Be.prototype.La,Be.prototype.getResponseText=Be.prototype.la,Be.prototype.send=Be.prototype.ea,Be.prototype.setWithCredentials=Be.prototype.Fa,jw=di.XhrIo=Be}).apply(typeof Zm<"u"?Zm:typeof self<"u"?self:typeof window<"u"?window:{});var Kt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Kt.UNAUTHENTICATED=new Kt(null),Kt.GOOGLE_CREDENTIALS=new Kt("google-credentials-uid"),Kt.FIRST_PARTY=new Kt("first-party-uid"),Kt.MOCK_USER=new Kt("mock-user");var yu="12.9.0";function Ok(n){yu=n}var ea=new Gc("@firebase/firestore");function Qc(){return ea.logLevel}function J(n,...e){if(ea.logLevel<=Ae.DEBUG){let t=e.map(_b);ea.debug(`Firestore (${yu}): ${n}`,...t)}}function fi(n,...e){if(ea.logLevel<=Ae.ERROR){let t=e.map(_b);ea.error(`Firestore (${yu}): ${n}`,...t)}}function _s(n,...e){if(ea.logLevel<=Ae.WARN){let t=e.map(_b);ea.warn(`Firestore (${yu}): ${n}`,...t)}}function _b(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function ce(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,Vk(n,r,t)}function Vk(n,e,t){let r=`FIRESTORE (${yu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw fi(r),new Error(r)}function Je(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||Vk(e,i,r)}function Ee(n,e){return n}var K={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},ne=class extends ci{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var hi=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Jw=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},og=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Kt.UNAUTHENTICATED))}shutdown(){}};var ag=class{constructor(e){this.t=e,this.currentUser=Kt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Je(this.o===void 0,42304);let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new hi;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new hi,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},a=c=>{J("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(J("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new hi)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(J("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Je(typeof r.accessToken=="string",31837,{l:r}),new Jw(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return Je(e===null||typeof e=="string",2055,{h:e}),new Kt(e)}},Xw=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Kt.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);let e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}},Zw=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Xw(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Kt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},cg=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},ug=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Cx(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Je(this.o===void 0,3512);let r=s=>{s.error!=null&&J("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.m;return this.m=s.token,J("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{J("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.V.getImmediate({optional:!0});s?i(s):J("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new cg(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Je(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new cg(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function mz(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var ru=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=mz(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}};function Se(n,e){return n<e?-1:n>e?1:0}function eT(n,e){let t=Math.min(n.length,e.length);for(let r=0;r<t;r++){let i=n.charAt(r),s=e.charAt(r);if(i!==s)return zw(i)===zw(s)?Se(i,s):zw(i)?1:-1}return Se(n.length,e.length)}var gz=55296,yz=57343;function zw(n){let e=n.charCodeAt(0);return e>=gz&&e<=yz}function iu(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Yx="__name__",lg=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&ce(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&ce(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return Se(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):eT(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return li.fromString(e.substring(4,e.length-2))}},gt=class n extends lg{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new ne(K.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},_z=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Un=class n extends lg{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return _z.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Yx}static keyField(){return new n([Yx])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new ne(K.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new ne(K.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new ne(K.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new ne(K.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var oe=class n{constructor(e){this.path=e}static fromPath(e){return new n(gt.fromString(e))}static fromName(e){return new n(gt.fromString(e).popFirst(5))}static empty(){return new n(gt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&gt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return gt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new gt(e.slice()))}};function Lk(n,e,t,r){if(e===!0&&r===!0)throw new ne(K.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function vz(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Fk(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ce(12329,{type:typeof n})}function _u(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ne(K.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Fk(n);throw new ne(K.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function at(n,e){let t={typeString:n};return e&&(t.value=e),t}function vu(n,e){if(!vz(n))throw new ne(K.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new ne(K.INVALID_ARGUMENT,t);return!0}var Jx=-62135596800,Xx=1e6,Qt=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Xx);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ne(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ne(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Jx)throw new ne(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ne(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Xx}_compareTo(e){return this.seconds===e.seconds?Se(this.nanoseconds,e.nanoseconds):Se(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(vu(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-Jx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};Qt._jsonSchemaVersion="firestore/timestamp/1.0",Qt._jsonSchema={type:at("string",Qt._jsonSchemaVersion),seconds:at("number"),nanoseconds:at("number")};var fe=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Qt(0,0))}static max(){return new n(new Qt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var zd=-1,dg=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};dg.UNKNOWN_ID=-1;function Iz(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=fe.fromTimestamp(r===1e9?new Qt(t+1,0):new Qt(t,r));return new ta(i,oe.empty(),e)}function Ez(n){return new ta(n.readTime,n.key,zd)}var ta=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(fe.min(),oe.empty(),zd)}static max(){return new n(fe.max(),oe.empty(),zd)}};function wz(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=oe.comparator(n.documentKey,e.documentKey),t!==0?t:Se(n.largestBatchId,e.largestBatchId))}var Tz="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",tT=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function Vg(n){if(n.code!==K.FAILED_PRECONDITION||n.message!==Tz)throw n;J("LocalStore","Unexpectedly lost primary lease")}var B=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ce(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let d=c;t(e[d]).next(h=>{o[d]=h,++a,a===s&&r(o)},h=>i(h))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function bz(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Iu(n){return n.name==="IndexedDbTransactionError"}var vb=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>r.writeSequenceNumber(i))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ue&&this.ue(t),t}}n.ce=-1;return n})(),Sz=-1;function Lg(n){return n==null}function hg(n){return n===0&&1/n==-1/0}var Uk="";function Az(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Zx(e)),e=Cz(n.get(t),e);return Zx(e)}function Cz(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case Uk:t+="";break;default:t+=s}}return t}function Zx(n){return n+Uk+""}var Dz="remoteDocuments",jk="owner";var Bk="mutationQueues";var $k="mutations";var qk="documentMutations",Rz="remoteDocumentsV14";var Hk="remoteDocumentGlobal";var zk="targets";var Gk="targetDocuments";var Wk="targetGlobal",Kk="collectionParents";var Qk="clientMetadata";var Yk="bundles";var Jk="namedQueries";var Nz="indexConfiguration";var Pz="indexState";var xz="indexEntries";var Xk="documentOverlays";var kz="globals";var Mz=[Bk,$k,qk,Dz,zk,jk,Wk,Gk,Qk,Hk,Kk,Yk,Jk],Xue=[...Mz,Xk],Oz=[Bk,$k,qk,Rz,zk,jk,Wk,Gk,Qk,Hk,Kk,Yk,Jk,Xk],Vz=Oz,Lz=[...Vz,Nz,Pz,xz];var Zue=[...Lz,kz];function ek(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function oh(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Zk(n,e){let t=[];for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function Fz(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ct=class n{constructor(e,t){this.comparator=e,this.root=t||Dr.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Dr.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Dr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Xc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Xc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Xc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Xc(this.root,e,this.comparator,!0)}},Xc=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Dr=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ce(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ce(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw ce(27949);return e+(this.isRed()?0:1)}};Dr.EMPTY=null,Dr.RED=!0,Dr.BLACK=!1;Dr.EMPTY=new class{constructor(){this.size=0}get key(){throw ce(57766)}get value(){throw ce(16141)}get color(){throw ce(16727)}get left(){throw ce(29726)}get right(){throw ce(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new Dr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var kt=class n{constructor(e){this.comparator=e,this.data=new ct(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new fg(this.data.getIterator())}getIteratorFrom(e){return new fg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},fg=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Qo=class n{constructor(e){this.fields=e,e.sort(Un.comparator)}static empty(){return new n([])}unionWith(e){let t=new kt(Un.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return iu(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var pg=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Ut=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new pg("Invalid base64 string: "+s):s}})(e);return new n(t)}static fromUint8Array(e){let t=(function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Se(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ut.EMPTY_BYTE_STRING=new Ut("");var Uz=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pi(n){if(Je(!!n,39018),typeof n=="string"){let e=0,t=Uz.exec(n);if(Je(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ye(n.seconds),nanos:Ye(n.nanos)}}function Ye(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function mi(n){return typeof n=="string"?Ut.fromBase64String(n):Ut.fromUint8Array(n)}var e1="server_timestamp",t1="__type__",n1="__previous_value__",r1="__local_write_time__";function Fg(n){return(n?.mapValue?.fields||{})[t1]?.stringValue===e1}function Ug(n){let e=n.mapValue.fields[n1];return Fg(e)?Ug(e):e}function Gd(n){let e=pi(n.mapValue.fields[r1].timestampValue);return new Qt(e.seconds,e.nanos)}var nT=class{constructor(e,t,r,i,s,o,a,c,d,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=d,this.isUsingEmulator=h,this.apiKey=f}},rT="(default)",Wd=class n{constructor(e,t){this.projectId=e,this.database=t||rT}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===rT}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};function i1(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new ne(K.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Wd(n.options.projectId,e)}var s1="__type__",o1="__max__",tg={mapValue:{fields:{__type__:{stringValue:o1}}}},a1="__vector__",Kd="value";function vs(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Fg(n)?4:u1(n)?9007199254740991:c1(n)?10:11:ce(28295,{value:n})}function Nr(n,e){if(n===e)return!0;let t=vs(n);if(t!==vs(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Gd(n).isEqual(Gd(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=pi(i.timestampValue),a=pi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return mi(i.bytesValue).isEqual(mi(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return Ye(i.geoPointValue.latitude)===Ye(s.geoPointValue.latitude)&&Ye(i.geoPointValue.longitude)===Ye(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return Ye(i.integerValue)===Ye(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Ye(i.doubleValue),a=Ye(s.doubleValue);return o===a?hg(o)===hg(a):isNaN(o)&&isNaN(a)}return!1})(n,e);case 9:return iu(n.arrayValue.values||[],e.arrayValue.values||[],Nr);case 10:case 11:return(function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(ek(o)!==ek(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Nr(o[c],a[c])))return!1;return!0})(n,e);default:return ce(52216,{left:n})}}function Qd(n,e){return(n.values||[]).find(t=>Nr(t,e))!==void 0}function su(n,e){if(n===e)return 0;let t=vs(n),r=vs(e);if(t!==r)return Se(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Se(n.booleanValue,e.booleanValue);case 2:return(function(s,o){let a=Ye(s.integerValue||s.doubleValue),c=Ye(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1})(n,e);case 3:return tk(n.timestampValue,e.timestampValue);case 4:return tk(Gd(n),Gd(e));case 5:return eT(n.stringValue,e.stringValue);case 6:return(function(s,o){let a=mi(s),c=mi(o);return a.compareTo(c)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){let a=s.split("/"),c=o.split("/");for(let d=0;d<a.length&&d<c.length;d++){let h=Se(a[d],c[d]);if(h!==0)return h}return Se(a.length,c.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){let a=Se(Ye(s.latitude),Ye(o.latitude));return a!==0?a:Se(Ye(s.longitude),Ye(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return nk(n.arrayValue,e.arrayValue);case 10:return(function(s,o){let a=s.fields||{},c=o.fields||{},d=a[Kd]?.arrayValue,h=c[Kd]?.arrayValue,f=Se(d?.values?.length||0,h?.values?.length||0);return f!==0?f:nk(d,h)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===tg.mapValue&&o===tg.mapValue)return 0;if(s===tg.mapValue)return 1;if(o===tg.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),d=o.fields||{},h=Object.keys(d);c.sort(),h.sort();for(let f=0;f<c.length&&f<h.length;++f){let y=eT(c[f],h[f]);if(y!==0)return y;let w=su(a[c[f]],d[h[f]]);if(w!==0)return w}return Se(c.length,h.length)})(n.mapValue,e.mapValue);default:throw ce(23264,{he:t})}}function tk(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Se(n,e);let t=pi(n),r=pi(e),i=Se(t.seconds,r.seconds);return i!==0?i:Se(t.nanos,r.nanos)}function nk(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=su(t[i],r[i]);if(s)return s}return Se(t.length,r.length)}function ou(n){return iT(n)}function iT(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let r=pi(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return mi(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return oe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=iT(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${iT(t.fields[o])}`;return i+"}"})(n.mapValue):ce(61005,{value:n})}function ig(n){switch(vs(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Ug(n);return e?16+ig(e):16;case 5:return 2*n.stringValue.length;case 6:return mi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce((i,s)=>i+ig(s),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return oh(r.fields,(s,o)=>{i+=s.length+ig(o)}),i})(n.mapValue);default:throw ce(13486,{value:n})}}function sT(n){return!!n&&"integerValue"in n}function Ib(n){return!!n&&"arrayValue"in n}function rk(n){return!!n&&"nullValue"in n}function ik(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Gw(n){return!!n&&"mapValue"in n}function c1(n){return(n?.mapValue?.fields||{})[s1]?.stringValue===a1}function $d(n){if(n.geoPointValue)return{geoPointValue:et({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:et({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return oh(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=$d(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=$d(n.arrayValue.values[t]);return e}return et({},n)}function u1(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===o1}var tle={mapValue:{fields:{[s1]:{stringValue:a1},[Kd]:{arrayValue:{}}}}};var rr=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Gw(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=$d(t)}setAll(e){let t=Un.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=$d(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Gw(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Nr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Gw(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){oh(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n($d(this.value))}};var ir=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,fe.min(),fe.min(),fe.min(),rr.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,fe.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,fe.min(),fe.min(),rr.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,fe.min(),fe.min(),rr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=rr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=rr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var na=class{constructor(e,t){this.position=e,this.inclusive=t}};function sk(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=oe.comparator(oe.fromName(o.referenceValue),t.key):r=su(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function ok(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Nr(n.position[t],e.position[t]))return!1;return!0}var ra=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function jz(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var mg=class{},yt=class n extends mg{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new aT(e,t,r):t==="array-contains"?new lT(e,r):t==="in"?new dT(e,r):t==="not-in"?new hT(e,r):t==="array-contains-any"?new fT(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new cT(e,r):new uT(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(su(t,this.value)):t!==null&&vs(this.value)===vs(t)&&this.matchesComparison(su(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ce(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},sr=class n extends mg{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new n(e,t)}matches(e){return l1(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function l1(n){return n.op==="and"}function d1(n){return Bz(n)&&l1(n)}function Bz(n){for(let e of n.filters)if(e instanceof sr)return!1;return!0}function oT(n){if(n instanceof yt)return n.field.canonicalString()+n.op.toString()+ou(n.value);if(d1(n))return n.filters.map(e=>oT(e)).join(",");{let e=n.filters.map(t=>oT(t)).join(",");return`${n.op}(${e})`}}function h1(n,e){return n instanceof yt?(function(r,i){return i instanceof yt&&r.op===i.op&&r.field.isEqual(i.field)&&Nr(r.value,i.value)})(n,e):n instanceof sr?(function(r,i){return i instanceof sr&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&h1(o,i.filters[a]),!0):!1})(n,e):void ce(19439)}function f1(n){return n instanceof yt?(function(t){return`${t.field.canonicalString()} ${t.op} ${ou(t.value)}`})(n):n instanceof sr?(function(t){return t.op.toString()+" {"+t.getFilters().map(f1).join(" ,")+"}"})(n):"Filter"}var aT=class extends yt{constructor(e,t,r){super(e,t,r),this.key=oe.fromName(r.referenceValue)}matches(e){let t=oe.comparator(e.key,this.key);return this.matchesComparison(t)}},cT=class extends yt{constructor(e,t){super(e,"in",t),this.keys=p1("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},uT=class extends yt{constructor(e,t){super(e,"not-in",t),this.keys=p1("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function p1(n,e){return(e.arrayValue?.values||[]).map(t=>oe.fromName(t.referenceValue))}var lT=class extends yt{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Ib(t)&&Qd(t.arrayValue,this.value)}},dT=class extends yt{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Qd(this.value.arrayValue,t)}},hT=class extends yt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Qd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Qd(this.value.arrayValue,t)}},fT=class extends yt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Ib(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Qd(this.value.arrayValue,r))}};var pT=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}};function ak(n,e=null,t=[],r=[],i=null,s=null,o=null){return new pT(n,e,t,r,i,s,o)}function Eb(n){let e=Ee(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>oT(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>(function(s){return s.field.canonicalString()+s.dir})(r)).join(","),Lg(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>ou(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>ou(r)).join(",")),e.Te=t}return e.Te}function wb(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!jz(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!h1(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!ok(n.startAt,e.startAt)&&ok(n.endAt,e.endAt)}function mT(n){return oe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var au=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}};function $z(n,e,t,r,i,s,o,a){return new au(n,e,t,r,i,s,o,a)}function jg(n){return new au(n)}function ck(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function qz(n){return oe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function m1(n){return n.collectionGroup!==null}function Zc(n){let e=Ee(n);if(e.Ie===null){e.Ie=[];let t=new Set;for(let s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new kt(Un.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new ra(s,r))}),t.has(Un.keyField().canonicalString())||e.Ie.push(new ra(Un.keyField(),r))}return e.Ie}function Rr(n){let e=Ee(n);return e.Ee||(e.Ee=g1(e,Zc(n))),e.Ee}function Hz(n){let e=Ee(n);return e.Re||(e.Re=g1(e,n.explicitOrderBy)),e.Re}function g1(n,e){if(n.limitType==="F")return ak(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new ra(i.field,s)});let t=n.endAt?new na(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new na(n.startAt.position,n.startAt.inclusive):null;return ak(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function gg(n,e,t){return new au(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Bg(n,e){return wb(Rr(n),Rr(e))&&n.limitType===e.limitType}function y1(n){return`${Eb(Rr(n))}|lt:${n.limitType}`}function Yc(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>f1(i)).join(", ")}]`),Lg(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>ou(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>ou(i)).join(",")),`Target(${r})`})(Rr(n))}; limitType=${n.limitType})`}function $g(n,e){return e.isFoundDocument()&&(function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):oe.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(let s of Zc(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(o,a,c){let d=sk(o,a,c);return o.inclusive?d<=0:d<0})(r.startAt,Zc(r),i)||r.endAt&&!(function(o,a,c){let d=sk(o,a,c);return o.inclusive?d>=0:d>0})(r.endAt,Zc(r),i))})(n,e)}function zz(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function _1(n){return(e,t)=>{let r=!1;for(let i of Zc(n)){let s=Gz(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Gz(n,e,t){let r=n.field.isKeyField()?oe.comparator(e.key,t.key):(function(s,o,a){let c=o.data.field(s),d=a.data.field(s);return c!==null&&d!==null?su(c,d):ce(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ce(19790,{direction:n.dir})}}var gi=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){oh(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return Fz(this.inner)}size(){return this.innerSize}};var Wz=new ct(oe.comparator);function Is(){return Wz}var v1=new ct(oe.comparator);function Bd(...n){let e=v1;for(let t of n)e=e.insert(t.key,t);return e}function Kz(n){let e=v1;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Yo(){return qd()}function I1(){return qd()}function qd(){return new gi(n=>n.toString(),(n,e)=>n.isEqual(e))}var nle=new ct(oe.comparator),Qz=new kt(oe.comparator);function De(...n){let e=Qz;for(let t of n)e=e.add(t);return e}var Yz=new kt(Se);function Jz(){return Yz}function Xz(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:hg(e)?"-0":e}}function Zz(n){return{integerValue:""+n}}var cu=class{constructor(){this._=void 0}};function e3(n,e,t){return n instanceof Yd?(function(i,s){let o={fields:{[t1]:{stringValue:e1},[r1]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Fg(s)&&(s=Ug(s)),s&&(o.fields[n1]=s),{mapValue:o}})(t,e):n instanceof uu?E1(n,e):n instanceof lu?w1(n,e):(function(i,s){let o=n3(i,s),a=uk(o)+uk(i.Ae);return sT(o)&&sT(i.Ae)?Zz(a):Xz(i.serializer,a)})(n,e)}function t3(n,e,t){return n instanceof uu?E1(n,e):n instanceof lu?w1(n,e):t}function n3(n,e){return n instanceof Jd?(function(r){return sT(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}var Yd=class extends cu{},uu=class extends cu{constructor(e){super(),this.elements=e}};function E1(n,e){let t=T1(e);for(let r of n.elements)t.some(i=>Nr(i,r))||t.push(r);return{arrayValue:{values:t}}}var lu=class extends cu{constructor(e){super(),this.elements=e}};function w1(n,e){let t=T1(e);for(let r of n.elements)t=t.filter(i=>!Nr(i,r));return{arrayValue:{values:t}}}var Jd=class extends cu{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function uk(n){return Ye(n.integerValue||n.doubleValue)}function T1(n){return Ib(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function r3(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof uu&&i instanceof uu||r instanceof lu&&i instanceof lu?iu(r.elements,i.elements,Nr):r instanceof Jd&&i instanceof Jd?Nr(r.Ae,i.Ae):r instanceof Yd&&i instanceof Yd})(n.transform,e.transform)}var eu=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function sg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Xd=class{};function b1(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new yg(n.key,eu.none()):new Zd(n.key,n.data,eu.none());{let t=n.data,r=rr.empty(),i=new kt(Un.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new du(n.key,r,new Qo(i.toArray()),eu.none())}}function i3(n,e,t){n instanceof Zd?(function(i,s,o){let a=i.value.clone(),c=dk(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(n,e,t):n instanceof du?(function(i,s,o){if(!sg(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=dk(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(S1(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):(function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Hd(n,e,t,r){return n instanceof Zd?(function(s,o,a,c){if(!sg(s.precondition,o))return a;let d=s.value.clone(),h=hk(s.fieldTransforms,c,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null})(n,e,t,r):n instanceof du?(function(s,o,a,c){if(!sg(s.precondition,o))return a;let d=hk(s.fieldTransforms,c,o),h=o.data;return h.setAll(S1(s)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))})(n,e,t,r):(function(s,o,a){return sg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(n,e,t)}function lk(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&iu(r,i,(s,o)=>r3(s,o))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Zd=class extends Xd{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},du=class extends Xd{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function S1(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function dk(n,e,t){let r=new Map;Je(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,t3(o,a,t[i]))}return r}function hk(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,e3(s,o,e))}return r}var yg=class extends Xd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}};var gT=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&i3(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Hd(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Hd(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=I1();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=b1(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(fe.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),De())}isEqual(e){return this.batchId===e.batchId&&iu(this.mutations,e.mutations,(t,r)=>lk(t,r))&&iu(this.baseMutations,e.baseMutations,(t,r)=>lk(t,r))}};var yT=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var _g=class{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}};var _T=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var pt,Ce;function A1(n){if(n===void 0)return fi("GRPC error has no .code"),K.UNKNOWN;switch(n){case pt.OK:return K.OK;case pt.CANCELLED:return K.CANCELLED;case pt.UNKNOWN:return K.UNKNOWN;case pt.DEADLINE_EXCEEDED:return K.DEADLINE_EXCEEDED;case pt.RESOURCE_EXHAUSTED:return K.RESOURCE_EXHAUSTED;case pt.INTERNAL:return K.INTERNAL;case pt.UNAVAILABLE:return K.UNAVAILABLE;case pt.UNAUTHENTICATED:return K.UNAUTHENTICATED;case pt.INVALID_ARGUMENT:return K.INVALID_ARGUMENT;case pt.NOT_FOUND:return K.NOT_FOUND;case pt.ALREADY_EXISTS:return K.ALREADY_EXISTS;case pt.PERMISSION_DENIED:return K.PERMISSION_DENIED;case pt.FAILED_PRECONDITION:return K.FAILED_PRECONDITION;case pt.ABORTED:return K.ABORTED;case pt.OUT_OF_RANGE:return K.OUT_OF_RANGE;case pt.UNIMPLEMENTED:return K.UNIMPLEMENTED;case pt.DATA_LOSS:return K.DATA_LOSS;default:return ce(39323,{code:n})}}(Ce=pt||(pt={}))[Ce.OK=0]="OK",Ce[Ce.CANCELLED=1]="CANCELLED",Ce[Ce.UNKNOWN=2]="UNKNOWN",Ce[Ce.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ce[Ce.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ce[Ce.NOT_FOUND=5]="NOT_FOUND",Ce[Ce.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ce[Ce.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ce[Ce.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ce[Ce.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ce[Ce.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ce[Ce.ABORTED=10]="ABORTED",Ce[Ce.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ce[Ce.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ce[Ce.INTERNAL=13]="INTERNAL",Ce[Ce.UNAVAILABLE=14]="UNAVAILABLE",Ce[Ce.DATA_LOSS=15]="DATA_LOSS";var s3=null;function o3(){return new TextEncoder}var a3=new li([4294967295,4294967295],0);function fk(n){let e=o3().encode(n),t=new Uw;return t.update(e),new Uint8Array(t.digest())}function pk(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new li([t,r],0),new li([i,s],0)]}var vT=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Jo(`Invalid padding: ${t}`);if(r<0)throw new Jo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Jo(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Jo(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=li.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(li.fromNumber(r)));return i.compare(a3)===1&&(i=new li([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;let t=fk(e),[r,i]=pk(t);for(let s=0;s<this.hashCount;s++){let o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;let t=fk(e),[r,i]=pk(t);for(let s=0;s<this.hashCount;s++){let o=this.ye(r,i,s);this.be(o)}}be(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Jo=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var vg=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,eh.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(fe.min(),i,new ct(Se),Is(),De())}},eh=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,De(),De(),De())}};var tu=class{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.De=i}},Ig=class{constructor(e,t){this.targetId=e,this.Ce=t}},Eg=class{constructor(e,t,r=Ut.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},wg=class{constructor(){this.ve=0,this.Fe=mk(),this.Me=Ut.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=De(),t=De(),r=De();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:ce(38017,{changeType:s})}}),new eh(this.Me,this.xe,e,t,r)}Ke(){this.Oe=!1,this.Fe=mk()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Je(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}},IT=class{constructor(e){this.Ge=e,this.ze=new Map,this.je=Is(),this.He=ng(),this.Je=ng(),this.Ze=new ct(Se)}Xe(e){for(let t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{let r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:ce(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((r,i)=>{this.rt(i)&&t(i)})}st(e){let t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){let s=i.target;if(mT(s))if(r===0){let o=new oe(s.path);this.et(t,o,ir.newNoDocument(o,fe.min()))}else Je(r===1,20013,{expectedCount:r});else{let o=this._t(t);if(o!==r){let a=this.ut(e),c=a?this.ct(a,e,o):1;if(c!==0){this.it(t);let d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,d)}s3?.lt((function(h,f,y,w,R){let N={localCacheCount:h,existenceFilterCount:f.count,databaseId:y.database,projectId:y.projectId},P=f.unchangedNames;return P&&(N.bloomFilter={applied:R===0,hashCount:P?.hashCount??0,bitmapLength:P?.bits?.bitmap?.length??0,padding:P?.bits?.padding??0,mightContain:F=>w?.mightContain(F)??!1}),N})(o,e.Ce,this.Ge.ht(),a,c))}}}}ut(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=mi(r).toUint8Array()}catch(c){if(c instanceof pg)return _s("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new vT(o,i,s)}catch(c){return _s(c instanceof Jo?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){let r=this.Ge.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(t,s,null),i++)}),i}Tt(e){let t=new Map;this.ze.forEach((s,o)=>{let a=this.ot(o);if(a){if(s.current&&mT(a.target)){let c=new oe(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,ir.newNoDocument(c,e))}s.Be&&(t.set(o,s.ke()),s.Ke())}});let r=De();this.Je.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let d=this.ot(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));let i=new vg(e,t,this.Ze,this.je,r);return this.je=Is(),this.He=ng(),this.Je=ng(),this.Ze=new ct(Se),i}Ye(e,t){if(!this.rt(e))return;let r=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,r),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;let i=this.nt(e);this.Et(e,t)?i.qe(t,1):i.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new wg,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new kt(Se),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new kt(Se),this.He=this.He.insert(e,t)),t}rt(e){let t=this.ot(e)!==null;return t||J("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new wg),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}};function ng(){return new ct(oe.comparator)}function mk(){return new ct(oe.comparator)}var c3={asc:"ASCENDING",desc:"DESCENDING"},u3={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},l3={and:"AND",or:"OR"},ET=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function wT(n,e){return n.useProto3Json||Lg(e)?e:{value:e}}function d3(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function h3(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function nu(n){return Je(!!n,49232),fe.fromTimestamp((function(t){let r=pi(t);return new Qt(r.seconds,r.nanos)})(n))}function f3(n,e){return TT(n,e).canonicalString()}function TT(n,e){let t=(function(i){return new gt(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function C1(n){let e=gt.fromString(n);return Je(k1(e),10190,{key:e.toString()}),e}function Ww(n,e){let t=C1(e);if(t.get(1)!==n.databaseId.projectId)throw new ne(K.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ne(K.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new oe(R1(t))}function D1(n,e){return f3(n.databaseId,e)}function p3(n){let e=C1(n);return e.length===4?gt.emptyPath():R1(e)}function gk(n){return new gt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function R1(n){return Je(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function m3(n,e){let t;if("targetChange"in e){e.targetChange;let r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:ce(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(d,h){return d.useProto3Json?(Je(h===void 0||typeof h=="string",58123),Ut.fromBase64String(h||"")):(Je(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Ut.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(d){let h=d.code===void 0?K.UNKNOWN:A1(d.code);return new ne(h,d.message||"")})(o);t=new Eg(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Ww(n,r.document.name),s=nu(r.document.updateTime),o=r.document.createTime?nu(r.document.createTime):fe.min(),a=new rr({mapValue:{fields:r.document.fields}}),c=ir.newFoundDocument(i,s,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];t=new tu(d,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Ww(n,r.document),s=r.readTime?nu(r.readTime):fe.min(),o=ir.newNoDocument(i,s),a=r.removedTargetIds||[];t=new tu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Ww(n,r.document),s=r.removedTargetIds||[];t=new tu([],s,i,null)}else{if(!("filter"in e))return ce(11601,{Vt:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new _T(i,s),a=r.targetId;t=new Ig(a,o)}}return t}function g3(n,e){return{documents:[D1(n,e.path)]}}function N1(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=D1(n,i);let s=(function(d){if(d.length!==0)return x1(sr.create(d,"and"))})(e.filters);s&&(t.structuredQuery.where=s);let o=(function(d){if(d.length!==0)return d.map(h=>(function(y){return{field:gs(y.field),direction:I3(y.dir)}})(h))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=wT(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:i}}function y3(n,e,t,r){let{ft:i,parent:s}=N1(n,e),o={},a=[],c=0;return t.forEach(d=>{let h=r?d.alias:"aggregate_"+c++;o[h]=d.alias,d.aggregateType==="count"?a.push({alias:h,count:{}}):d.aggregateType==="avg"?a.push({alias:h,avg:{field:gs(d.fieldPath)}}):d.aggregateType==="sum"&&a.push({alias:h,sum:{field:gs(d.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:i.structuredQuery},parent:i.parent},gt:o,parent:s}}function _3(n){let e=p3(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){Je(r===1,65062);let h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=(function(f){let y=P1(f);return y instanceof sr&&d1(y)?y.getFilters():[y]})(t.where));let o=[];t.orderBy&&(o=(function(f){return f.map(y=>(function(R){return new ra(Jc(R.field),(function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(R.direction))})(y))})(t.orderBy));let a=null;t.limit&&(a=(function(f){let y;return y=typeof f=="object"?f.value:f,Lg(y)?null:y})(t.limit));let c=null;t.startAt&&(c=(function(f){let y=!!f.before,w=f.values||[];return new na(w,y)})(t.startAt));let d=null;return t.endAt&&(d=(function(f){let y=!f.before,w=f.values||[];return new na(w,y)})(t.endAt)),$z(e,i,o,s,a,"F",c,d)}function v3(n,e){let t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ce(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function P1(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Jc(t.unaryFilter.field);return yt.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Jc(t.unaryFilter.field);return yt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Jc(t.unaryFilter.field);return yt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Jc(t.unaryFilter.field);return yt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ce(61313);default:return ce(60726)}})(n):n.fieldFilter!==void 0?(function(t){return yt.create(Jc(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ce(58110);default:return ce(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return sr.create(t.compositeFilter.filters.map(r=>P1(r)),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ce(1026)}})(t.compositeFilter.op))})(n):ce(30097,{filter:n})}function I3(n){return c3[n]}function E3(n){return u3[n]}function w3(n){return l3[n]}function gs(n){return{fieldPath:n.canonicalString()}}function Jc(n){return Un.fromServerFormat(n.fieldPath)}function x1(n){return n instanceof yt?(function(t){if(t.op==="=="){if(ik(t.value))return{unaryFilter:{field:gs(t.field),op:"IS_NAN"}};if(rk(t.value))return{unaryFilter:{field:gs(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(ik(t.value))return{unaryFilter:{field:gs(t.field),op:"IS_NOT_NAN"}};if(rk(t.value))return{unaryFilter:{field:gs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:gs(t.field),op:E3(t.op),value:t.value}}})(n):n instanceof sr?(function(t){let r=t.getFilters().map(i=>x1(i));return r.length===1?r[0]:{compositeFilter:{op:w3(t.op),filters:r}}})(n):ce(54877,{filter:n})}function k1(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var th=class n{constructor(e,t,r,i,s=fe.min(),o=fe.min(),a=Ut.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var bT=class{constructor(e){this.yt=e}};function M1(n){let e=_3({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?gg(e,e.limit,"L"):e}var Tg=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Ye(e.integerValue));else if("doubleValue"in e){let r=Ye(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),hg(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=pi(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(mi(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?u1(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):c1(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):ce(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){let r=e.fields||{};this.Ft(t,55);for(let i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){let r=e.fields||{};this.Ft(t,53);let i=Kd,s=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Ye(s)),this.Ot(i,t),this.Ct(r[i],t)}qt(e,t){let r=e.values||[];this.Ft(t,50);for(let i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),oe.fromName(e).path.forEach(r=>{this.Ft(t,60),this.$t(r,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};Tg.Wt=new Tg;var ST=class{constructor(){this.Sn=new AT}addToCollectionParentIndex(e,t){return this.Sn.add(t),B.resolve()}getCollectionParents(e,t){return B.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return B.resolve()}deleteFieldIndex(e,t){return B.resolve()}deleteAllFieldIndexes(e){return B.resolve()}createTargetIndexes(e,t){return B.resolve()}getDocumentsMatchingTarget(e,t){return B.resolve(null)}getIndexType(e,t){return B.resolve(0)}getFieldIndexes(e,t){return B.resolve([])}getNextCollectionGroupToUpdate(e){return B.resolve(null)}getMinOffset(e,t){return B.resolve(ta.min())}getMinOffsetFromCollectionGroup(e,t){return B.resolve(ta.min())}updateCollectionGroup(e,t,r){return B.resolve()}updateIndexEntries(e,t){return B.resolve()}},AT=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new kt(gt.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new kt(gt.comparator)).toArray()}};var rle=new Uint8Array(0);var yk={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},O1=41943040,Fn=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};Fn.DEFAULT_COLLECTION_PERCENTILE=10,Fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Fn.DEFAULT=new Fn(O1,Fn.DEFAULT_COLLECTION_PERCENTILE,Fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Fn.DISABLED=new Fn(-1,0,0);var nh=class n{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new n(0)}static ar(){return new n(-1)}};var _k="LruGarbageCollector",T3=1048576;function vk([n,e],[t,r]){let i=Se(n,t);return i===0?Se(e,r):i}var CT=class{constructor(e){this.Pr=e,this.buffer=new kt(vk),this.Tr=0}Ir(){return++this.Tr}Er(e){let t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();vk(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},DT=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){J(_k,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Iu(t)?J(_k,"Ignoring IndexedDB error during garbage collection: ",t):await Vg(t)}await this.Ar(3e5)})}},RT=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return B.resolve(vb.ce);let r=new CT(t);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.mr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(J("LruGarbageCollector","Garbage collection skipped; disabled"),B.resolve(yk)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(J("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),yk):this.gr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let r,i,s,o,a,c,d,h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(J("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(s=f,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(d=Date.now(),Qc()<=Ae.DEBUG&&J("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${f} documents in `+(d-c)+`ms
Total Duration: ${d-h}ms`),B.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}};function b3(n,e){return new RT(n,e)}var NT=class{constructor(){this.changes=new gi(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ir.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?B.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var PT=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var xT=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Hd(r.mutation,i,Qo.empty(),Qt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,De()).next(()=>r))}getLocalViewOfDocuments(e,t,r=De()){let i=Yo();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Bd();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=Yo();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,De()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=Is(),o=qd(),a=(function(){return qd()})();return t.forEach((c,d)=>{let h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof du)?s=s.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Hd(h.mutation,d,h.mutation.getFieldMask(),Qt.now())):o.set(d.key,Qo.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((d,h)=>o.set(d,h)),t.forEach((d,h)=>a.set(d,new PT(h,o.get(d)??null))),a))}recalculateAndSaveOverlays(e,t){let r=qd(),i=new ct((o,a)=>o-a),s=De();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let d=t.get(c);if(d===null)return;let h=r.get(c)||Qo.empty();h=a.applyToLocalView(d,h),r.set(c,h);let f=(i.get(a.batchId)||De()).add(c);i=i.insert(a.batchId,f)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),d=c.key,h=c.value,f=I1();h.forEach(y=>{if(!s.has(y)){let w=b1(t.get(y),r.get(y));w!==null&&f.set(y,w),s=s.add(y)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return B.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return qz(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):m1(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):B.resolve(Yo()),a=zd,c=s;return o.next(d=>B.forEach(d,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(h)?B.resolve():this.remoteDocumentCache.getEntry(e,h).next(y=>{c=c.insert(h,y)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,c,d,De())).next(h=>({batchId:a,changes:Kz(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new oe(t)).next(r=>{let i=Bd();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=Bd();return this.indexManager.getCollectionParents(e,s).next(a=>B.forEach(a,c=>{let d=(function(f,y){return new au(y,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)})(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(h=>{h.forEach((f,y)=>{o=o.insert(f,y)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,d)=>{let h=d.getKey();o.get(h)===null&&(o=o.insert(h,ir.newInvalidDocument(h)))});let a=Bd();return o.forEach((c,d)=>{let h=s.get(c);h!==void 0&&Hd(h.mutation,d,Qo.empty(),Qt.now()),$g(t,d)&&(a=a.insert(c,d))}),a})}};var kT=class{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return B.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:nu(i.createTime)}})(t)),B.resolve()}getNamedQuery(e,t){return B.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(i){return{name:i.name,query:M1(i.bundledQuery),readTime:nu(i.readTime)}})(t)),B.resolve()}};var MT=class{constructor(){this.overlays=new ct(oe.comparator),this.Lr=new Map}getOverlay(e,t){return B.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Yo();return B.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.bt(e,t,s)}),B.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Lr.delete(r)),B.resolve()}getOverlaysForCollection(e,t,r){let i=Yo(),s=t.length+1,o=new oe(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,d=c.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return B.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new ct((d,h)=>d-h),o=this.overlays.getIterator();for(;o.hasNext();){let d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let h=s.get(d.largestBatchId);h===null&&(h=Yo(),s=s.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}let a=Yo(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=i)););return B.resolve(a)}bt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.Lr.get(i.largestBatchId).delete(r.key);this.Lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new yT(t,r));let s=this.Lr.get(t);s===void 0&&(s=De(),this.Lr.set(t,s)),this.Lr.set(t,s.add(r.key))}};var OT=class{constructor(){this.sessionToken=Ut.EMPTY_BYTE_STRING}getSessionToken(e){return B.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,B.resolve()}};var rh=class{constructor(){this.kr=new kt(mt.Kr),this.qr=new kt(mt.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){let r=new mt(e,t);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Wr(new mt(e,t))}Qr(e,t){e.forEach(r=>this.removeReference(r,t))}Gr(e){let t=new oe(new gt([])),r=new mt(t,e),i=new mt(t,e+1),s=[];return this.qr.forEachInRange([r,i],o=>{this.Wr(o),s.push(o.key)}),s}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){let t=new oe(new gt([])),r=new mt(t,e),i=new mt(t,e+1),s=De();return this.qr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new mt(e,0),r=this.kr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},mt=class{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return oe.comparator(e.key,t.key)||Se(e.Hr,t.Hr)}static Ur(e,t){return Se(e.Hr,t.Hr)||oe.comparator(e.key,t.key)}};var VT=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new kt(mt.Kr)}checkEmpty(e){return B.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new gT(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.Jr=this.Jr.add(new mt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return B.resolve(o)}lookupMutationBatch(e,t){return B.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Xr(r),s=i<0?0:i;return B.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return B.resolve(this.mutationQueue.length===0?Sz:this.Yn-1)}getAllMutationBatches(e){return B.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new mt(t,0),i=new mt(t,Number.POSITIVE_INFINITY),s=[];return this.Jr.forEachInRange([r,i],o=>{let a=this.Zr(o.Hr);s.push(a)}),B.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new kt(Se);return t.forEach(i=>{let s=new mt(i,0),o=new mt(i,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([s,o],a=>{r=r.add(a.Hr)})}),B.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;oe.isDocumentKey(s)||(s=s.child(""));let o=new mt(new oe(s),0),a=new kt(Se);return this.Jr.forEachWhile(c=>{let d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(a=a.add(c.Hr)),!0)},o),B.resolve(this.Yr(a))}Yr(e){let t=[];return e.forEach(r=>{let i=this.Zr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Je(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return B.forEach(t.mutations,i=>{let s=new mt(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Jr=r})}nr(e){}containsKey(e,t){let r=new mt(t,0),i=this.Jr.firstAfterOrEqual(r);return B.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,B.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var LT=class{constructor(e){this.ti=e,this.docs=(function(){return new ct(oe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ti(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return B.resolve(r?r.document.mutableCopy():ir.newInvalidDocument(t))}getEntries(e,t){let r=Is();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ir.newInvalidDocument(i))}),B.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Is(),o=t.path,a=new oe(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:d,value:{document:h}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||wz(Ez(h),r)<=0||(i.has(h.key)||$g(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return B.resolve(s)}getAllFromCollectionGroup(e,t,r,i){ce(9500)}ni(e,t){return B.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new FT(this)}getSize(e){return B.resolve(this.size)}},FT=class extends NT{constructor(e){super(),this.Mr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Mr.addEntry(e,i)):this.Mr.removeEntry(r)}),B.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}};var UT=class{constructor(e){this.persistence=e,this.ri=new gi(t=>Eb(t),wb),this.lastRemoteSnapshotVersion=fe.min(),this.highestTargetId=0,this.ii=0,this.si=new rh,this.targetCount=0,this.oi=nh._r()}forEachTarget(e,t){return this.ri.forEach((r,i)=>t(i)),B.resolve()}getLastRemoteSnapshotVersion(e){return B.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return B.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),B.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ii&&(this.ii=t),B.resolve()}lr(e){this.ri.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.oi=new nh(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,B.resolve()}updateTargetData(e,t){return this.lr(t),B.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,B.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.ri.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.ri.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),B.waitFor(s).next(()=>i)}getTargetCount(e){return B.resolve(this.targetCount)}getTargetData(e,t){let r=this.ri.get(t)||null;return B.resolve(r)}addMatchingKeys(e,t,r){return this.si.$r(t,r),B.resolve()}removeMatchingKeys(e,t,r){this.si.Qr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),B.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),B.resolve()}getMatchingKeysForTargetId(e,t){let r=this.si.jr(t);return B.resolve(r)}containsKey(e,t){return B.resolve(this.si.containsKey(t))}};var bg=class{constructor(e,t){this._i={},this.overlays={},this.ai=new vb(0),this.ui=!1,this.ui=!0,this.ci=new OT,this.referenceDelegate=e(this),this.li=new UT(this),this.indexManager=new ST,this.remoteDocumentCache=(function(i){return new LT(i)})(r=>this.referenceDelegate.hi(r)),this.serializer=new bT(t),this.Pi=new kT(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new MT,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this._i[e.toKey()];return r||(r=new VT(t,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,r){J("MemoryPersistence","Starting transaction:",e);let i=new jT(this.ai.next());return this.referenceDelegate.Ti(),r(i).next(s=>this.referenceDelegate.Ii(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(e,t){return B.or(Object.values(this._i).map(r=>()=>r.containsKey(e,t)))}},jT=class extends tT{constructor(e){super(),this.currentSequenceNumber=e}},BT=class n{constructor(e){this.persistence=e,this.Ri=new rh,this.Ai=null}static Vi(e){return new n(e)}get di(){if(this.Ai)return this.Ai;throw ce(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.di.delete(r.toString()),B.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.di.add(r.toString()),B.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),B.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach(i=>this.di.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.di.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ti(){this.Ai=new Set}Ii(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return B.forEach(this.di,r=>{let i=oe.fromPath(r);return this.mi(e,i).next(s=>{s||t.removeEntry(i,fe.min())})}).next(()=>(this.Ai=null,t.apply(e)))}updateLimboDocument(e,t){return this.mi(e,t).next(r=>{r?this.di.delete(t.toString()):this.di.add(t.toString())})}hi(e){return 0}mi(e,t){return B.or([()=>B.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},Sg=class n{constructor(e,t){this.persistence=e,this.fi=new gi(r=>Az(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=b3(this,t)}static Vi(e,t){return new n(e,t)}Ti(){}Ii(e){return B.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){let t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}pr(e){let t=0;return this.mr(e,r=>{t++}).next(()=>t)}mr(e,t){return B.forEach(this.fi,(r,i)=>this.wr(e,r,i).next(s=>s?B.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ni(e,o=>this.wr(e,o,t).next(a=>{a||(r++,s.removeEntry(o,fe.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),B.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),B.resolve()}removeReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),B.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),B.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ig(e.data.value)),t}wr(e,t,r){return B.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.fi.get(t);return B.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var $T=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Ts=r,this.Is=i}static Es(e,t){let r=De(),i=De();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var qT=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var HT=class{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return _x()?8:bz(yx())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.gs(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ps(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new qT;return this.ys(e,t,o).next(a=>{if(s.result=a,this.As)return this.ws(e,t,o,a.size)})}).next(()=>s.result)}ws(e,t,r,i){return r.documentReadCount<this.Vs?(Qc()<=Ae.DEBUG&&J("QueryEngine","SDK will not create cache indexes for query:",Yc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),B.resolve()):(Qc()<=Ae.DEBUG&&J("QueryEngine","Query:",Yc(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ds*i?(Qc()<=Ae.DEBUG&&J("QueryEngine","The SDK decides to create cache indexes for query:",Yc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Rr(t))):B.resolve())}gs(e,t){if(ck(t))return B.resolve(null);let r=Rr(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=gg(t,null,"F"),r=Rr(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=De(...s);return this.fs.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let d=this.bs(t,a);return this.Ss(t,d,o,c.readTime)?this.gs(e,gg(t,null,"F")):this.Ds(e,d,t,c)}))})))}ps(e,t,r,i){return ck(t)||i.isEqual(fe.min())?B.resolve(null):this.fs.getDocuments(e,r).next(s=>{let o=this.bs(t,s);return this.Ss(t,o,r,i)?B.resolve(null):(Qc()<=Ae.DEBUG&&J("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Yc(t)),this.Ds(e,o,t,Iz(i,zd)).next(a=>a))})}bs(e,t){let r=new kt(_1(e));return t.forEach((i,s)=>{$g(e,s)&&(r=r.add(s))}),r}Ss(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ys(e,t,r){return Qc()<=Ae.DEBUG&&J("QueryEngine","Using full collection scan to execute query:",Yc(t)),this.fs.getDocumentsMatchingQuery(e,t,ta.min(),r)}Ds(e,t,r,i){return this.fs.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Tb="LocalStore",S3=3e8,zT=class{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.vs=new ct(Se),this.Fs=new gi(s=>Eb(s),wb),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new xT(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.vs))}};function A3(n,e,t,r){return new zT(n,e,t,r)}async function V1(n,e){let t=Ee(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Os(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=De();for(let d of i){o.push(d.batchId);for(let h of d.mutations)c=c.add(h.key)}for(let d of s){a.push(d.batchId);for(let h of d.mutations)c=c.add(h.key)}return t.localDocuments.getDocuments(r,c).next(d=>({Ns:d,removedBatchIds:o,addedBatchIds:a}))})})}function L1(n){let e=Ee(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.li.getLastRemoteSnapshotVersion(t))}function C3(n,e){let t=Ee(n),r=e.snapshotVersion,i=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.xs.newChangeBuffer({trackRemovals:!0});i=t.vs;let a=[];e.targetChanges.forEach((h,f)=>{let y=i.get(f);if(!y)return;a.push(t.li.removeMatchingKeys(s,h.removedDocuments,f).next(()=>t.li.addMatchingKeys(s,h.addedDocuments,f)));let w=y.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?w=w.withResumeToken(Ut.EMPTY_BYTE_STRING,fe.min()).withLastLimboFreeSnapshotVersion(fe.min()):h.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(h.resumeToken,r)),i=i.insert(f,w),(function(N,P,F){return N.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-N.snapshotVersion.toMicroseconds()>=S3?!0:F.addedDocuments.size+F.modifiedDocuments.size+F.removedDocuments.size>0})(y,w,h)&&a.push(t.li.updateTargetData(s,w))});let c=Is(),d=De();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(D3(s,o,e.documentUpdates).next(h=>{c=h.Bs,d=h.Ls})),!r.isEqual(fe.min())){let h=t.li.getLastRemoteSnapshotVersion(s).next(f=>t.li.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(h)}return B.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,d)).next(()=>c)}).then(s=>(t.vs=i,s))}function D3(n,e,t){let r=De(),i=De();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Is();return t.forEach((a,c)=>{let d=s.get(a);c.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(fe.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):J(Tb,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",c.version)}),{Bs:o,Ls:i}})}function R3(n,e){let t=Ee(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.li.getTargetData(r,e).next(s=>s?(i=s,B.resolve(i)):t.li.allocateTargetId(r).next(o=>(i=new th(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.li.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.vs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.vs=t.vs.insert(r.targetId,r),t.Fs.set(e,r.targetId)),r})}async function GT(n,e,t){let r=Ee(n),i=r.vs.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Iu(o))throw o;J(Tb,`Failed to update sequence numbers for target ${e}: ${o}`)}r.vs=r.vs.remove(e),r.Fs.delete(i.target)}function Ik(n,e,t){let r=Ee(n),i=fe.min(),s=De();return r.persistence.runTransaction("Execute query","readwrite",o=>(function(c,d,h){let f=Ee(c),y=f.Fs.get(h);return y!==void 0?B.resolve(f.vs.get(y)):f.li.getTargetData(d,h)})(r,o,Rr(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,t?i:fe.min(),t?s:De())).next(a=>(N3(r,zz(e),a),{documents:a,ks:s})))}function N3(n,e,t){let r=n.Ms.get(e)||fe.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.Ms.set(e,r)}var Ag=class{constructor(){this.activeTargetIds=Jz()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var WT=class{constructor(){this.vo=new Ag,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,r){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Ag,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var KT=class{Mo(e){}shutdown(){}};var Ek="ConnectivityMonitor",Cg=class{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){J(Ek,"Network connectivity changed: AVAILABLE");for(let e of this.Lo)e(0)}Bo(){J(Ek,"Network connectivity changed: UNAVAILABLE");for(let e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var rg=null;function QT(){return rg===null?rg=(function(){return 268435456+Math.round(2147483648*Math.random())})():rg++,"0x"+rg.toString(16)}var Kw="RestConnection",P3={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"},YT=class{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.$o=this.databaseId.database===rT?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,s){let o=QT(),a=this.Qo(e,t.toUriEncodedString());J(Kw,`Sending RPC '${e}' ${o}:`,a,r);let c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(c,i,s);let{host:d}=new URL(a),h=gx(d);return this.zo(e,a,c,r,h).then(f=>(J(Kw,`Received RPC '${e}' ${o}: `,f),f),f=>{throw _s(Kw,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}jo(e,t,r,i,s,o){return this.Wo(e,t,r,i,s)}Go(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+yu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}Qo(e,t){let r=P3[e],i=`${this.qo}/v1/${t}:${r}`;return this.databaseInfo.apiKey&&(i=`${i}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),i}terminate(){}};var JT=class{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}};var Wt="WebChannelConnection",jd=(n,e,t)=>{n.listen(e,r=>{try{t(r)}catch(i){setTimeout(()=>{throw i},0)}})},Dg=class n extends YT{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!n.c_){let e=qw();jd(e,$w.STAT_EVENT,t=>{t.stat===eg.PROXY?J(Wt,"STAT_EVENT: detected buffering proxy"):t.stat===eg.NOPROXY&&J(Wt,"STAT_EVENT: detected no buffering proxy")}),n.c_=!0}}zo(e,t,r,i,s){let o=QT();return new Promise((a,c)=>{let d=new jw;d.setWithCredentials(!0),d.listenOnce(Bw.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Ud.NO_ERROR:let f=d.getResponseJson();J(Wt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case Ud.TIMEOUT:J(Wt,`RPC '${e}' ${o} timed out`),c(new ne(K.DEADLINE_EXCEEDED,"Request time out"));break;case Ud.HTTP_ERROR:let y=d.getStatus();if(J(Wt,`RPC '${e}' ${o} failed with status:`,y,"response text:",d.getResponseText()),y>0){let w=d.getResponseJson();Array.isArray(w)&&(w=w[0]);let R=w?.error;if(R&&R.status&&R.message){let N=(function(F){let q=F.toLowerCase().replace(/_/g,"-");return Object.values(K).indexOf(q)>=0?q:K.UNKNOWN})(R.status);c(new ne(N,R.message))}else c(new ne(K.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new ne(K.UNAVAILABLE,"Connection failed."));break;default:ce(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{J(Wt,`RPC '${e}' ${o} completed.`)}});let h=JSON.stringify(i);J(Wt,`RPC '${e}' ${o} sending request:`,i),d.send(t,"POST",h,r,15)})}T_(e,t,r){let i=QT(),s=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,t,r),a.encodeInitMessageHeaders=!0;let d=s.join("");J(Wt,`Creating RPC '${e}' stream ${i}: ${d}`,a);let h=o.createWebChannel(d,a);this.I_(h);let f=!1,y=!1,w=new JT({Ho:R=>{y?J(Wt,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(f||(J(Wt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),f=!0),J(Wt,`RPC '${e}' stream ${i} sending:`,R),h.send(R))},Jo:()=>h.close()});return jd(h,Kc.EventType.OPEN,()=>{y||(J(Wt,`RPC '${e}' stream ${i} transport opened.`),w.i_())}),jd(h,Kc.EventType.CLOSE,()=>{y||(y=!0,J(Wt,`RPC '${e}' stream ${i} transport closed`),w.o_(),this.E_(h))}),jd(h,Kc.EventType.ERROR,R=>{y||(y=!0,_s(Wt,`RPC '${e}' stream ${i} transport errored. Name:`,R.name,"Message:",R.message),w.o_(new ne(K.UNAVAILABLE,"The operation could not be completed")))}),jd(h,Kc.EventType.MESSAGE,R=>{if(!y){let N=R.data[0];Je(!!N,16349);let P=N,F=P?.error||P[0]?.error;if(F){J(Wt,`RPC '${e}' stream ${i} received error:`,F);let q=F.status,$=(function(Z){let T=pt[Z];if(T!==void 0)return A1(T)})(q),ee=F.message;q==="NOT_FOUND"&&ee.includes("database")&&ee.includes("does not exist")&&ee.includes(this.databaseId.database)&&_s(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),$===void 0&&($=K.INTERNAL,ee="Unknown error status: "+q+" with message "+F.message),y=!0,w.o_(new ne($,ee)),h.close()}else J(Wt,`RPC '${e}' stream ${i} received:`,N),w.__(N)}}),n.u_(),setTimeout(()=>{w.s_()},0),w}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(t=>t===e)}Go(e,t,r){super.Go(e,t,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Hw()}};function x3(n){return new Dg(n)}function Qw(){return typeof document<"u"?document:null}function bb(n){return new ET(n,!0)}Dg.c_=!1;var Rg=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Ci=e,this.timerId=t,this.R_=r,this.A_=i,this.V_=s,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();let t=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&J("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}};var wk="PersistentStream",XT=class{constructor(e,t,r,i,s,o,a,c){this.Ci=e,this.b_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Rg(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===K.RESOURCE_EXHAUSTED?(fi(t.toString()),fi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===K.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;let e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===t&&this.G_(r,i)},r=>{e(()=>{let i=new ne(K.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,t){let r=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.Yo(()=>{r(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.H_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return J(wk,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget(()=>this.D_===e?t():(J(wk,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},ZT=class extends XT{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=m3(this.serializer,e),r=(function(s){if(!("targetChange"in s))return fe.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?fe.min():o.readTime?nu(o.readTime):fe.min()})(e);return this.listener.J_(t,r)}Z_(e){let t={};t.database=gk(this.serializer),t.addTarget=(function(s,o){let a,c=o.target;if(a=mT(c)?{documents:g3(s,c)}:{query:N1(s,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=h3(s,o.resumeToken);let d=wT(s,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(fe.min())>0){a.readTime=d3(s,o.snapshotVersion.toTimestamp());let d=wT(s,o.expectedCount);d!==null&&(a.expectedCount=d)}return a})(this.serializer,e);let r=v3(this.serializer,e);r&&(t.labels=r),this.K_(t)}X_(e){let t={};t.database=gk(this.serializer),t.removeTarget=e,this.K_(t)}};var eb=class{},tb=class extends eb{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new ne(K.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(e,TT(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ne(K.UNKNOWN,s.toString())})}jo(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.jo(e,TT(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ne(K.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}};function k3(n,e,t,r){return new tb(n,e,t,r)}var nb=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(fi(t),this.aa=!1):J("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}};var hu="RemoteStore",rb=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=s,this.Aa.Mo(o=>{r.enqueueAndForget(async()=>{ch(this)&&(J(hu,"Restarting streams for network reachability change."),await(async function(c){let d=Ee(c);d.Ea.add(4),await ah(d),d.Va.set("Unknown"),d.Ea.delete(4),await qg(d)})(this))})}),this.Va=new nb(r,i)}};async function qg(n){if(ch(n))for(let e of n.Ra)await e(!0)}async function ah(n){for(let e of n.Ra)await e(!1)}function F1(n,e){let t=Ee(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Db(t)?Cb(t):Eu(t).O_()&&Ab(t,e))}function Sb(n,e){let t=Ee(n),r=Eu(t);t.Ia.delete(e),r.O_()&&U1(t,e),t.Ia.size===0&&(r.O_()?r.L_():ch(t)&&t.Va.set("Unknown"))}function Ab(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(fe.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Eu(n).Z_(e)}function U1(n,e){n.da.$e(e),Eu(n).X_(e)}function Cb(n){n.da=new IT({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Eu(n).start(),n.Va.ua()}function Db(n){return ch(n)&&!Eu(n).x_()&&n.Ia.size>0}function ch(n){return Ee(n).Ea.size===0}function j1(n){n.da=void 0}async function M3(n){n.Va.set("Online")}async function O3(n){n.Ia.forEach((e,t)=>{Ab(n,e)})}async function V3(n,e){j1(n),Db(n)?(n.Va.ha(e),Cb(n)):n.Va.set("Unknown")}async function L3(n,e,t){if(n.Va.set("Online"),e instanceof Eg&&e.state===2&&e.cause)try{await(async function(i,s){let o=s.cause;for(let a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.da.removeTarget(a))})(n,e)}catch(r){J(hu,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Tk(n,r)}else if(e instanceof tu?n.da.Xe(e):e instanceof Ig?n.da.st(e):n.da.tt(e),!t.isEqual(fe.min()))try{let r=await L1(n.localStore);t.compareTo(r)>=0&&await(function(s,o){let a=s.da.Tt(o);return a.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){let h=s.Ia.get(d);h&&s.Ia.set(d,h.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,d)=>{let h=s.Ia.get(c);if(!h)return;s.Ia.set(c,h.withResumeToken(Ut.EMPTY_BYTE_STRING,h.snapshotVersion)),U1(s,c);let f=new th(h.target,c,d,h.sequenceNumber);Ab(s,f)}),s.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(r){J(hu,"Failed to raise snapshot:",r),await Tk(n,r)}}async function Tk(n,e,t){if(!Iu(e))throw e;n.Ea.add(1),await ah(n),n.Va.set("Offline"),t||(t=()=>L1(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{J(hu,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await qg(n)})}async function bk(n,e){let t=Ee(n);t.asyncQueue.verifyOperationInProgress(),J(hu,"RemoteStore received new credentials");let r=ch(t);t.Ea.add(3),await ah(t),r&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await qg(t)}async function F3(n,e){let t=Ee(n);e?(t.Ea.delete(2),await qg(t)):e||(t.Ea.add(2),await ah(t),t.Va.set("Unknown"))}function Eu(n){return n.ma||(n.ma=(function(t,r,i){let s=Ee(t);return s.sa(),new ZT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:M3.bind(null,n),Yo:O3.bind(null,n),t_:V3.bind(null,n),J_:L3.bind(null,n)}),n.Ra.push(async e=>{e?(n.ma.B_(),Db(n)?Cb(n):n.Va.set("Unknown")):(await n.ma.stop(),j1(n))})),n.ma}var ib=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new hi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ne(K.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function B1(n,e){if(fi("AsyncQueue",`${e}: ${n}`),Iu(n))return new ne(K.UNAVAILABLE,`${e}: ${n}`);throw n}var ih=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||oe.comparator(t.key,r.key):(t,r)=>oe.comparator(t.key,r.key),this.keyedMap=Bd(),this.sortedSet=new ct(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Ng=class{constructor(){this.ga=new ct(oe.comparator)}track(e){let t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):ce(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}},ia=class n{constructor(e,t,r,i,s,o,a,c,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,ih.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Bg(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var sb=class{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}},ob=class{constructor(){this.queries=Sk(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){let i=Ee(t),s=i.queries;i.queries=Sk(),s.forEach((o,a)=>{for(let c of a.ba)c.onError(r)})})(this,new ne(K.ABORTED,"Firestore shutting down"))}};function Sk(){return new gi(n=>y1(n),Bg)}async function U3(n,e){let t=Ee(n),r=3,i=e.query,s=t.queries.get(i);s?!s.Sa()&&e.Da()&&(r=2):(s=new sb,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){let a=B1(o,`Initialization of query '${Yc(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.ba.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&Rb(t)}async function j3(n,e){let t=Ee(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.ba.indexOf(e);o>=0&&(s.ba.splice(o,1),s.ba.length===0?i=e.Da()?0:1:!s.Sa()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function B3(n,e){let t=Ee(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.ba)a.Fa(i)&&(r=!0);o.wa=i}}r&&Rb(t)}function $3(n,e,t){let r=Ee(n),i=r.queries.get(e);if(i)for(let s of i.ba)s.onError(t);r.queries.delete(e)}function Rb(n){n.Ca.forEach(e=>{e.next()})}var ab,Ak;(Ak=ab||(ab={})).Ma="default",Ak.Cache="cache";var cb=class{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new ia(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;let r=t!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=ia.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==ab.Cache}};var Pg=class{constructor(e){this.key=e}},xg=class{constructor(e){this.key=e}},ub=class{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=De(),this.mutatedKeys=De(),this.eu=_1(e),this.tu=new ih(this.eu)}get nu(){return this.Za}ru(e,t){let r=t?t.iu:new Ng,i=t?t.tu:this.tu,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,f)=>{let y=i.get(h),w=$g(this.query,f)?f:null,R=!!y&&this.mutatedKeys.has(y.key),N=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations),P=!1;y&&w?y.data.isEqual(w.data)?R!==N&&(r.track({type:3,doc:w}),P=!0):this.su(y,w)||(r.track({type:2,doc:w}),P=!0,(c&&this.eu(w,c)>0||d&&this.eu(w,d)<0)&&(a=!0)):!y&&w?(r.track({type:0,doc:w}),P=!0):y&&!w&&(r.track({type:1,doc:y}),P=!0,(c||d)&&(a=!0)),P&&(w?(o=o.add(w),s=N?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Ss:a,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let o=e.iu.ya();o.sort((h,f)=>(function(w,R){let N=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ce(20277,{Vt:P})}};return N(w)-N(R)})(h.type,f.type)||this.eu(h.doc,f.doc)),this.ou(r),i=i??!1;let a=t&&!i?this._u():[],c=this.Ya.size===0&&this.current&&!i?1:0,d=c!==this.Xa;return this.Xa=c,o.length!==0||d?{snapshot:new ia(this.query,e.tu,s,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Ng,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Za=this.Za.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Za=this.Za.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Ya;this.Ya=De(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))});let t=[];return e.forEach(r=>{this.Ya.has(r)||t.push(new xg(r))}),this.Ya.forEach(r=>{e.has(r)||t.push(new Pg(r))}),t}cu(e){this.Za=e.ks,this.Ya=De();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return ia.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}},Nb="SyncEngine",lb=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},db=class{constructor(e){this.key=e,this.hu=!1}},hb=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new gi(a=>y1(a),Bg),this.Iu=new Map,this.Eu=new Set,this.Ru=new ct(oe.comparator),this.Au=new Map,this.Vu=new rh,this.du={},this.mu=new Map,this.fu=nh.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}};async function q3(n,e,t=!0){let r=G1(n),i,s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await $1(r,e,t,!0),i}async function H3(n,e){let t=G1(n);await $1(t,e,!0,!1)}async function $1(n,e,t,r){let i=await R3(n.localStore,Rr(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),a;return r&&(a=await z3(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&F1(n.remoteStore,i),a}async function z3(n,e,t,r,i){n.pu=(f,y,w)=>(async function(N,P,F,q){let $=P.view.ru(F);$.Ss&&($=await Ik(N.localStore,P.query,!1).then(({documents:T})=>P.view.ru(T,$)));let ee=q&&q.targetChanges.get(P.targetId),ue=q&&q.targetMismatches.get(P.targetId)!=null,Z=P.view.applyChanges($,N.isPrimaryClient,ee,ue);return Dk(N,P.targetId,Z.au),Z.snapshot})(n,f,y,w);let s=await Ik(n.localStore,e,!0),o=new ub(e,s.ks),a=o.ru(s.documents),c=eh.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=o.applyChanges(a,n.isPrimaryClient,c);Dk(n,t,d.au);let h=new lb(e,t,o);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),d.snapshot}async function G3(n,e,t){let r=Ee(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!Bg(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await GT(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Sb(r.remoteStore,i.targetId),fb(r,i.targetId)}).catch(Vg)):(fb(r,i.targetId),await GT(r.localStore,i.targetId,!0))}async function W3(n,e){let t=Ee(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Sb(t.remoteStore,r.targetId))}async function q1(n,e){let t=Ee(n);try{let r=await C3(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Au.get(s);o&&(Je(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?Je(o.hu,14607):i.removedDocuments.size>0&&(Je(o.hu,42227),o.hu=!1))}),await z1(t,r,e)}catch(r){await Vg(r)}}function Ck(n,e,t){let r=Ee(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Tu.forEach((s,o)=>{let a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),(function(o,a){let c=Ee(o);c.onlineState=a;let d=!1;c.queries.forEach((h,f)=>{for(let y of f.ba)y.va(a)&&(d=!0)}),d&&Rb(c)})(r.eventManager,e),i.length&&r.Pu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function K3(n,e,t){let r=Ee(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Au.get(e),s=i&&i.key;if(s){let o=new ct(oe.comparator);o=o.insert(s,ir.newNoDocument(s,fe.min()));let a=De().add(s),c=new vg(fe.min(),new Map,new ct(Se),o,a);await q1(r,c),r.Ru=r.Ru.remove(s),r.Au.delete(e),Pb(r)}else await GT(r.localStore,e,!1).then(()=>fb(r,e,t)).catch(Vg)}function fb(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach(r=>{n.Vu.containsKey(r)||H1(n,r)})}function H1(n,e){n.Eu.delete(e.path.canonicalString());let t=n.Ru.get(e);t!==null&&(Sb(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),Pb(n))}function Dk(n,e,t){for(let r of t)r instanceof Pg?(n.Vu.addReference(r.key,e),Q3(n,r)):r instanceof xg?(J(Nb,"Document no longer in limbo: "+r.key),n.Vu.removeReference(r.key,e),n.Vu.containsKey(r.key)||H1(n,r.key)):ce(19791,{wu:r})}function Q3(n,e){let t=e.key,r=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(r)||(J(Nb,"New document in limbo: "+t),n.Eu.add(r),Pb(n))}function Pb(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){let e=n.Eu.values().next().value;n.Eu.delete(e);let t=new oe(gt.fromString(e)),r=n.fu.next();n.Au.set(r,new db(t)),n.Ru=n.Ru.insert(t,r),F1(n.remoteStore,new th(Rr(jg(t.path)),r,"TargetPurposeLimboResolution",vb.ce))}}async function z1(n,e,t){let r=Ee(n),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,c)=>{o.push(r.pu(c,e,t).then(d=>{if((d||t)&&r.isPrimaryClient){let h=d?!d.fromCache:t?.targetChanges.get(c.targetId)?.current;r.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(d){i.push(d);let h=$T.Es(c.targetId,d);s.push(h)}}))}),await Promise.all(o),r.Pu.J_(i),await(async function(c,d){let h=Ee(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>B.forEach(d,y=>B.forEach(y.Ts,w=>h.persistence.referenceDelegate.addReference(f,y.targetId,w)).next(()=>B.forEach(y.Is,w=>h.persistence.referenceDelegate.removeReference(f,y.targetId,w)))))}catch(f){if(!Iu(f))throw f;J(Tb,"Failed to update sequence numbers: "+f)}for(let f of d){let y=f.targetId;if(!f.fromCache){let w=h.vs.get(y),R=w.snapshotVersion,N=w.withLastLimboFreeSnapshotVersion(R);h.vs=h.vs.insert(y,N)}}})(r.localStore,s))}async function Y3(n,e){let t=Ee(n);if(!t.currentUser.isEqual(e)){J(Nb,"User change. New user:",e.toKey());let r=await V1(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach(a=>{a.forEach(c=>{c.reject(new ne(K.CANCELLED,o))})}),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await z1(t,r.Ns)}}function J3(n,e){let t=Ee(n),r=t.Au.get(e);if(r&&r.hu)return De().add(r.key);{let i=De(),s=t.Iu.get(e);if(!s)return i;for(let o of s){let a=t.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function G1(n){let e=Ee(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=q1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=J3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=K3.bind(null,e),e.Pu.J_=B3.bind(null,e.eventManager),e.Pu.yu=$3.bind(null,e.eventManager),e}var xb=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=bb(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,r){return null}Mu(t,r){return null}vu(t){return A3(this.persistence,new HT,t.initialUser,this.serializer)}Cu(t){return new bg(BT.Vi,this.serializer)}Du(t){return new WT}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),kg=class extends xb{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Je(this.persistence.referenceDelegate instanceof Sg,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new DT(r,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes!==void 0?Fn.withCacheSize(this.cacheSizeBytes):Fn.DEFAULT;return new bg(r=>Sg.Vi(r,t),this.serializer)}};var W1=(()=>{class n{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Ck(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=Y3.bind(null,this.syncEngine),await F3(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new ob})()}createDatastore(t){let r=bb(t.databaseInfo.databaseId),i=x3(t.databaseInfo);return k3(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return(function(i,s,o,a,c){return new rb(i,s,o,a,c)})(this.localStore,this.datastore,t.asyncQueue,r=>Ck(this.syncEngine,r,0),(function(){return Cg.v()?new Cg:new KT})())}createSyncEngine(t,r){return(function(s,o,a,c,d,h,f){let y=new hb(s,o,a,c,d,h);return f&&(y.gu=!0),y})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){await(async function(r){let i=Ee(r);J(hu,"RemoteStore shutting down."),i.Ea.add(5),await ah(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}return n.provider={build:()=>new n},n})();var pb=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):fi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Es="FirestoreClient",mb=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this._databaseInfo=i,this.user=Kt.UNAUTHENTICATED,this.clientId=ru.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{J(Es,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(J(Es,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new hi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=B1(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function Yw(n,e){n.asyncQueue.verifyOperationInProgress(),J(Es,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await V1(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function Rk(n,e){n.asyncQueue.verifyOperationInProgress();let t=await X3(n);J(Es,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>bk(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>bk(e.remoteStore,i)),n._onlineComponents=e}async function X3(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){J(Es,"Using user provided OfflineComponentProvider");try{await Yw(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===K.FAILED_PRECONDITION||i.code===K.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;_s("Error using user provided cache. Falling back to memory cache: "+t),await Yw(n,new xb)}}else J(Es,"Using default OfflineComponentProvider"),await Yw(n,new kg(void 0));return n._offlineComponents}async function K1(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(J(Es,"Using user provided OnlineComponentProvider"),await Rk(n,n._uninitializedComponentsProvider._online)):(J(Es,"Using default OnlineComponentProvider"),await Rk(n,new W1))),n._onlineComponents}function Z3(n){return K1(n).then(e=>e.datastore)}async function Nk(n){let e=await K1(n),t=e.eventManager;return t.onListen=q3.bind(null,e.syncEngine),t.onUnlisten=G3.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=H3.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=W3.bind(null,e.syncEngine),t}function Q1(n,e,t,r){let i=new pb(r),s=new cb(e,i,t);return n.asyncQueue.enqueueAndForget(async()=>U3(await Nk(n),s)),()=>{i.Nu(),n.asyncQueue.enqueueAndForget(async()=>j3(await Nk(n),s))}}function Y1(n,e,t){let r=new hi;return n.asyncQueue.enqueueAndForget(async()=>{try{let i=await Z3(n);r.resolve((async function(o,a,c){let d=Ee(o),{request:h,gt:f,parent:y}=y3(d.serializer,Hz(a),c);d.connection.Ko||delete h.parent;let w=(await d.jo("RunAggregationQuery",d.serializer.databaseId,y,h,1)).filter(N=>!!N.result);Je(w.length===1,64727);let R=w[0].result?.aggregateFields;return Object.keys(R).reduce((N,P)=>(N[f[P]]=R[P],N),{})})(i,e,t))}catch(i){r.reject(i)}}),r.promise}function J1(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var e5="ComponentProvider",Pk=new Map;function t5(n,e,t,r,i){return new nT(n,e,t,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,J1(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator,r)}var n5="firestore.googleapis.com",xk=!0,Mg=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ne(K.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=n5,this.ssl=xk}else this.host=e.host,this.ssl=e.ssl??xk;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=O1;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<T3)throw new ne(K.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Lk("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=J1(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ne(K.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ne(K.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ne(K.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},gb=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Mg({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ne(K.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ne(K.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Mg(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new og;switch(r.type){case"firstParty":return new Zw(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ne(K.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let r=Pk.get(t);r&&(J(e5,"Removing Datastore"),Pk.delete(t),r.terminate())})(this),Promise.resolve()}};var fu=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Sn=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new pu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(vu(t,n._jsonSchema))return new n(e,r||null,new oe(gt.fromString(t.referencePath)))}};Sn._jsonSchemaVersion="firestore/documentReference/1.0",Sn._jsonSchema={type:at("string",Sn._jsonSchemaVersion),referencePath:at("string")};var pu=class n extends fu{constructor(e,t,r){super(e,t,jg(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Sn(this.firestore,null,new oe(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function sa(n,e){return n=zc(n),e=zc(e),(n instanceof Sn||n instanceof pu)&&(e instanceof Sn||e instanceof pu)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}var kk="AsyncQueue",Og=class{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Rg(this,"async_queue_retry"),this._c=()=>{let r=Qw();r&&J(kk,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;let t=Qw();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=Qw();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new hi;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Iu(e))throw e;J(kk,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,fi("INTERNAL UNHANDLED ERROR: ",Mk(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let i=ib.createAndSchedule(this,e,t,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&ce(47125,{Pc:Mk(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function Mk(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}var ws=class extends gb{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Og,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Og(e),this._firestoreClient=void 0,await e}}};function Hg(n){if(n._terminated)throw new ne(K.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||r5(n),n._firestoreClient}function r5(n){let e=n._freezeSettings(),t=t5(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new mb(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){let s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(n._componentsProvider))}var ys=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ut.fromBase64String(e))}catch(t){throw new ne(K.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ut.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(vu(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};ys._jsonSchemaVersion="firestore/bytes/1.0",ys._jsonSchema={type:at("string",ys._jsonSchemaVersion),bytes:at("string")};var mu=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ne(K.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Un(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Xo=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ne(K.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ne(K.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Se(this._lat,e._lat)||Se(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(vu(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};Xo._jsonSchemaVersion="firestore/geoPoint/1.0",Xo._jsonSchema={type:at("string",Xo._jsonSchemaVersion),latitude:at("number"),longitude:at("number")};var Zo=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(vu(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new ne(K.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Zo._jsonSchemaVersion="firestore/vectorValue/1.0",Zo._jsonSchema={type:at("string",Zo._jsonSchemaVersion),vectorValues:at("object")};function kb(n,e,t){if((e=zc(e))instanceof mu)return e._internalPath;if(typeof e=="string")return X1(n,e);throw yb("Field path arguments must be of type string or ",n,!1,void 0,t)}var i5=new RegExp("[~\\*/\\[\\]]");function X1(n,e,t){if(e.search(i5)>=0)throw yb(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new mu(...e.split("."))._internalPath}catch{throw yb(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function yb(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new ne(K.INVALID_ARGUMENT,a+n+c)}var sh=class{convertValue(e,t="none"){switch(vs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ye(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(mi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ce(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return oh(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){let t=e.fields?.[Kd].arrayValue?.values?.map(r=>Ye(r.doubleValue));return new Zo(t)}convertGeoPoint(e){return new Xo(Ye(e.latitude),Ye(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Ug(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Gd(e));default:return null}}convertTimestamp(e){let t=pi(e);return new Qt(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=gt.fromString(e);Je(k1(r),9688,{name:e});let i=new Wd(r.get(1),r.get(3)),s=new oe(r.popFirst(5));return i.isEqual(t)||fi(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};var gu=class extends sh{constructor(e){super(),this.firestore=e}convertBytes(e){return new ys(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Sn(this.firestore,null,t)}};var Z1="@firebase/firestore",eM="4.11.0";function tM(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1})(n,["next","error","complete"])}var Mb=class{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}},Ob=class{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}_fieldsProto(){return new rr({mapValue:{fields:this._data}}).clone().value.mapValue.fields}};var zg=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Sn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Vb(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){let t=this._document.data.field(kb("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Vb=class extends zg{data(){return super.data()}};function u5(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ne(K.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}function l5(){return new Mb("count")}function nM(n){return d5(n,{count:l5()})}function d5(n,e){let t=_u(n.firestore,ws),r=Hg(t),i=Zk(e,(s,o)=>new _g(o,s.aggregateType,s._internalFieldPath));return Y1(r,n._query,i).then(s=>(function(a,c,d){let h=new gu(a);return new Ob(c,h,d)})(t,n,s))}var oa=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},aa=class n extends zg{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new wu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(kb("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ne(K.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};aa._jsonSchemaVersion="firestore/documentSnapshot/1.0",aa._jsonSchema={type:at("string",aa._jsonSchemaVersion),bundleSource:at("string","DocumentSnapshot"),bundleName:at("string"),bundle:at("string")};var wu=class extends aa{data(e={}){return super.data(e)}},Tu=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new oa(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new wu(this._firestore,this._userDataWriter,r.key,r,new oa(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ne(K.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new wu(i._firestore,i._userDataWriter,a.doc.key,a.doc,new oa(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new wu(i._firestore,i._userDataWriter,a.doc.key,a.doc,new oa(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:h5(a.type),doc:c,oldIndex:d,newIndex:h}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ne(K.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ru.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function h5(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ce(61501,{type:n})}}Tu._jsonSchemaVersion="firestore/querySnapshot/1.0",Tu._jsonSchema={type:at("string",Tu._jsonSchemaVersion),bundleSource:at("string","QuerySnapshot"),bundleName:at("string"),bundle:at("string")};function rM(n,...e){n=zc(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||tM(e[r])||(t=e[r++]);let i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(tM(e[r])){let d=e[r];e[r]=d.next?.bind(d),e[r+1]=d.error?.bind(d),e[r+2]=d.complete?.bind(d)}let s,o,a;if(n instanceof Sn)o=_u(n.firestore,ws),a=jg(n._key.path),s={next:d=>{e[r]&&e[r](f5(o,n,d))},error:e[r+1],complete:e[r+2]};else{let d=_u(n,fu);o=_u(d.firestore,ws),a=d._query;let h=new gu(o);s={next:f=>{e[r]&&e[r](new Tu(o,h,d,f))},error:e[r+1],complete:e[r+2]},u5(n._query)}let c=Hg(o);return Q1(c,a,i,s)}function f5(n,e,t){let r=t.docs.get(e._key),i=new gu(n);return new aa(n,i,e._key,r,new oa(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){Ok(Dx),kd(new ps("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new ws(new ag(r.getProvider("auth-internal")),new ug(o,r.getProvider("app-check-internal")),i1(o,i),o);return s=et({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Wc(Z1,eM,e),Wc(Z1,eM,"esm2020")})();var Gg=function(){return Gg=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Gg.apply(this,arguments)};function Ub(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))}var p5={includeMetadataChanges:!1};function uh(n,e){return e===void 0&&(e=p5),new me(function(t){var r=rM(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function jb(n){return uh(n,{includeMetadataChanges:!0})}function iM(n,e){return e===void 0&&(e={}),jb(n).pipe(un(function(t){return Wg(t,e)}))}function Wg(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:Gg(Gg({},r),(t={},t[e.idField]=n.id,t))}var sM=["added","modified","removed"],m5=function(n){return gc(function(e){for(var t=!1,r=0;r<e.length;r++){var i=e[r];if(n&&n.indexOf(i.type)>=0){t=!0;break}}return t})};function Lb(n,e,t){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var s=n.slice();return s.splice.apply(s,Ub([e,t],r,!1)),s}function g5(n,e){switch(e.type){case"added":if(!(n[e.newIndex]&&sa(n[e.newIndex].doc.ref,e.doc.ref)))return Lb(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||sa(n[e.oldIndex].doc.ref,e.doc.ref))if(e.oldIndex!==e.newIndex){var t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return Lb(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]&&sa(n[e.oldIndex].doc.ref,e.doc.ref))return Lb(n,e.oldIndex,1);break}return n}function y5(n,e,t){return t===void 0&&(t=sM),e.forEach(function(r){t.indexOf(r.type)>-1&&(n=g5(n,r))}),n}var oM=function(){return Jf(fv(void 0),hv())},Fb=function(n,e){return JSON.stringify(n.metadata)===JSON.stringify(e.metadata)},_5=function(){return Jf(oM(),gc(function(n){var e=n[0],t=n[1];return t.length>0||e===void 0}),un(function(n){var e=n[1];return e}))};function Kg(n,e){return e===void 0&&(e={}),uh(n,{includeMetadataChanges:!0}).pipe(oM(),un(function(t){var r=t[0],i=t[1],s=i.docChanges();return r&&!Fb(r,i)&&i.docs.forEach(function(o,a){var c=s.find(function(h){return sa(h.doc.ref,o.ref)});if(c){if(Fb(c.doc,o))return}else{var d=r?.docs.find(function(h){return sa(h.ref,o.ref)});if(d&&Fb(d,o))return}s.push({oldIndex:a,newIndex:a,type:"modified",doc:o})}),s}),m5(e.events||sM),_5())}function Bb(n){return uh(n,{includeMetadataChanges:!0}).pipe(un(function(e){return e.docs}))}function aM(n,e){return e===void 0&&(e={}),Kg(n,e).pipe(mp(function(t,r){return y5(t,r,e.events)},[]),dv())}function cM(n,e){return e===void 0&&(e={}),Kg(n,e).pipe(mp(function(t,r){return Ub(Ub([],t,!0),r,!0)},[]))}function uM(n,e){return e===void 0&&(e={}),Bb(n).pipe(un(function(t){return t.map(function(r){return Wg(r,e)})}))}function $b(n){return kn(nM(n))}function lM(n){return $b(n).pipe(un(function(e){return e.data().count}))}var dM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},hM={};var yi,qb;(function(){var n;function e(T,v){function E(){}E.prototype=v.prototype,T.D=v.prototype,T.prototype=new E,T.prototype.constructor=T,T.C=function(S,b,D){for(var I=Array(arguments.length-2),Ke=2;Ke<arguments.length;Ke++)I[Ke-2]=arguments[Ke];return v.prototype[b].apply(S,I)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,v,E){E||(E=0);var S=Array(16);if(typeof v=="string")for(var b=0;16>b;++b)S[b]=v.charCodeAt(E++)|v.charCodeAt(E++)<<8|v.charCodeAt(E++)<<16|v.charCodeAt(E++)<<24;else for(b=0;16>b;++b)S[b]=v[E++]|v[E++]<<8|v[E++]<<16|v[E++]<<24;v=T.g[0],E=T.g[1],b=T.g[2];var D=T.g[3],I=v+(D^E&(b^D))+S[0]+3614090360&4294967295;v=E+(I<<7&4294967295|I>>>25),I=D+(b^v&(E^b))+S[1]+3905402710&4294967295,D=v+(I<<12&4294967295|I>>>20),I=b+(E^D&(v^E))+S[2]+606105819&4294967295,b=D+(I<<17&4294967295|I>>>15),I=E+(v^b&(D^v))+S[3]+3250441966&4294967295,E=b+(I<<22&4294967295|I>>>10),I=v+(D^E&(b^D))+S[4]+4118548399&4294967295,v=E+(I<<7&4294967295|I>>>25),I=D+(b^v&(E^b))+S[5]+1200080426&4294967295,D=v+(I<<12&4294967295|I>>>20),I=b+(E^D&(v^E))+S[6]+2821735955&4294967295,b=D+(I<<17&4294967295|I>>>15),I=E+(v^b&(D^v))+S[7]+4249261313&4294967295,E=b+(I<<22&4294967295|I>>>10),I=v+(D^E&(b^D))+S[8]+1770035416&4294967295,v=E+(I<<7&4294967295|I>>>25),I=D+(b^v&(E^b))+S[9]+2336552879&4294967295,D=v+(I<<12&4294967295|I>>>20),I=b+(E^D&(v^E))+S[10]+4294925233&4294967295,b=D+(I<<17&4294967295|I>>>15),I=E+(v^b&(D^v))+S[11]+2304563134&4294967295,E=b+(I<<22&4294967295|I>>>10),I=v+(D^E&(b^D))+S[12]+1804603682&4294967295,v=E+(I<<7&4294967295|I>>>25),I=D+(b^v&(E^b))+S[13]+4254626195&4294967295,D=v+(I<<12&4294967295|I>>>20),I=b+(E^D&(v^E))+S[14]+2792965006&4294967295,b=D+(I<<17&4294967295|I>>>15),I=E+(v^b&(D^v))+S[15]+1236535329&4294967295,E=b+(I<<22&4294967295|I>>>10),I=v+(b^D&(E^b))+S[1]+4129170786&4294967295,v=E+(I<<5&4294967295|I>>>27),I=D+(E^b&(v^E))+S[6]+3225465664&4294967295,D=v+(I<<9&4294967295|I>>>23),I=b+(v^E&(D^v))+S[11]+643717713&4294967295,b=D+(I<<14&4294967295|I>>>18),I=E+(D^v&(b^D))+S[0]+3921069994&4294967295,E=b+(I<<20&4294967295|I>>>12),I=v+(b^D&(E^b))+S[5]+3593408605&4294967295,v=E+(I<<5&4294967295|I>>>27),I=D+(E^b&(v^E))+S[10]+38016083&4294967295,D=v+(I<<9&4294967295|I>>>23),I=b+(v^E&(D^v))+S[15]+3634488961&4294967295,b=D+(I<<14&4294967295|I>>>18),I=E+(D^v&(b^D))+S[4]+3889429448&4294967295,E=b+(I<<20&4294967295|I>>>12),I=v+(b^D&(E^b))+S[9]+568446438&4294967295,v=E+(I<<5&4294967295|I>>>27),I=D+(E^b&(v^E))+S[14]+3275163606&4294967295,D=v+(I<<9&4294967295|I>>>23),I=b+(v^E&(D^v))+S[3]+4107603335&4294967295,b=D+(I<<14&4294967295|I>>>18),I=E+(D^v&(b^D))+S[8]+1163531501&4294967295,E=b+(I<<20&4294967295|I>>>12),I=v+(b^D&(E^b))+S[13]+2850285829&4294967295,v=E+(I<<5&4294967295|I>>>27),I=D+(E^b&(v^E))+S[2]+4243563512&4294967295,D=v+(I<<9&4294967295|I>>>23),I=b+(v^E&(D^v))+S[7]+1735328473&4294967295,b=D+(I<<14&4294967295|I>>>18),I=E+(D^v&(b^D))+S[12]+2368359562&4294967295,E=b+(I<<20&4294967295|I>>>12),I=v+(E^b^D)+S[5]+4294588738&4294967295,v=E+(I<<4&4294967295|I>>>28),I=D+(v^E^b)+S[8]+2272392833&4294967295,D=v+(I<<11&4294967295|I>>>21),I=b+(D^v^E)+S[11]+1839030562&4294967295,b=D+(I<<16&4294967295|I>>>16),I=E+(b^D^v)+S[14]+4259657740&4294967295,E=b+(I<<23&4294967295|I>>>9),I=v+(E^b^D)+S[1]+2763975236&4294967295,v=E+(I<<4&4294967295|I>>>28),I=D+(v^E^b)+S[4]+1272893353&4294967295,D=v+(I<<11&4294967295|I>>>21),I=b+(D^v^E)+S[7]+4139469664&4294967295,b=D+(I<<16&4294967295|I>>>16),I=E+(b^D^v)+S[10]+3200236656&4294967295,E=b+(I<<23&4294967295|I>>>9),I=v+(E^b^D)+S[13]+681279174&4294967295,v=E+(I<<4&4294967295|I>>>28),I=D+(v^E^b)+S[0]+3936430074&4294967295,D=v+(I<<11&4294967295|I>>>21),I=b+(D^v^E)+S[3]+3572445317&4294967295,b=D+(I<<16&4294967295|I>>>16),I=E+(b^D^v)+S[6]+76029189&4294967295,E=b+(I<<23&4294967295|I>>>9),I=v+(E^b^D)+S[9]+3654602809&4294967295,v=E+(I<<4&4294967295|I>>>28),I=D+(v^E^b)+S[12]+3873151461&4294967295,D=v+(I<<11&4294967295|I>>>21),I=b+(D^v^E)+S[15]+530742520&4294967295,b=D+(I<<16&4294967295|I>>>16),I=E+(b^D^v)+S[2]+3299628645&4294967295,E=b+(I<<23&4294967295|I>>>9),I=v+(b^(E|~D))+S[0]+4096336452&4294967295,v=E+(I<<6&4294967295|I>>>26),I=D+(E^(v|~b))+S[7]+1126891415&4294967295,D=v+(I<<10&4294967295|I>>>22),I=b+(v^(D|~E))+S[14]+2878612391&4294967295,b=D+(I<<15&4294967295|I>>>17),I=E+(D^(b|~v))+S[5]+4237533241&4294967295,E=b+(I<<21&4294967295|I>>>11),I=v+(b^(E|~D))+S[12]+1700485571&4294967295,v=E+(I<<6&4294967295|I>>>26),I=D+(E^(v|~b))+S[3]+2399980690&4294967295,D=v+(I<<10&4294967295|I>>>22),I=b+(v^(D|~E))+S[10]+4293915773&4294967295,b=D+(I<<15&4294967295|I>>>17),I=E+(D^(b|~v))+S[1]+2240044497&4294967295,E=b+(I<<21&4294967295|I>>>11),I=v+(b^(E|~D))+S[8]+1873313359&4294967295,v=E+(I<<6&4294967295|I>>>26),I=D+(E^(v|~b))+S[15]+4264355552&4294967295,D=v+(I<<10&4294967295|I>>>22),I=b+(v^(D|~E))+S[6]+2734768916&4294967295,b=D+(I<<15&4294967295|I>>>17),I=E+(D^(b|~v))+S[13]+1309151649&4294967295,E=b+(I<<21&4294967295|I>>>11),I=v+(b^(E|~D))+S[4]+4149444226&4294967295,v=E+(I<<6&4294967295|I>>>26),I=D+(E^(v|~b))+S[11]+3174756917&4294967295,D=v+(I<<10&4294967295|I>>>22),I=b+(v^(D|~E))+S[2]+718787259&4294967295,b=D+(I<<15&4294967295|I>>>17),I=E+(D^(b|~v))+S[9]+3951481745&4294967295,T.g[0]=T.g[0]+v&4294967295,T.g[1]=T.g[1]+(b+(I<<21&4294967295|I>>>11))&4294967295,T.g[2]=T.g[2]+b&4294967295,T.g[3]=T.g[3]+D&4294967295}r.prototype.u=function(T,v){v===void 0&&(v=T.length);for(var E=v-this.blockSize,S=this.B,b=this.h,D=0;D<v;){if(b==0)for(;D<=E;)i(this,T,D),D+=this.blockSize;if(typeof T=="string"){for(;D<v;)if(S[b++]=T.charCodeAt(D++),b==this.blockSize){i(this,S),b=0;break}}else for(;D<v;)if(S[b++]=T[D++],b==this.blockSize){i(this,S),b=0;break}}this.h=b,this.o+=v},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var v=1;v<T.length-8;++v)T[v]=0;var E=8*this.o;for(v=T.length-8;v<T.length;++v)T[v]=E&255,E/=256;for(this.u(T),T=Array(16),v=E=0;4>v;++v)for(var S=0;32>S;S+=8)T[E++]=this.g[v]>>>S&255;return T};function s(T,v){var E=a;return Object.prototype.hasOwnProperty.call(E,T)?E[T]:E[T]=v(T)}function o(T,v){this.h=v;for(var E=[],S=!0,b=T.length-1;0<=b;b--){var D=T[b]|0;S&&D==v||(E[b]=D,S=!1)}this.g=E}var a={};function c(T){return-128<=T&&128>T?s(T,function(v){return new o([v|0],0>v?-1:0)}):new o([T|0],0>T?-1:0)}function d(T){if(isNaN(T)||!isFinite(T))return f;if(0>T)return P(d(-T));for(var v=[],E=1,S=0;T>=E;S++)v[S]=T/E|0,E*=4294967296;return new o(v,0)}function h(T,v){if(T.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(T.charAt(0)=="-")return P(h(T.substring(1),v));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=d(Math.pow(v,8)),S=f,b=0;b<T.length;b+=8){var D=Math.min(8,T.length-b),I=parseInt(T.substring(b,b+D),v);8>D?(D=d(Math.pow(v,D)),S=S.j(D).add(d(I))):(S=S.j(E),S=S.add(d(I)))}return S}var f=c(0),y=c(1),w=c(16777216);n=o.prototype,n.m=function(){if(N(this))return-P(this).m();for(var T=0,v=1,E=0;E<this.g.length;E++){var S=this.i(E);T+=(0<=S?S:4294967296+S)*v,v*=4294967296}return T},n.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(R(this))return"0";if(N(this))return"-"+P(this).toString(T);for(var v=d(Math.pow(T,6)),E=this,S="";;){var b=ee(E,v).g;E=F(E,b.j(v));var D=((0<E.g.length?E.g[0]:E.h)>>>0).toString(T);if(E=b,R(E))return D+S;for(;6>D.length;)D="0"+D;S=D+S}},n.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function R(T){if(T.h!=0)return!1;for(var v=0;v<T.g.length;v++)if(T.g[v]!=0)return!1;return!0}function N(T){return T.h==-1}n.l=function(T){return T=F(this,T),N(T)?-1:R(T)?0:1};function P(T){for(var v=T.g.length,E=[],S=0;S<v;S++)E[S]=~T.g[S];return new o(E,~T.h).add(y)}n.abs=function(){return N(this)?P(this):this},n.add=function(T){for(var v=Math.max(this.g.length,T.g.length),E=[],S=0,b=0;b<=v;b++){var D=S+(this.i(b)&65535)+(T.i(b)&65535),I=(D>>>16)+(this.i(b)>>>16)+(T.i(b)>>>16);S=I>>>16,D&=65535,I&=65535,E[b]=I<<16|D}return new o(E,E[E.length-1]&-2147483648?-1:0)};function F(T,v){return T.add(P(v))}n.j=function(T){if(R(this)||R(T))return f;if(N(this))return N(T)?P(this).j(P(T)):P(P(this).j(T));if(N(T))return P(this.j(P(T)));if(0>this.l(w)&&0>T.l(w))return d(this.m()*T.m());for(var v=this.g.length+T.g.length,E=[],S=0;S<2*v;S++)E[S]=0;for(S=0;S<this.g.length;S++)for(var b=0;b<T.g.length;b++){var D=this.i(S)>>>16,I=this.i(S)&65535,Ke=T.i(b)>>>16,rn=T.i(b)&65535;E[2*S+2*b]+=I*rn,q(E,2*S+2*b),E[2*S+2*b+1]+=D*rn,q(E,2*S+2*b+1),E[2*S+2*b+1]+=I*Ke,q(E,2*S+2*b+1),E[2*S+2*b+2]+=D*Ke,q(E,2*S+2*b+2)}for(S=0;S<v;S++)E[S]=E[2*S+1]<<16|E[2*S];for(S=v;S<2*v;S++)E[S]=0;return new o(E,0)};function q(T,v){for(;(T[v]&65535)!=T[v];)T[v+1]+=T[v]>>>16,T[v]&=65535,v++}function $(T,v){this.g=T,this.h=v}function ee(T,v){if(R(v))throw Error("division by zero");if(R(T))return new $(f,f);if(N(T))return v=ee(P(T),v),new $(P(v.g),P(v.h));if(N(v))return v=ee(T,P(v)),new $(P(v.g),v.h);if(30<T.g.length){if(N(T)||N(v))throw Error("slowDivide_ only works with positive integers.");for(var E=y,S=v;0>=S.l(T);)E=ue(E),S=ue(S);var b=Z(E,1),D=Z(S,1);for(S=Z(S,2),E=Z(E,2);!R(S);){var I=D.add(S);0>=I.l(T)&&(b=b.add(E),D=I),S=Z(S,1),E=Z(E,1)}return v=F(T,b.j(v)),new $(b,v)}for(b=f;0<=T.l(v);){for(E=Math.max(1,Math.floor(T.m()/v.m())),S=Math.ceil(Math.log(E)/Math.LN2),S=48>=S?1:Math.pow(2,S-48),D=d(E),I=D.j(v);N(I)||0<I.l(T);)E-=S,D=d(E),I=D.j(v);R(D)&&(D=y),b=b.add(D),T=F(T,I)}return new $(b,T)}n.A=function(T){return ee(this,T).h},n.and=function(T){for(var v=Math.max(this.g.length,T.g.length),E=[],S=0;S<v;S++)E[S]=this.i(S)&T.i(S);return new o(E,this.h&T.h)},n.or=function(T){for(var v=Math.max(this.g.length,T.g.length),E=[],S=0;S<v;S++)E[S]=this.i(S)|T.i(S);return new o(E,this.h|T.h)},n.xor=function(T){for(var v=Math.max(this.g.length,T.g.length),E=[],S=0;S<v;S++)E[S]=this.i(S)^T.i(S);return new o(E,this.h^T.h)};function ue(T){for(var v=T.g.length+1,E=[],S=0;S<v;S++)E[S]=T.i(S)<<1|T.i(S-1)>>>31;return new o(E,T.h)}function Z(T,v){var E=v>>5;v%=32;for(var S=T.g.length-E,b=[],D=0;D<S;D++)b[D]=0<v?T.i(D+E)>>>v|T.i(D+E+1)<<32-v:T.i(D+E);return new o(b,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,qb=hM.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,yi=hM.Integer=o}).apply(typeof dM<"u"?dM:typeof self<"u"?self:typeof window<"u"?window:{});var Qg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},_i={};var Hb,v5,bu,zb,lh,Yg,Gb,Wb,Kb;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,p,g){return u==Array.prototype||u==Object.prototype||(u[p]=g.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Qg=="object"&&Qg];for(var p=0;p<u.length;++p){var g=u[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=t(this);function i(u,p){if(p)e:{var g=r;u=u.split(".");for(var A=0;A<u.length-1;A++){var k=u[A];if(!(k in g))break e;g=g[k]}u=u[u.length-1],A=g[u],p=p(A),p!=A&&p!=null&&e(g,u,{configurable:!0,writable:!0,value:p})}}function s(u,p){u instanceof String&&(u+="");var g=0,A=!1,k={next:function(){if(!A&&g<u.length){var L=g++;return{value:p(L,u[L]),done:!1}}return A=!0,{done:!0,value:void 0}}};return k[Symbol.iterator]=function(){return k},k}i("Array.prototype.values",function(u){return u||function(){return s(this,function(p,g){return g})}});var o=o||{},a=this||self;function c(u){var p=typeof u;return p=p!="object"?p:u?Array.isArray(u)?"array":p:"null",p=="array"||p=="object"&&typeof u.length=="number"}function d(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function h(u,p,g){return u.call.apply(u.bind,arguments)}function f(u,p,g){if(!u)throw Error();if(2<arguments.length){var A=Array.prototype.slice.call(arguments,2);return function(){var k=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(k,A),u.apply(p,k)}}return function(){return u.apply(p,arguments)}}function y(u,p,g){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:f,y.apply(null,arguments)}function w(u,p){var g=Array.prototype.slice.call(arguments,1);return function(){var A=g.slice();return A.push.apply(A,arguments),u.apply(this,A)}}function R(u,p){function g(){}g.prototype=p.prototype,u.aa=p.prototype,u.prototype=new g,u.prototype.constructor=u,u.Qb=function(A,k,L){for(var H=Array(arguments.length-2),Ne=2;Ne<arguments.length;Ne++)H[Ne-2]=arguments[Ne];return p.prototype[k].apply(A,H)}}function N(u){let p=u.length;if(0<p){let g=Array(p);for(let A=0;A<p;A++)g[A]=u[A];return g}return[]}function P(u,p){for(let g=1;g<arguments.length;g++){let A=arguments[g];if(c(A)){let k=u.length||0,L=A.length||0;u.length=k+L;for(let H=0;H<L;H++)u[k+H]=A[H]}else u.push(A)}}class F{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function q(u){return/^[\s\xa0]*$/.test(u)}function $(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function ee(u){return ee[" "](u),u}ee[" "]=function(){};var ue=$().indexOf("Gecko")!=-1&&!($().toLowerCase().indexOf("webkit")!=-1&&$().indexOf("Edge")==-1)&&!($().indexOf("Trident")!=-1||$().indexOf("MSIE")!=-1)&&$().indexOf("Edge")==-1;function Z(u,p,g){for(let A in u)p.call(g,u[A],A,u)}function T(u,p){for(let g in u)p.call(void 0,u[g],g,u)}function v(u){let p={};for(let g in u)p[g]=u[g];return p}let E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function S(u,p){let g,A;for(let k=1;k<arguments.length;k++){A=arguments[k];for(g in A)u[g]=A[g];for(let L=0;L<E.length;L++)g=E[L],Object.prototype.hasOwnProperty.call(A,g)&&(u[g]=A[g])}}function b(u){var p=1;u=u.split(":");let g=[];for(;0<p&&u.length;)g.push(u.shift()),p--;return u.length&&g.push(u.join(":")),g}function D(u){a.setTimeout(()=>{throw u},0)}function I(){var u=Ni;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class Ke{constructor(){this.h=this.g=null}add(p,g){let A=rn.get();A.set(p,g),this.h?this.h.next=A:this.g=A,this.h=A}}var rn=new F(()=>new k_,u=>u.reset());class k_{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let Ks,lr=!1,Ni=new Ke,ff=()=>{let u=a.Promise.resolve(void 0);Ks=()=>{u.then(pf)}};var pf=()=>{for(var u;u=I();){try{u.h.call(u.g)}catch(g){D(g)}var p=rn;p.j(u),100>p.h&&(p.h++,u.next=p.g,p.g=u)}lr=!1};function Bn(){this.s=this.s,this.C=this.C}Bn.prototype.s=!1,Bn.prototype.ma=function(){this.s||(this.s=!0,this.N())},Bn.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function St(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}St.prototype.h=function(){this.defaultPrevented=!0};var Oa=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let g=()=>{};a.addEventListener("test",g,p),a.removeEventListener("test",g,p)}catch{}return u})();function Br(u,p){if(St.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var g=this.type=u.type,A=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget){if(ue){e:{try{ee(p.nodeName);var k=!0;break e}catch{}k=!1}k||(p=null)}}else g=="mouseover"?p=u.fromElement:g=="mouseout"&&(p=u.toElement);this.relatedTarget=p,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:yl[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Br.aa.h.call(this)}}R(Br,St);var yl={2:"touch",3:"pen",4:"mouse"};Br.prototype.h=function(){Br.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var $r="closure_listenable_"+(1e6*Math.random()|0),_l=0;function mf(u,p,g,A,k){this.listener=u,this.proxy=null,this.src=p,this.type=g,this.capture=!!A,this.ha=k,this.key=++_l,this.da=this.fa=!1}function Qs(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Va(u){this.src=u,this.g={},this.h=0}Va.prototype.add=function(u,p,g,A,k){var L=u.toString();u=this.g[L],u||(u=this.g[L]=[],this.h++);var H=Fa(u,p,A,k);return-1<H?(p=u[H],g||(p.fa=!1)):(p=new mf(p,this.src,L,!!A,k),p.fa=g,u.push(p)),p};function La(u,p){var g=p.type;if(g in u.g){var A=u.g[g],k=Array.prototype.indexOf.call(A,p,void 0),L;(L=0<=k)&&Array.prototype.splice.call(A,k,1),L&&(Qs(p),u.g[g].length==0&&(delete u.g[g],u.h--))}}function Fa(u,p,g,A){for(var k=0;k<u.length;++k){var L=u[k];if(!L.da&&L.listener==p&&L.capture==!!g&&L.ha==A)return k}return-1}var Ys="closure_lm_"+(1e6*Math.random()|0),Ua={};function gf(u,p,g,A,k){if(A&&A.once)return Ba(u,p,g,A,k);if(Array.isArray(p)){for(var L=0;L<p.length;L++)gf(u,p[L],g,A,k);return null}return g=qr(g),u&&u[$r]?u.K(p,g,d(A)?!!A.capture:!!A,k):ja(u,p,g,!1,A,k)}function ja(u,p,g,A,k,L){if(!p)throw Error("Invalid event type");var H=d(k)?!!k.capture:!!k,Ne=$a(u);if(Ne||(u[Ys]=Ne=new Va(u)),g=Ne.add(p,g,A,H,L),g.proxy)return g;if(A=vl(),g.proxy=A,A.src=u,A.listener=g,u.addEventListener)Oa||(k=H),k===void 0&&(k=!1),u.addEventListener(p.toString(),A,k);else if(u.attachEvent)u.attachEvent(Js(p.toString()),A);else if(u.addListener&&u.removeListener)u.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return g}function vl(){function u(g){return p.call(u.src,u.listener,g)}let p=M_;return u}function Ba(u,p,g,A,k){if(Array.isArray(p)){for(var L=0;L<p.length;L++)Ba(u,p[L],g,A,k);return null}return g=qr(g),u&&u[$r]?u.L(p,g,d(A)?!!A.capture:!!A,k):ja(u,p,g,!0,A,k)}function At(u,p,g,A,k){if(Array.isArray(p))for(var L=0;L<p.length;L++)At(u,p[L],g,A,k);else A=d(A)?!!A.capture:!!A,g=qr(g),u&&u[$r]?(u=u.i,p=String(p).toString(),p in u.g&&(L=u.g[p],g=Fa(L,g,A,k),-1<g&&(Qs(L[g]),Array.prototype.splice.call(L,g,1),L.length==0&&(delete u.g[p],u.h--)))):u&&(u=$a(u))&&(p=u.g[p.toString()],u=-1,p&&(u=Fa(p,g,A,k)),(g=-1<u?p[u]:null)&&Ct(g))}function Ct(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[$r])La(p.i,u);else{var g=u.type,A=u.proxy;p.removeEventListener?p.removeEventListener(g,A,u.capture):p.detachEvent?p.detachEvent(Js(g),A):p.addListener&&p.removeListener&&p.removeListener(A),(g=$a(p))?(La(g,u),g.h==0&&(g.src=null,p[Ys]=null)):Qs(u)}}}function Js(u){return u in Ua?Ua[u]:Ua[u]="on"+u}function M_(u,p){if(u.da)u=!0;else{p=new Br(p,this);var g=u.listener,A=u.ha||u.src;u.fa&&Ct(u),u=g.call(A,p)}return u}function $a(u){return u=u[Ys],u instanceof Va?u:null}var Il="__closure_events_fn_"+(1e9*Math.random()>>>0);function qr(u){return typeof u=="function"?u:(u[Il]||(u[Il]=function(p){return u.handleEvent(p)}),u[Il])}function Dt(){Bn.call(this),this.i=new Va(this),this.M=this,this.F=null}R(Dt,Bn),Dt.prototype[$r]=!0,Dt.prototype.removeEventListener=function(u,p,g,A){At(this,u,p,g,A)};function Pt(u,p){var g,A=u.F;if(A)for(g=[];A;A=A.F)g.push(A);if(u=u.M,A=p.type||p,typeof p=="string")p=new St(p,u);else if(p instanceof St)p.target=p.target||u;else{var k=p;p=new St(A,u),S(p,k)}if(k=!0,g)for(var L=g.length-1;0<=L;L--){var H=p.g=g[L];k=Pi(H,A,!0,p)&&k}if(H=p.g=u,k=Pi(H,A,!0,p)&&k,k=Pi(H,A,!1,p)&&k,g)for(L=0;L<g.length;L++)H=p.g=g[L],k=Pi(H,A,!1,p)&&k}Dt.prototype.N=function(){if(Dt.aa.N.call(this),this.i){var u=this.i,p;for(p in u.g){for(var g=u.g[p],A=0;A<g.length;A++)Qs(g[A]);delete u.g[p],u.h--}}this.F=null},Dt.prototype.K=function(u,p,g,A){return this.i.add(String(u),p,!1,g,A)},Dt.prototype.L=function(u,p,g,A){return this.i.add(String(u),p,!0,g,A)};function Pi(u,p,g,A){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();for(var k=!0,L=0;L<p.length;++L){var H=p[L];if(H&&!H.da&&H.capture==g){var Ne=H.listener,it=H.ha||H.src;H.fa&&La(u.i,H),k=Ne.call(it,A)!==!1&&k}}return k&&!A.defaultPrevented}function yf(u,p,g){if(typeof u=="function")g&&(u=y(u,g));else if(u&&typeof u.handleEvent=="function")u=y(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:a.setTimeout(u,p||0)}function _f(u){u.g=yf(()=>{u.g=null,u.i&&(u.i=!1,_f(u))},u.l);let p=u.h;u.h=null,u.m.apply(null,p)}class vf extends Bn{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:_f(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xi(u){Bn.call(this),this.h=u,this.g={}}R(xi,Bn);var ki=[];function qa(u){Z(u.g,function(p,g){this.g.hasOwnProperty(g)&&Ct(p)},u),u.g={}}xi.prototype.N=function(){xi.aa.N.call(this),qa(this)},xi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Xs=a.JSON.stringify,Hr=a.JSON.parse,If=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function Mi(){}Mi.prototype.h=null;function El(u){return u.h||(u.h=u.i())}function Oi(){}var Vi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Rt(){St.call(this,"d")}R(Rt,St);function Ha(){St.call(this,"c")}R(Ha,St);var mn={},Li=null;function za(){return Li=Li||new Dt}mn.La="serverreachability";function Ef(u){St.call(this,mn.La,u)}R(Ef,St);function Pn(u){let p=za();Pt(p,new Ef(p))}mn.STAT_EVENT="statevent";function wf(u,p){St.call(this,mn.STAT_EVENT,u),this.stat=p}R(wf,St);function Ot(u){let p=za();Pt(p,new wf(p,u))}mn.Ma="timingevent";function Zs(u,p){St.call(this,mn.Ma,u),this.size=p}R(Zs,St);function Fi(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},p)}function Ui(){this.g=!0}Ui.prototype.xa=function(){this.g=!1};function wl(u,p,g,A,k,L){u.info(function(){if(u.g)if(L)for(var H="",Ne=L.split("&"),it=0;it<Ne.length;it++){var Pe=Ne[it].split("=");if(1<Pe.length){var Bt=Pe[0];Pe=Pe[1];var $t=Bt.split("_");H=2<=$t.length&&$t[1]=="type"?H+(Bt+"="+Pe+"&"):H+(Bt+"=redacted&")}}else H=null;else H=L;return"XMLHTTP REQ ("+A+") [attempt "+k+"]: "+p+`
`+g+`
`+H})}function eo(u,p,g,A,k,L,H){u.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+k+"]: "+p+`
`+g+`
`+L+" "+H})}function ji(u,p,g,A){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+Tf(u,g)+(A?" "+A:"")})}function dr(u,p){u.info(function(){return"TIMEOUT: "+p})}Ui.prototype.info=function(){};function Tf(u,p){if(!u.g)return p;if(!p)return null;try{var g=JSON.parse(p);if(g){for(u=0;u<g.length;u++)if(Array.isArray(g[u])){var A=g[u];if(!(2>A.length)){var k=A[1];if(Array.isArray(k)&&!(1>k.length)){var L=k[0];if(L!="noop"&&L!="stop"&&L!="close")for(var H=1;H<k.length;H++)k[H]=""}}}}return Xs(g)}catch{return p}}var to={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ga={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},no;function ro(){}R(ro,Mi),ro.prototype.g=function(){return new XMLHttpRequest},ro.prototype.i=function(){return{}},no=new ro;function hr(u,p,g,A){this.j=u,this.i=p,this.l=g,this.R=A||1,this.U=new xi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Tl}function Tl(){this.i=null,this.g="",this.h=!1}var bf={},Bi={};function Wa(u,p,g){u.L=1,u.v=Ja($n(p)),u.m=g,u.P=!0,Ka(u,null)}function Ka(u,p){u.F=Date.now(),qi(u),u.A=$n(u.v);var g=u.A,A=u.R;Array.isArray(A)||(A=[String(A)]),xf(g.i,"t",A),u.C=0,g=u.j.J,u.h=new Tl,u.g=m(u.j,g?p:null,!u.m),0<u.O&&(u.M=new vf(y(u.Y,u,u.g),u.O)),p=u.U,g=u.g,A=u.ca;var k="readystatechange";Array.isArray(k)||(k&&(ki[0]=k.toString()),k=ki);for(var L=0;L<k.length;L++){var H=gf(g,k[L],A||p.handleEvent,!1,p.h||p);if(!H)break;p.g[H.key]=H}p=u.H?v(u.H):{},u.m?(u.u||(u.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,p)):(u.u="GET",u.g.ea(u.A,u.u,null,p)),Pn(),wl(u.i,u.u,u.A,u.l,u.R,u.m)}hr.prototype.ca=function(u){u=u.target;let p=this.M;p&&on(u)==3?p.j():this.Y(u)},hr.prototype.Y=function(u){try{if(u==this.g)e:{let $t=on(this.g);var p=this.g.Ba();let oc=this.g.Z();if(!(3>$t)&&($t!=3||this.g&&(this.h.h||this.g.oa()||Lf(this.g)))){this.J||$t!=4||p==7||(p==8||0>=oc?Pn(3):Pn(2)),Qa(this);var g=this.g.Z();this.X=g;t:if($i(this)){var A=Lf(this.g);u="";var k=A.length,L=on(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){fr(this),Hi(this);var H="";break t}this.h.i=new a.TextDecoder}for(p=0;p<k;p++)this.h.h=!0,u+=this.h.i.decode(A[p],{stream:!(L&&p==k-1)});A.length=0,this.h.g+=u,this.C=0,H=this.h.g}else H=this.g.oa();if(this.o=g==200,eo(this.i,this.u,this.A,this.l,this.R,$t,g),this.o){if(this.T&&!this.K){t:{if(this.g){var Ne,it=this.g;if((Ne=it.g?it.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!q(Ne)){var Pe=Ne;break t}}Pe=null}if(g=Pe)ji(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,io(this,g);else{this.o=!1,this.s=3,Ot(12),fr(this),Hi(this);break e}}if(this.P){g=!0;let Wn;for(;!this.J&&this.C<H.length;)if(Wn=zr(this,H),Wn==Bi){$t==4&&(this.s=4,Ot(14),g=!1),ji(this.i,this.l,null,"[Incomplete Response]");break}else if(Wn==bf){this.s=4,Ot(15),ji(this.i,this.l,H,"[Invalid Chunk]"),g=!1;break}else ji(this.i,this.l,Wn,null),io(this,Wn);if($i(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),$t!=4||H.length!=0||this.h.h||(this.s=1,Ot(16),g=!1),this.o=this.o&&g,!g)ji(this.i,this.l,H,"[Invalid Chunked Response]"),fr(this),Hi(this);else if(0<H.length&&!this.W){this.W=!0;var Bt=this.j;Bt.g==this&&Bt.ba&&!Bt.M&&(Bt.j.info("Great, no buffering proxy detected. Bytes received: "+H.length),sc(Bt),Bt.M=!0,Ot(11))}}else ji(this.i,this.l,H,null),io(this,H);$t==4&&fr(this),this.o&&!this.J&&($t==4?jt(this.j,this):(this.o=!1,qi(this)))}else Ff(this.g),g==400&&0<H.indexOf("Unknown SID")?(this.s=3,Ot(12)):(this.s=0,Ot(13)),fr(this),Hi(this)}}}catch{}};function $i(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function zr(u,p){var g=u.C,A=p.indexOf(`
`,g);return A==-1?Bi:(g=Number(p.substring(g,A)),isNaN(g)?bf:(A+=1,A+g>p.length?Bi:(p=p.slice(A,A+g),u.C=A+g,p)))}hr.prototype.cancel=function(){this.J=!0,fr(this)};function qi(u){u.S=Date.now()+u.I,Sf(u,u.I)}function Sf(u,p){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Fi(y(u.ba,u),p)}function Qa(u){u.B&&(a.clearTimeout(u.B),u.B=null)}hr.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(dr(this.i,this.A),this.L!=2&&(Pn(),Ot(17)),fr(this),this.s=2,Hi(this)):Sf(this,this.S-u)};function Hi(u){u.j.G==0||u.J||jt(u.j,u)}function fr(u){Qa(u);var p=u.M;p&&typeof p.ma=="function"&&p.ma(),u.M=null,qa(u.U),u.g&&(p=u.g,u.g=null,p.abort(),p.ma())}function io(u,p){try{var g=u.j;if(g.G!=0&&(g.g==u||Dl(g.h,u))){if(!u.K&&Dl(g.h,u)&&g.G==3){try{var A=g.Da.g.parse(p)}catch{A=null}if(Array.isArray(A)&&A.length==3){var k=A;if(k[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<u.F)Wr(g),Ji(g);else break e;ic(g),Ot(18)}}else g.za=k[1],0<g.za-g.T&&37500>k[2]&&g.F&&g.v==0&&!g.C&&(g.C=Fi(y(g.Za,g),6e3));if(1>=Cl(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else gr(g,11)}else if((u.K||g.g==u)&&Wr(g),!q(p))for(k=g.Da.g.parse(p),p=0;p<k.length;p++){let Pe=k[p];if(g.T=Pe[0],Pe=Pe[1],g.G==2)if(Pe[0]=="c"){g.K=Pe[1],g.ia=Pe[2];let Bt=Pe[3];Bt!=null&&(g.la=Bt,g.j.info("VER="+g.la));let $t=Pe[4];$t!=null&&(g.Aa=$t,g.j.info("SVER="+g.Aa));let oc=Pe[5];oc!=null&&typeof oc=="number"&&0<oc&&(A=1.5*oc,g.L=A,g.j.info("backChannelRequestTimeoutMs_="+A)),A=g;let Wn=u.g;if(Wn){let Uf=Wn.g?Wn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Uf){var L=A.h;L.g||Uf.indexOf("spdy")==-1&&Uf.indexOf("quic")==-1&&Uf.indexOf("h2")==-1||(L.j=L.l,L.g=new Set,L.h&&(xn(L,L.h),L.h=null))}if(A.D){let V_=Wn.g?Wn.g.getResponseHeader("X-HTTP-Session-Id"):null;V_&&(A.ya=V_,He(A.I,A.D,V_))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-u.F,g.j.info("Handshake RTT: "+g.R+"ms")),A=g;var H=u;if(A.qa=l(A,A.J?A.ia:null,A.W),H.K){gn(A.h,H);var Ne=H,it=A.L;it&&(Ne.I=it),Ne.B&&(Qa(Ne),qi(Ne)),A.g=H}else Ll(A);0<g.i.length&&ho(g)}else Pe[0]!="stop"&&Pe[0]!="close"||gr(g,7);else g.G==3&&(Pe[0]=="stop"||Pe[0]=="close"?Pe[0]=="stop"?gr(g,7):tc(g):Pe[0]!="noop"&&g.l&&g.l.ta(Pe),g.v=0)}}Pn(4)}catch{}}var bl=class{constructor(u,p){this.g=u,this.map=p}};function Sl(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Al(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Cl(u){return u.h?1:u.g?u.g.size:0}function Dl(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function xn(u,p){u.g?u.g.add(p):u.h=p}function gn(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}Sl.prototype.cancel=function(){if(this.i=zi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function zi(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let p=u.i;for(let g of u.g.values())p=p.concat(g.D);return p}return N(u.i)}function so(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var p=[],g=u.length,A=0;A<g;A++)p.push(u[A]);return p}p=[],g=0;for(A in u)p[g++]=u[A];return p}function Rl(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var p=[];u=u.length;for(var g=0;g<u;g++)p.push(g);return p}p=[],g=0;for(let A in u)p[g++]=A;return p}}}function je(u,p){if(u.forEach&&typeof u.forEach=="function")u.forEach(p,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,p,void 0);else for(var g=Rl(u),A=so(u),k=A.length,L=0;L<k;L++)p.call(void 0,A[L],g&&g[L],u)}var oo=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ao(u,p){if(u){u=u.split("&");for(var g=0;g<u.length;g++){var A=u[g].indexOf("="),k=null;if(0<=A){var L=u[g].substring(0,A);k=u[g].substring(A+1)}else L=u[g];p(L,k?decodeURIComponent(k.replace(/\+/g," ")):"")}}}function yn(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof yn){this.h=u.h,co(this,u.j),this.o=u.o,this.g=u.g,Ya(this,u.s),this.l=u.l;var p=u.i,g=new uo;g.i=p.i,p.g&&(g.g=new Map(p.g),g.h=p.h),Af(this,g),this.m=u.m}else u&&(p=String(u).match(oo))?(this.h=!1,co(this,p[1]||"",!0),this.o=qn(p[2]||""),this.g=qn(p[3]||"",!0),Ya(this,p[4]),this.l=qn(p[5]||"",!0),Af(this,p[6]||"",!0),this.m=qn(p[7]||"")):(this.h=!1,this.i=new uo(null,this.h))}yn.prototype.toString=function(){var u=[],p=this.j;p&&u.push(_n(p,Nl,!0),":");var g=this.g;return(g||p=="file")&&(u.push("//"),(p=this.o)&&u.push(_n(p,Nl,!0),"@"),u.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&u.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&u.push("/"),u.push(_n(g,g.charAt(0)=="/"?Rf:Df,!0))),(g=this.i.toString())&&u.push("?",g),(g=this.m)&&u.push("#",_n(g,Gi)),u.join("")};function $n(u){return new yn(u)}function co(u,p,g){u.j=g?qn(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function Ya(u,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);u.s=p}else u.s=null}function Af(u,p,g){p instanceof uo?(u.i=p,Xa(u.i,u.h)):(g||(p=_n(p,Nf)),u.i=new uo(p,u.h))}function He(u,p,g){u.i.set(p,g)}function Ja(u){return He(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function qn(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function _n(u,p,g){return typeof u=="string"?(u=encodeURI(u).replace(p,Cf),g&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Cf(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Nl=/[#\/\?@]/g,Df=/[#\?:]/g,Rf=/[#\?]/g,Nf=/[#\?@]/g,Gi=/#/g;function uo(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function pr(u){u.g||(u.g=new Map,u.h=0,u.i&&ao(u.i,function(p,g){u.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}n=uo.prototype,n.add=function(u,p){pr(this),this.i=null,u=zn(this,u);var g=this.g.get(u);return g||this.g.set(u,g=[]),g.push(p),this.h+=1,this};function Pf(u,p){pr(u),p=zn(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function Hn(u,p){return pr(u),p=zn(u,p),u.g.has(p)}n.forEach=function(u,p){pr(this),this.g.forEach(function(g,A){g.forEach(function(k){u.call(p,k,A,this)},this)},this)},n.na=function(){pr(this);let u=Array.from(this.g.values()),p=Array.from(this.g.keys()),g=[];for(let A=0;A<p.length;A++){let k=u[A];for(let L=0;L<k.length;L++)g.push(p[A])}return g},n.V=function(u){pr(this);let p=[];if(typeof u=="string")Hn(this,u)&&(p=p.concat(this.g.get(zn(this,u))));else{u=Array.from(this.g.values());for(let g=0;g<u.length;g++)p=p.concat(u[g])}return p},n.set=function(u,p){return pr(this),this.i=null,u=zn(this,u),Hn(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},n.get=function(u,p){return u?(u=this.V(u),0<u.length?String(u[0]):p):p};function xf(u,p,g){Pf(u,p),0<g.length&&(u.i=null,u.g.set(zn(u,p),N(g)),u.h+=g.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],p=Array.from(this.g.keys());for(var g=0;g<p.length;g++){var A=p[g];let L=encodeURIComponent(String(A)),H=this.V(A);for(A=0;A<H.length;A++){var k=L;H[A]!==""&&(k+="="+encodeURIComponent(String(H[A]))),u.push(k)}}return this.i=u.join("&")};function zn(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function Xa(u,p){p&&!u.j&&(pr(u),u.i=null,u.g.forEach(function(g,A){var k=A.toLowerCase();A!=k&&(Pf(this,A),xf(this,k,g))},u)),u.j=p}function kf(u,p){let g=new Ui;if(a.Image){let A=new Image;A.onload=w(sn,g,"TestLoadImage: loaded",!0,p,A),A.onerror=w(sn,g,"TestLoadImage: error",!1,p,A),A.onabort=w(sn,g,"TestLoadImage: abort",!1,p,A),A.ontimeout=w(sn,g,"TestLoadImage: timeout",!1,p,A),a.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=u}else p(!1)}function lo(u,p){let g=new Ui,A=new AbortController,k=setTimeout(()=>{A.abort(),sn(g,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:A.signal}).then(L=>{clearTimeout(k),L.ok?sn(g,"TestPingServer: ok",!0,p):sn(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(k),sn(g,"TestPingServer: error",!1,p)})}function sn(u,p,g,A,k){try{k&&(k.onload=null,k.onerror=null,k.onabort=null,k.ontimeout=null),A(g)}catch{}}function Mf(){this.g=new If}function Pl(u,p,g){let A=g||"";try{je(u,function(k,L){let H=k;d(k)&&(H=Xs(k)),p.push(A+L+"="+encodeURIComponent(H))})}catch(k){throw p.push(A+"type="+encodeURIComponent("_badmap")),k}}function Be(u){this.l=u.Ub||null,this.j=u.eb||!1}R(Be,Mi),Be.prototype.g=function(){return new Za(this.l,this.j)},Be.prototype.i=(function(u){return function(){return u}})({});function Za(u,p){Dt.call(this),this.D=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(Za,Dt),n=Za.prototype,n.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=p,this.readyState=1,Ki(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(p.body=u),(this.D||a).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Wi(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Ki(this)),this.g&&(this.readyState=3,Ki(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Of(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Of(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?Wi(this):Ki(this),this.readyState==3&&Of(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Wi(this))},n.Qa=function(u){this.g&&(this.response=u,Wi(this))},n.ga=function(){this.g&&Wi(this)};function Wi(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Ki(u)}n.setRequestHeader=function(u,p){this.u.append(u,p)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,u.push(g[0]+": "+g[1]),g=p.next();return u.join(`\r
`)};function Ki(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Za.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function xl(u){let p="";return Z(u,function(g,A){p+=A,p+=":",p+=g,p+=`\r
`}),p}function Qi(u,p,g){e:{for(A in g){var A=!1;break e}A=!0}A||(g=xl(g),typeof u=="string"?g!=null&&encodeURIComponent(String(g)):He(u,p,g))}function xe(u){Dt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(xe,Dt);var Vf=/^https?$/i,O_=["POST","PUT"];n=xe.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,p,g,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():no.g(),this.v=this.o?El(this.o):El(no),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch(L){Yi(this,L);return}if(u=g||"",g=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var k in A)g.set(k,A[k]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(let L of A.keys())g.set(L,A.get(L));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(g.keys()).find(L=>L.toLowerCase()=="content-type"),k=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(O_,p,void 0))||A||k||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[L,H]of g)this.g.setRequestHeader(L,H);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ml(this),this.u=!0,this.g.send(u),this.u=!1}catch(L){Yi(this,L)}};function Yi(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.m=5,kl(u),Gr(u)}function kl(u){u.A||(u.A=!0,Pt(u,"complete"),Pt(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Pt(this,"complete"),Pt(this,"abort"),Gr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Gr(this,!0)),xe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?ec(this):this.bb())},n.bb=function(){ec(this)};function ec(u){if(u.h&&typeof o<"u"&&(!u.v[1]||on(u)!=4||u.Z()!=2)){if(u.u&&on(u)==4)yf(u.Ea,0,u);else if(Pt(u,"readystatechange"),on(u)==4){u.h=!1;try{let H=u.Z();e:switch(H){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var A;if(A=H===0){var k=String(u.D).match(oo)[1]||null;!k&&a.self&&a.self.location&&(k=a.self.location.protocol.slice(0,-1)),A=!Vf.test(k?k.toLowerCase():"")}g=A}if(g)Pt(u,"complete"),Pt(u,"success");else{u.m=6;try{var L=2<on(u)?u.g.statusText:""}catch{L=""}u.l=L+" ["+u.Z()+"]",kl(u)}}finally{Gr(u)}}}}function Gr(u,p){if(u.g){Ml(u);let g=u.g,A=u.v[0]?()=>{}:null;u.g=null,u.v=null,p||Pt(u,"ready");try{g.onreadystatechange=A}catch{}}}function Ml(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function on(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<on(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),Hr(p)}};function Lf(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Ff(u){let p={};u=(u.g&&2<=on(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<u.length;A++){if(q(u[A]))continue;var g=b(u[A]);let k=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();let L=p[k]||[];p[k]=L,L.push(g)}T(p,function(A){return A.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Gn(u,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[u]||p}function Ol(u){this.Aa=0,this.i=[],this.j=new Ui,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Gn("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Gn("baseRetryDelayMs",5e3,u),this.cb=Gn("retryDelaySeedMs",1e4,u),this.Wa=Gn("forwardChannelMaxRetries",2,u),this.wa=Gn("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Sl(u&&u.concurrentRequestLimit),this.Da=new Mf,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Ol.prototype,n.la=8,n.G=1,n.connect=function(u,p,g,A){Ot(0),this.W=u,this.H=p||{},g&&A!==void 0&&(this.H.OSID=g,this.H.OAID=A),this.F=this.X,this.I=l(this,null,this.W),ho(this)};function tc(u){if(nc(u),u.G==3){var p=u.U++,g=$n(u.I);if(He(g,"SID",u.K),He(g,"RID",p),He(g,"TYPE","terminate"),Xi(u,g),p=new hr(u,u.j,p),p.L=2,p.v=Ja($n(g)),g=!1,a.navigator&&a.navigator.sendBeacon)try{g=a.navigator.sendBeacon(p.v.toString(),"")}catch{}!g&&a.Image&&(new Image().src=p.v,g=!0),g||(p.g=m(p.j,null),p.g.ea(p.v)),p.F=Date.now(),qi(p)}Kr(u)}function Ji(u){u.g&&(sc(u),u.g.cancel(),u.g=null)}function nc(u){Ji(u),u.u&&(a.clearTimeout(u.u),u.u=null),Wr(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function ho(u){if(!Al(u.h)&&!u.s){u.s=!0;var p=u.Ga;Ks||ff(),lr||(Ks(),lr=!0),Ni.add(p,u),u.B=0}}function rc(u,p){return Cl(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=p.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Fi(y(u.Ga,u,p),Ul(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let k=new hr(this,this.j,u),L=this.o;if(this.S&&(L?(L=v(L),S(L,this.S)):L=this.S),this.m!==null||this.O||(k.H=L,L=null),this.P)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var A=this.i[g];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(p+=A,4096<p){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=mr(this,k,p),g=$n(this.I),He(g,"RID",u),He(g,"CVER",22),this.D&&He(g,"X-HTTP-Session-Id",this.D),Xi(this,g),L&&(this.O?p="headers="+encodeURIComponent(String(xl(L)))+"&"+p:this.m&&Qi(g,this.m,L)),xn(this.h,k),this.Ua&&He(g,"TYPE","init"),this.P?(He(g,"$req",p),He(g,"SID","null"),k.T=!0,Wa(k,g,null)):Wa(k,g,p),this.G=2}}else this.G==3&&(u?Vl(this,u):this.i.length==0||Al(this.h)||Vl(this))};function Vl(u,p){var g;p?g=p.l:g=u.U++;let A=$n(u.I);He(A,"SID",u.K),He(A,"RID",g),He(A,"AID",u.T),Xi(u,A),u.m&&u.o&&Qi(A,u.m,u.o),g=new hr(u,u.j,g,u.B+1),u.m===null&&(g.H=u.o),p&&(u.i=p.D.concat(u.i)),p=mr(u,g,1e3),g.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),xn(u.h,g),Wa(g,A,p)}function Xi(u,p){u.H&&Z(u.H,function(g,A){He(p,A,g)}),u.l&&je({},function(g,A){He(p,A,g)})}function mr(u,p,g){g=Math.min(u.i.length,g);var A=u.l?y(u.l.Na,u.l,u):null;e:{var k=u.i;let L=-1;for(;;){let H=["count="+g];L==-1?0<g?(L=k[0].g,H.push("ofs="+L)):L=0:H.push("ofs="+L);let Ne=!0;for(let it=0;it<g;it++){let Pe=k[it].g,Bt=k[it].map;if(Pe-=L,0>Pe)L=Math.max(0,k[it].g-100),Ne=!1;else try{Pl(Bt,H,"req"+Pe+"_")}catch{A&&A(Bt)}}if(Ne){A=H.join("&");break e}}}return u=u.i.splice(0,g),p.D=u,A}function Ll(u){if(!u.g&&!u.u){u.Y=1;var p=u.Fa;Ks||ff(),lr||(Ks(),lr=!0),Ni.add(p,u),u.v=0}}function ic(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Fi(y(u.Fa,u),Ul(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,Fl(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Fi(y(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ot(10),Ji(this),Fl(this))};function sc(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function Fl(u){u.g=new hr(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var p=$n(u.qa);He(p,"RID","rpc"),He(p,"SID",u.K),He(p,"AID",u.T),He(p,"CI",u.F?"0":"1"),!u.F&&u.ja&&He(p,"TO",u.ja),He(p,"TYPE","xmlhttp"),Xi(u,p),u.m&&u.o&&Qi(p,u.m,u.o),u.L&&(u.g.I=u.L);var g=u.g;u=u.ia,g.L=1,g.v=Ja($n(p)),g.m=null,g.P=!0,Ka(g,u)}n.Za=function(){this.C!=null&&(this.C=null,Ji(this),ic(this),Ot(19))};function Wr(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function jt(u,p){var g=null;if(u.g==p){Wr(u),sc(u),u.g=null;var A=2}else if(Dl(u.h,p))g=p.D,gn(u.h,p),A=1;else return;if(u.G!=0){if(p.o)if(A==1){g=p.m?p.m.length:0,p=Date.now()-p.F;var k=u.B;A=za(),Pt(A,new Zs(A,g)),ho(u)}else Ll(u);else if(k=p.s,k==3||k==0&&0<p.X||!(A==1&&rc(u,p)||A==2&&ic(u)))switch(g&&0<g.length&&(p=u.h,p.i=p.i.concat(g)),k){case 1:gr(u,5);break;case 4:gr(u,10);break;case 3:gr(u,6);break;default:gr(u,2)}}}function Ul(u,p){let g=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(g*=2),g*p}function gr(u,p){if(u.j.info("Error code "+p),p==2){var g=y(u.fb,u),A=u.Xa;let k=!A;A=new yn(A||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||co(A,"https"),Ja(A),k?kf(A.toString(),g):lo(A.toString(),g)}else Ot(2);u.G=0,u.l&&u.l.sa(p),Kr(u),nc(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Ot(2)):(this.j.info("Failed to ping google.com"),Ot(1))};function Kr(u){if(u.G=0,u.ka=[],u.l){let p=zi(u.h);(p.length!=0||u.i.length!=0)&&(P(u.ka,p),P(u.ka,u.i),u.h.i.length=0,N(u.i),u.i.length=0),u.l.ra()}}function l(u,p,g){var A=g instanceof yn?$n(g):new yn(g);if(A.g!="")p&&(A.g=p+"."+A.g),Ya(A,A.s);else{var k=a.location;A=k.protocol,p=p?p+"."+k.hostname:k.hostname,k=+k.port;var L=new yn(null);A&&co(L,A),p&&(L.g=p),k&&Ya(L,k),g&&(L.l=g),A=L}return g=u.D,p=u.ya,g&&p&&He(A,g,p),He(A,"VER",u.la),Xi(u,A),A}function m(u,p,g){if(p&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Ca&&!u.pa?new xe(new Be({eb:g})):new xe(u.pa),p.Ha(u.J),p}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function _(){}n=_.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function C(){}C.prototype.g=function(u,p){return new x(u,p)};function x(u,p){Dt.call(this),this.g=new Ol(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(u?u["X-WebChannel-Client-Profile"]=p.va:u={"X-WebChannel-Client-Profile":p.va}),this.g.S=u,(u=p&&p.Sb)&&!q(u)&&(this.g.m=u),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!q(p)&&(this.g.D=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new ae(this)}R(x,Dt),x.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},x.prototype.close=function(){tc(this.g)},x.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var g={};g.__data__=u,u=g}else this.u&&(g={},g.__data__=Xs(u),u=g);p.i.push(new bl(p.Ya++,u)),p.G==3&&ho(p)},x.prototype.N=function(){this.g.l=null,delete this.j,tc(this.g),delete this.g,x.aa.N.call(this)};function V(u){Rt.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){e:{for(let g in p){u=g;break e}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}R(V,Rt);function z(){Ha.call(this),this.status=1}R(z,Ha);function ae(u){this.g=u}R(ae,_),ae.prototype.ua=function(){Pt(this.g,"a")},ae.prototype.ta=function(u){Pt(this.g,new V(u))},ae.prototype.sa=function(u){Pt(this.g,new z)},ae.prototype.ra=function(){Pt(this.g,"b")},C.prototype.createWebChannel=C.prototype.g,x.prototype.send=x.prototype.o,x.prototype.open=x.prototype.m,x.prototype.close=x.prototype.close,Kb=_i.createWebChannelTransport=function(){return new C},Wb=_i.getStatEventTarget=function(){return za()},Gb=_i.Event=mn,Yg=_i.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},to.NO_ERROR=0,to.TIMEOUT=8,to.HTTP_ERROR=6,lh=_i.ErrorCode=to,Ga.COMPLETE="complete",zb=_i.EventType=Ga,Oi.EventType=Vi,Vi.OPEN="a",Vi.CLOSE="b",Vi.ERROR="c",Vi.MESSAGE="d",Dt.prototype.listen=Dt.prototype.K,bu=_i.WebChannel=Oi,v5=_i.FetchXmlHttpFactory=Be,xe.prototype.listenOnce=xe.prototype.L,xe.prototype.getLastError=xe.prototype.Ka,xe.prototype.getLastErrorCode=xe.prototype.Ba,xe.prototype.getStatus=xe.prototype.Z,xe.prototype.getResponseJson=xe.prototype.Oa,xe.prototype.getResponseText=xe.prototype.oa,xe.prototype.send=xe.prototype.ea,xe.prototype.setWithCredentials=xe.prototype.Ha,Hb=_i.XhrIo=xe}).apply(typeof Qg<"u"?Qg:typeof self<"u"?self:typeof window<"u"?window:{});var fM="@firebase/firestore",pM="4.8.0";var It=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};It.UNAUTHENTICATED=new It(null),It.GOOGLE_CREDENTIALS=new It("google-credentials-uid"),It.FIRST_PARTY=new It("first-party-uid"),It.MOCK_USER=new It("mock-user");var ul="11.10.0";var xs=new Ar("@firebase/firestore");function Pu(){return xs.logLevel}function PO(n){xs.setLogLevel(n)}function j(n,...e){if(xs.logLevel<=ve.DEBUG){let t=e.map(dC);xs.debug(`Firestore (${ul}): ${n}`,...t)}}function ut(n,...e){if(xs.logLevel<=ve.ERROR){let t=e.map(dC);xs.error(`Firestore (${ul}): ${n}`,...t)}}function nn(n,...e){if(xs.logLevel<=ve.WARN){let t=e.map(dC);xs.warn(`Firestore (${ul}): ${n}`,...t)}}function dC(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Y(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,xO(n,r,t)}function xO(n,e,t){let r=`FIRESTORE (${ul}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw ut(r),new Error(r)}function X(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||xO(e,i,r)}function Ode(n,e){n||Y(57014,e)}function G(n,e){return n}var M={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},U=class extends Ln{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var wt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var dy=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},nS=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(It.UNAUTHENTICATED))}shutdown(){}},rS=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},iS=class{constructor(e){this.t=e,this.currentUser=It.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){X(this.o===void 0,42304);let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new wt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new wt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},a=c=>{j("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(j("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new wt)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(j("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(X(typeof r.accessToken=="string",31837,{l:r}),new dy(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return X(e===null||typeof e=="string",2055,{h:e}),new It(e)}},sS=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=It.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},oS=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new sS(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(It.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Sh=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},aS=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ai(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){X(this.o===void 0,3512);let r=s=>{s.error!=null&&j("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.m;return this.m=s.token,j("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{j("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.V.getImmediate({optional:!0});s?i(s):j("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Sh(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(X(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Sh(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}},mM=class{getToken(){return Promise.resolve(new Sh(""))}invalidateToken(){}start(e,t){}shutdown(){}};function I5(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function hC(){return new TextEncoder}var Ah=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=I5(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}};function re(n,e){return n<e?-1:n>e?1:0}function cS(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return re(r,i);{let s=hC(),o=E5(s.encode(gM(n,t)),s.encode(gM(e,t)));return o!==0?o:re(r,i)}}t+=r>65535?2:1}return re(n.length,e.length)}function gM(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function E5(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return re(n[t],e[t]);return re(n.length,e.length)}function ju(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function kO(n){return n+"\0"}var uS="__name__",hy=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&Y(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Y(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return re(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):cS(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return yi.fromString(e.substring(4,e.length-2))}},we=class n extends hy{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new U(M.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},w5=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Tt=class n extends hy{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return w5.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===uS}static keyField(){return new n([uS])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new U(M.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new U(M.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new U(M.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new U(M.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var W=class n{constructor(e){this.path=e}static fromPath(e){return new n(we.fromString(e))}static fromName(e){return new n(we.fromString(e).popFirst(5))}static empty(){return new n(we.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&we.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return we.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new we(e.slice()))}};function fC(n,e,t){if(!t)throw new U(M.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function T5(n,e,t,r){if(e===!0&&r===!0)throw new U(M.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function yM(n){if(!W.isDocumentKey(n))throw new U(M.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function _M(n){if(W.isDocumentKey(n))throw new U(M.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function MO(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function p_(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Y(12329,{type:typeof n})}function Ie(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new U(M.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=p_(n);throw new U(M.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function OO(n,e){if(e<=0)throw new U(M.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Et(n,e){let t={typeString:n};return e&&(t.value=e),t}function Pa(n,e){if(!MO(n))throw new U(M.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new U(M.INVALID_ARGUMENT,t);return!0}var vM=-62135596800,IM=1e6,Ze=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*IM);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new U(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new U(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<vM)throw new U(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new U(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/IM}_compareTo(e){return this.seconds===e.seconds?re(this.nanoseconds,e.nanoseconds):re(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Pa(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-vM;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};Ze._jsonSchemaVersion="firestore/timestamp/1.0",Ze._jsonSchema={type:Et("string",Ze._jsonSchemaVersion),seconds:Et("number"),nanoseconds:Et("number")};var te=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Ze(0,0))}static max(){return new n(new Ze(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Bu=-1,ks=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function lS(n){return n.fields.find(e=>e.kind===2)}function ua(n){return n.fields.filter(e=>e.kind!==2)}function b5(n,e){let t=re(n.collectionGroup,e.collectionGroup);if(t!==0)return t;for(let r=0;r<Math.min(n.fields.length,e.fields.length);++r)if(t=S5(n.fields[r],e.fields[r]),t!==0)return t;return re(n.fields.length,e.fields.length)}ks.UNKNOWN_ID=-1;var Ii=class{constructor(e,t){this.fieldPath=e,this.kind=t}};function S5(n,e){let t=Tt.comparator(n.fieldPath,e.fieldPath);return t!==0?t:re(n.kind,e.kind)}var $u=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,jn.min())}};function VO(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=te.fromTimestamp(r===1e9?new Ze(t+1,0):new Ze(t,r));return new jn(i,W.empty(),e)}function LO(n){return new jn(n.readTime,n.key,Bu)}var jn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(te.min(),W.empty(),Bu)}static max(){return new n(te.max(),W.empty(),Bu)}};function pC(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=W.comparator(n.documentKey,e.documentKey),t!==0?t:re(n.largestBatchId,e.largestBatchId))}var FO="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",fy=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function qs(n){if(n.code!==M.FAILED_PRECONDITION||n.message!==FO)throw n;j("LocalStore","Unexpectedly lost primary lease")}var O=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Y(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let d=c;t(e[d]).next(h=>{o[d]=h,++a,a===s&&r(o)},h=>i(h))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};var An="SimpleDb",py=class n{static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(s){throw new ya(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new wt,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new ya(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{let i=mC(r.target.error);this.S.reject(new ya(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(j(An,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new hS(t)}},Ms=class n{static delete(e){return j(An,"Removing database:",e),da(Am().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!jc())return!1;if(n.F())return!0;let e=Gt(),t=n.M(e),r=0<t&&t<10,i=UO(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,t){return e.store(t)}static M(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.B=r,this.L=null,n.M(Gt())===12.2&&ut("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(j(An,"Opening database:",this.name),this.db=await new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new ya(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new U(M.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new U(M.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new ya(e,o))},i.onupgradeneeded=s=>{j(An,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;if(this.L!==null&&this.L!==s.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${s.oldVersion}, event.newVersion=${s.newVersion}, db.version=${o.version}`);this.B.q(o,i.transaction,s.oldVersion,this.version).next(()=>{j(An,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",t=>{let r=t.target;this.L=r.version},{passive:!0})),this.db.addEventListener("versionchange",t=>{var r;t.newVersion===null&&(nn('Received "versionchange" event with newVersion===null; notifying the registered DatabaseDeletedListener, if any'),(r=this.databaseDeletedListener)===null||r===void 0||r.call(this))},{passive:!0}),this.db}setDatabaseDeletedListener(e){if(this.databaseDeletedListener)throw new Error("setDatabaseDeletedListener() may only be called once, and it has already been called");this.databaseDeletedListener=e}async runTransaction(e,t,r,i){let s=t==="readonly",o=0;for(;;){++o;try{this.db=await this.k(e);let a=py.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(d=>(a.v(),d)).catch(d=>(a.abort(d),O.reject(d))).toPromise();return c.catch(()=>{}),await a.D,c}catch(a){let c=a,d=c.name!=="FirebaseError"&&o<3;if(j(An,"Transaction failed with error:",c.message,"Retrying:",d),this.close(),!d)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}};function UO(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var dS=class{constructor(e){this.$=e,this.U=!1,this.K=null}get isDone(){return this.U}get W(){return this.K}set cursor(e){this.$=e}done(){this.U=!0}G(e){this.K=e}delete(){return da(this.$.delete())}},ya=class extends U{constructor(e,t){super(M.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Hs(n){return n.name==="IndexedDbTransactionError"}var hS=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(j(An,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(j(An,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),da(r)}add(e){return j(An,"ADD",this.store.name,e,e),da(this.store.add(e))}get(e){return da(this.store.get(e)).next(t=>(t===void 0&&(t=null),j(An,"GET",this.store.name,e,t),t))}delete(e){return j(An,"DELETE",this.store.name,e),da(this.store.delete(e))}count(){return j(An,"COUNT",this.store.name),da(this.store.count())}j(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new O((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.J(s,(a,c)=>{o.push(c)}).next(()=>o)}}H(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new O((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}Y(e,t){j(An,"DELETE ALL",this.store.name);let r=this.options(e,t);r.Z=!1;let i=this.cursor(r);return this.J(i,(s,o,a)=>a.delete())}X(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.J(i,t)}ee(e){let t=this.cursor({});return new O((r,i)=>{t.onerror=s=>{let o=mC(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}J(e,t){let r=[];return new O((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new dS(a),d=t(a.primaryKey,a.value,c);if(d instanceof O){let h=d.catch(f=>(c.done(),O.reject(f)));r.push(h)}c.isDone?i():c.W===null?a.continue():a.continue(c.W)}}).next(()=>O.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.Z?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function da(n){return new O((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=mC(r.target.error);t(i)}})}var EM=!1;function mC(n){let e=Ms.M(Gt());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new U("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return EM||(EM=!0,setTimeout(()=>{throw r},0)),r}}return n}var yh="IndexBackfiller",fS=class{constructor(e,t){this.asyncQueue=e,this.te=t,this.task=null}start(){this.ne(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ne(e){j(yh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{let t=await this.te.re();j(yh,`Documents written: ${t}`)}catch(t){Hs(t)?j(yh,"Ignoring IndexedDB error during index backfill: ",t):await qs(t)}await this.ne(6e4)})}},pS=class{constructor(e,t){this.localStore=e,this.persistence=t}async re(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.ie(t,e))}ie(e,t){let r=new Set,i=t,s=!0;return O.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return j(yh,`Processing collection: ${o}`),this.se(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}se(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.oe(i,s)).next(a=>(j(yh,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}oe(e,t){let r=e;return t.changes.forEach((i,s)=>{let o=LO(s);pC(o,r)>0&&(r=o)}),new jn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Cn=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this._e(i),this.ae=i=>r.writeSequenceNumber(i))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ae&&this.ae(t),t}}n.ue=-1;return n})(),Ns=-1;function sf(n){return n==null}function Ch(n){return n===0&&1/n==-1/0}function jO(n){return typeof n=="number"&&Number.isInteger(n)&&!Ch(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var my="";function Xt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=wM(e)),e=A5(n.get(t),e);return wM(e)}function A5(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case my:t+="";break;default:t+=s}}return t}function wM(n){return n+my+""}function xr(n){let e=n.length;if(X(e>=2,64408,{path:n}),e===2)return X(n.charAt(0)===my&&n.charAt(1)==="",56145,{path:n}),we.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf(my,s);switch((o<0||o>t)&&Y(50515,{path:n}),n.charAt(o+1)){case"":let a=n.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:Y(61167,{path:n})}s=o+2}return new we(r)}var la="remoteDocuments",of="owner",Su="owner",Dh="mutationQueues",C5="userId",or="mutations",TM="batchId",ma="userMutationsIndex",bM=["userId","batchId"];function ry(n,e){return[n,Xt(e)]}function BO(n,e,t){return[n,Xt(e),t]}var D5={},qu="documentMutations",gy="remoteDocumentsV14",R5=["prefixPath","collectionGroup","readTime","documentId"],iy="documentKeyIndex",N5=["prefixPath","collectionGroup","documentId"],$O="collectionGroupIndex",P5=["collectionGroup","readTime","prefixPath","documentId"],Rh="remoteDocumentGlobal",mS="remoteDocumentGlobalKey",Hu="targets",qO="queryTargetsIndex",x5=["canonicalId","targetId"],zu="targetDocuments",k5=["targetId","path"],gC="documentTargetsIndex",M5=["path","targetId"],yy="targetGlobalKey",_a="targetGlobal",Nh="collectionParents",O5=["collectionId","parent"],Gu="clientMetadata",V5="clientId",m_="bundles",L5="bundleId",g_="namedQueries",F5="name",yC="indexConfiguration",U5="indexId",gS="collectionGroupIndex",j5="collectionGroup",_h="indexState",B5=["indexId","uid"],HO="sequenceNumberIndex",$5=["uid","sequenceNumber"],vh="indexEntries",q5=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],zO="documentKeyIndex",H5=["indexId","uid","orderedDocumentKey"],y_="documentOverlays",z5=["userId","collectionPath","documentId"],yS="collectionPathOverlayIndex",G5=["userId","collectionPath","largestBatchId"],GO="collectionGroupOverlayIndex",W5=["userId","collectionGroup","largestBatchId"],_C="globals",K5="name",WO=[Dh,or,qu,la,Hu,of,_a,zu,Gu,Rh,Nh,m_,g_],Q5=[...WO,y_],KO=[Dh,or,qu,gy,Hu,of,_a,zu,Gu,Rh,Nh,m_,g_,y_],QO=KO,vC=[...QO,yC,_h,vh],Y5=vC,YO=[...vC,_C],J5=YO;var Ph=class extends fy{constructor(e,t){super(),this.ce=e,this.currentSequenceNumber=t}};function Nt(n,e){let t=G(n);return Ms.N(t.ce,e)}function SM(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function zs(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function JO(n,e){let t=[];for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function XO(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var We=class n{constructor(e,t){this.comparator=e,this.root=t||Or.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Or.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Or.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ou(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ou(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ou(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ou(this.root,e,this.comparator,!0)}},Ou=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Or=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Y(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Y(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw Y(27949);return e+(this.isRed()?0:1)}};Or.EMPTY=null,Or.RED=!0,Or.BLACK=!1;Or.EMPTY=new class{constructor(){this.size=0}get key(){throw Y(57766)}get value(){throw Y(16141)}get color(){throw Y(16727)}get left(){throw Y(29726)}get right(){throw Y(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new Or(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var qe=class n{constructor(e){this.comparator=e,this.data=new We(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new _y(this.data.getIterator())}getIteratorFrom(e){return new _y(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},_y=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Au(n){return n.hasNext()?n.getNext():void 0}var Dn=class n{constructor(e){this.fields=e,e.sort(Tt.comparator)}static empty(){return new n([])}unionWith(e){let t=new qe(Tt.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ju(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var vy=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function Lde(){return typeof atob<"u"}var dt=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new vy("Invalid base64 string: "+s):s}})(e);return new n(t)}static fromUint8Array(e){let t=(function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return re(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};dt.EMPTY_BYTE_STRING=new dt("");var X5=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ti(n){if(X(!!n,39018),typeof n=="string"){let e=0,t=X5.exec(n);if(X(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Xe(n.seconds),nanos:Xe(n.nanos)}}function Xe(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function bi(n){return typeof n=="string"?dt.fromBase64String(n):dt.fromUint8Array(n)}var ZO="server_timestamp",eV="__type__",tV="__previous_value__",nV="__local_write_time__";function __(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[eV])===null||t===void 0?void 0:t.stringValue)===ZO}function v_(n){let e=n.mapValue.fields[tV];return __(e)?v_(e):e}function xh(n){let e=Ti(n.mapValue.fields[nV].timestampValue);return new Ze(e.seconds,e.nanos)}var _S=class{constructor(e,t,r,i,s,o,a,c,d,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=d,this.isUsingEmulator=h}},kh="(default)",Wu=class n{constructor(e,t){this.projectId=e,this.database=t||kh}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===kh}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var IC="__type__",rV="__max__",Ds={mapValue:{fields:{__type__:{stringValue:rV}}}},EC="__vector__",Ku="value",sy={nullValue:"NULL_VALUE"};function Os(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?__(n)?4:iV(n)?9007199254740991:I_(n)?10:11:Y(28295,{value:n})}function Fr(n,e){if(n===e)return!0;let t=Os(n);if(t!==Os(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return xh(n).isEqual(xh(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Ti(i.timestampValue),a=Ti(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return bi(i.bytesValue).isEqual(bi(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return Xe(i.geoPointValue.latitude)===Xe(s.geoPointValue.latitude)&&Xe(i.geoPointValue.longitude)===Xe(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return Xe(i.integerValue)===Xe(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Xe(i.doubleValue),a=Xe(s.doubleValue);return o===a?Ch(o)===Ch(a):isNaN(o)&&isNaN(a)}return!1})(n,e);case 9:return ju(n.arrayValue.values||[],e.arrayValue.values||[],Fr);case 10:case 11:return(function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(SM(o)!==SM(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Fr(o[c],a[c])))return!1;return!0})(n,e);default:return Y(52216,{left:n})}}function Mh(n,e){return(n.values||[]).find(t=>Fr(t,e))!==void 0}function Vs(n,e){if(n===e)return 0;let t=Os(n),r=Os(e);if(t!==r)return re(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return re(n.booleanValue,e.booleanValue);case 2:return(function(s,o){let a=Xe(s.integerValue||s.doubleValue),c=Xe(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1})(n,e);case 3:return AM(n.timestampValue,e.timestampValue);case 4:return AM(xh(n),xh(e));case 5:return cS(n.stringValue,e.stringValue);case 6:return(function(s,o){let a=bi(s),c=bi(o);return a.compareTo(c)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){let a=s.split("/"),c=o.split("/");for(let d=0;d<a.length&&d<c.length;d++){let h=re(a[d],c[d]);if(h!==0)return h}return re(a.length,c.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){let a=re(Xe(s.latitude),Xe(o.latitude));return a!==0?a:re(Xe(s.longitude),Xe(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return CM(n.arrayValue,e.arrayValue);case 10:return(function(s,o){var a,c,d,h;let f=s.fields||{},y=o.fields||{},w=(a=f[Ku])===null||a===void 0?void 0:a.arrayValue,R=(c=y[Ku])===null||c===void 0?void 0:c.arrayValue,N=re(((d=w?.values)===null||d===void 0?void 0:d.length)||0,((h=R?.values)===null||h===void 0?void 0:h.length)||0);return N!==0?N:CM(w,R)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===Ds.mapValue&&o===Ds.mapValue)return 0;if(s===Ds.mapValue)return 1;if(o===Ds.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),d=o.fields||{},h=Object.keys(d);c.sort(),h.sort();for(let f=0;f<c.length&&f<h.length;++f){let y=cS(c[f],h[f]);if(y!==0)return y;let w=Vs(a[c[f]],d[h[f]]);if(w!==0)return w}return re(c.length,h.length)})(n.mapValue,e.mapValue);default:throw Y(23264,{le:t})}}function AM(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return re(n,e);let t=Ti(n),r=Ti(e),i=re(t.seconds,r.seconds);return i!==0?i:re(t.nanos,r.nanos)}function CM(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=Vs(t[i],r[i]);if(s)return s}return re(t.length,r.length)}function Qu(n){return vS(n)}function vS(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let r=Ti(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return bi(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return W.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=vS(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${vS(t.fields[o])}`;return i+"}"})(n.mapValue):Y(61005,{value:n})}function oy(n){switch(Os(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=v_(n);return e?16+oy(e):16;case 5:return 2*n.stringValue.length;case 6:return bi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce((i,s)=>i+oy(s),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return zs(r.fields,(s,o)=>{i+=s.length+oy(o)}),i})(n.mapValue);default:throw Y(13486,{value:n})}}function va(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function IS(n){return!!n&&"integerValue"in n}function Oh(n){return!!n&&"arrayValue"in n}function DM(n){return!!n&&"nullValue"in n}function RM(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ay(n){return!!n&&"mapValue"in n}function I_(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[IC])===null||t===void 0?void 0:t.stringValue)===EC}function Ih(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return zs(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Ih(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ih(n.arrayValue.values[t]);return e}return Object.assign({},n)}function iV(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===rV}var sV={mapValue:{fields:{[IC]:{stringValue:EC},[Ku]:{arrayValue:{}}}}};function Z5(n){return"nullValue"in n?sy:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?va(Wu.empty(),W.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?I_(n)?sV:{mapValue:{}}:Y(35942,{value:n})}function eG(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?va(Wu.empty(),W.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?sV:"mapValue"in n?I_(n)?{mapValue:{}}:Ds:Y(61959,{value:n})}function NM(n,e){let t=Vs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function PM(n,e){let t=Vs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var Jt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ay(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ih(t)}setAll(e){let t=Tt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=Ih(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());ay(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Fr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];ay(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){zs(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(Ih(this.value))}};function oV(n){let e=[];return zs(n.fields,(t,r)=>{let i=new Tt([t]);if(ay(r)){let s=oV(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Dn(e)}var bt=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,te.min(),te.min(),te.min(),Jt.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,te.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,te.min(),te.min(),Jt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,te.min(),te.min(),Jt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(te.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Jt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Jt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Ur=class{constructor(e,t){this.position=e,this.inclusive=t}};function xM(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=W.comparator(W.fromName(o.referenceValue),t.key):r=Vs(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function kM(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Fr(n.position[t],e.position[t]))return!1;return!0}var Ia=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function tG(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Iy=class{},Te=class n extends Iy{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new TS(e,t,r):t==="array-contains"?new AS(e,r):t==="in"?new Ey(e,r):t==="not-in"?new CS(e,r):t==="array-contains-any"?new DS(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new bS(e,r):new SS(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Vs(t,this.value)):t!==null&&Os(this.value)===Os(t)&&this.matchesComparison(Vs(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Y(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Fe=class n extends Iy{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new n(e,t)}matches(e){return Yu(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}};function Yu(n){return n.op==="and"}function ES(n){return n.op==="or"}function wC(n){return aV(n)&&Yu(n)}function aV(n){for(let e of n.filters)if(e instanceof Fe)return!1;return!0}function wS(n){if(n instanceof Te)return n.field.canonicalString()+n.op.toString()+Qu(n.value);if(wC(n))return n.filters.map(e=>wS(e)).join(",");{let e=n.filters.map(t=>wS(t)).join(",");return`${n.op}(${e})`}}function cV(n,e){return n instanceof Te?(function(r,i){return i instanceof Te&&r.op===i.op&&r.field.isEqual(i.field)&&Fr(r.value,i.value)})(n,e):n instanceof Fe?(function(r,i){return i instanceof Fe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&cV(o,i.filters[a]),!0):!1})(n,e):void Y(19439)}function uV(n,e){let t=n.filters.concat(e);return Fe.create(t,n.op)}function lV(n){return n instanceof Te?(function(t){return`${t.field.canonicalString()} ${t.op} ${Qu(t.value)}`})(n):n instanceof Fe?(function(t){return t.op.toString()+" {"+t.getFilters().map(lV).join(" ,")+"}"})(n):"Filter"}var TS=class extends Te{constructor(e,t,r){super(e,t,r),this.key=W.fromName(r.referenceValue)}matches(e){let t=W.comparator(e.key,this.key);return this.matchesComparison(t)}},bS=class extends Te{constructor(e,t){super(e,"in",t),this.keys=dV("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},SS=class extends Te{constructor(e,t){super(e,"not-in",t),this.keys=dV("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function dV(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>W.fromName(r.referenceValue))}var AS=class extends Te{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Oh(t)&&Mh(t.arrayValue,this.value)}},Ey=class extends Te{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Mh(this.value.arrayValue,t)}},CS=class extends Te{constructor(e,t){super(e,"not-in",t)}matches(e){if(Mh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Mh(this.value.arrayValue,t)}},DS=class extends Te{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Oh(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Mh(this.value.arrayValue,r))}};var RS=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Pe=null}};function NS(n,e=null,t=[],r=[],i=null,s=null,o=null){return new RS(n,e,t,r,i,s,o)}function Ea(n){let e=G(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>wS(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>(function(s){return s.field.canonicalString()+s.dir})(r)).join(","),sf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Qu(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Qu(r)).join(",")),e.Pe=t}return e.Pe}function af(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!tG(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!cV(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!kM(n.startAt,e.startAt)&&kM(n.endAt,e.endAt)}function wy(n){return W.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Ty(n,e){return n.filters.filter(t=>t instanceof Te&&t.field.isEqual(e))}function MM(n,e,t){let r=sy,i=!0;for(let s of Ty(n,e)){let o=sy,a=!0;switch(s.op){case"<":case"<=":o=Z5(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=sy}NM({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];NM({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function OM(n,e,t){let r=Ds,i=!0;for(let s of Ty(n,e)){let o=Ds,a=!0;switch(s.op){case">=":case">":o=eG(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Ds}PM({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];PM({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}var ar=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}};function hV(n,e,t,r,i,s,o,a){return new ar(n,e,t,r,i,s,o,a)}function ll(n){return new ar(n)}function VM(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function TC(n){return n.collectionGroup!==null}function Vu(n){let e=G(n);if(e.Te===null){e.Te=[];let t=new Set;for(let s of e.explicitOrderBy)e.Te.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new qe(Tt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Te.push(new Ia(s,r))}),t.has(Tt.keyField().canonicalString())||e.Te.push(new Ia(Tt.keyField(),r))}return e.Te}function Zt(n){let e=G(n);return e.Ie||(e.Ie=pV(e,Vu(n))),e.Ie}function fV(n){let e=G(n);return e.de||(e.de=pV(e,n.explicitOrderBy)),e.de}function pV(n,e){if(n.limitType==="F")return NS(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Ia(i.field,s)});let t=n.endAt?new Ur(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Ur(n.startAt.position,n.startAt.inclusive):null;return NS(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function PS(n,e){let t=n.filters.concat([e]);return new ar(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function by(n,e,t){return new ar(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function cf(n,e){return af(Zt(n),Zt(e))&&n.limitType===e.limitType}function mV(n){return`${Ea(Zt(n))}|lt:${n.limitType}`}function xu(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>lV(i)).join(", ")}]`),sf(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Qu(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Qu(i)).join(",")),`Target(${r})`})(Zt(n))}; limitType=${n.limitType})`}function uf(n,e){return e.isFoundDocument()&&(function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):W.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(let s of Vu(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(o,a,c){let d=xM(o,a,c);return o.inclusive?d<=0:d<0})(r.startAt,Vu(r),i)||r.endAt&&!(function(o,a,c){let d=xM(o,a,c);return o.inclusive?d>=0:d>0})(r.endAt,Vu(r),i))})(n,e)}function gV(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function yV(n){return(e,t)=>{let r=!1;for(let i of Vu(n)){let s=nG(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function nG(n,e,t){let r=n.field.isKeyField()?W.comparator(e.key,t.key):(function(s,o,a){let c=o.data.field(s),d=a.data.field(s);return c!==null&&d!==null?Vs(c,d):Y(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Y(19790,{direction:n.dir})}}var cr=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){zs(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return XO(this.inner)}size(){return this.innerSize}};var rG=new We(W.comparator);function pn(){return rG}var _V=new We(W.comparator);function mh(...n){let e=_V;for(let t of n)e=e.insert(t.key,t);return e}function vV(n){let e=_V;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function kr(){return Eh()}function IV(){return Eh()}function Eh(){return new cr(n=>n.toString(),(n,e)=>n.isEqual(e))}var iG=new We(W.comparator),sG=new qe(W.comparator);function he(...n){let e=sG;for(let t of n)e=e.add(t);return e}var oG=new qe(re);function bC(){return oG}function SC(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ch(e)?"-0":e}}function EV(n){return{integerValue:""+n}}function wV(n,e){return jO(e)?EV(e):SC(n,e)}var Ju=class{constructor(){this._=void 0}};function aG(n,e,t){return n instanceof Ls?(function(i,s){let o={fields:{[eV]:{stringValue:ZO},[nV]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&__(s)&&(s=v_(s)),s&&(o.fields[tV]=s),{mapValue:o}})(t,e):n instanceof Si?bV(n,e):n instanceof Ai?SV(n,e):(function(i,s){let o=TV(i,s),a=LM(o)+LM(i.Ee);return IS(o)&&IS(i.Ee)?EV(a):SC(i.serializer,a)})(n,e)}function cG(n,e,t){return n instanceof Si?bV(n,e):n instanceof Ai?SV(n,e):t}function TV(n,e){return n instanceof Fs?(function(r){return IS(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}var Ls=class extends Ju{},Si=class extends Ju{constructor(e){super(),this.elements=e}};function bV(n,e){let t=AV(e);for(let r of n.elements)t.some(i=>Fr(i,r))||t.push(r);return{arrayValue:{values:t}}}var Ai=class extends Ju{constructor(e){super(),this.elements=e}};function SV(n,e){let t=AV(e);for(let r of n.elements)t=t.filter(i=>!Fr(i,r));return{arrayValue:{values:t}}}var Fs=class extends Ju{constructor(e,t){super(),this.serializer=e,this.Ee=t}};function LM(n){return Xe(n.integerValue||n.doubleValue)}function AV(n){return Oh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var wa=class{constructor(e,t){this.field=e,this.transform=t}};function uG(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Si&&i instanceof Si||r instanceof Ai&&i instanceof Ai?ju(r.elements,i.elements,Fr):r instanceof Fs&&i instanceof Fs?Fr(r.Ee,i.Ee):r instanceof Ls&&i instanceof Ls})(n.transform,e.transform)}var xS=class{constructor(e,t){this.version=e,this.transformResults=t}},rt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function cy(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Xu=class{};function CV(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new js(n.key,rt.none()):new Us(n.key,n.data,rt.none());{let t=n.data,r=Jt.empty(),i=new qe(Tt.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new ur(n.key,r,new Dn(i.toArray()),rt.none())}}function lG(n,e,t){n instanceof Us?(function(i,s,o){let a=i.value.clone(),c=UM(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(n,e,t):n instanceof ur?(function(i,s,o){if(!cy(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=UM(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(DV(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):(function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function wh(n,e,t,r){return n instanceof Us?(function(s,o,a,c){if(!cy(s.precondition,o))return a;let d=s.value.clone(),h=jM(s.fieldTransforms,c,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null})(n,e,t,r):n instanceof ur?(function(s,o,a,c){if(!cy(s.precondition,o))return a;let d=jM(s.fieldTransforms,c,o),h=o.data;return h.setAll(DV(s)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))})(n,e,t,r):(function(s,o,a){return cy(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(n,e,t)}function dG(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=TV(r.transform,i||null);s!=null&&(t===null&&(t=Jt.empty()),t.set(r.field,s))}return t||null}function FM(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ju(r,i,(s,o)=>uG(s,o))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Us=class extends Xu{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},ur=class extends Xu{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function DV(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function UM(n,e,t){let r=new Map;X(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,cG(o,a,t[i]))}return r}function jM(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,aG(s,o,e))}return r}var js=class extends Xu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Vh=class extends Xu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Lh=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&lG(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=wh(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=wh(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=IV();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=CV(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(te.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),he())}isEqual(e){return this.batchId===e.batchId&&ju(this.mutations,e.mutations,(t,r)=>FM(t,r))&&ju(this.baseMutations,e.baseMutations,(t,r)=>FM(t,r))}},kS=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){X(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let i=(function(){return iG})(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var Fh=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Sy=class{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}};var MS=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var _t,Re;function RV(n){switch(n){case M.OK:return Y(64938);case M.CANCELLED:case M.UNKNOWN:case M.DEADLINE_EXCEEDED:case M.RESOURCE_EXHAUSTED:case M.INTERNAL:case M.UNAVAILABLE:case M.UNAUTHENTICATED:return!1;case M.INVALID_ARGUMENT:case M.NOT_FOUND:case M.ALREADY_EXISTS:case M.PERMISSION_DENIED:case M.FAILED_PRECONDITION:case M.ABORTED:case M.OUT_OF_RANGE:case M.UNIMPLEMENTED:case M.DATA_LOSS:return!0;default:return Y(15467,{code:n})}}function NV(n){if(n===void 0)return ut("GRPC error has no .code"),M.UNKNOWN;switch(n){case _t.OK:return M.OK;case _t.CANCELLED:return M.CANCELLED;case _t.UNKNOWN:return M.UNKNOWN;case _t.DEADLINE_EXCEEDED:return M.DEADLINE_EXCEEDED;case _t.RESOURCE_EXHAUSTED:return M.RESOURCE_EXHAUSTED;case _t.INTERNAL:return M.INTERNAL;case _t.UNAVAILABLE:return M.UNAVAILABLE;case _t.UNAUTHENTICATED:return M.UNAUTHENTICATED;case _t.INVALID_ARGUMENT:return M.INVALID_ARGUMENT;case _t.NOT_FOUND:return M.NOT_FOUND;case _t.ALREADY_EXISTS:return M.ALREADY_EXISTS;case _t.PERMISSION_DENIED:return M.PERMISSION_DENIED;case _t.FAILED_PRECONDITION:return M.FAILED_PRECONDITION;case _t.ABORTED:return M.ABORTED;case _t.OUT_OF_RANGE:return M.OUT_OF_RANGE;case _t.UNIMPLEMENTED:return M.UNIMPLEMENTED;case _t.DATA_LOSS:return M.DATA_LOSS;default:return Y(39323,{code:n})}}(Re=_t||(_t={}))[Re.OK=0]="OK",Re[Re.CANCELLED=1]="CANCELLED",Re[Re.UNKNOWN=2]="UNKNOWN",Re[Re.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Re[Re.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Re[Re.NOT_FOUND=5]="NOT_FOUND",Re[Re.ALREADY_EXISTS=6]="ALREADY_EXISTS",Re[Re.PERMISSION_DENIED=7]="PERMISSION_DENIED",Re[Re.UNAUTHENTICATED=16]="UNAUTHENTICATED",Re[Re.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Re[Re.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Re[Re.ABORTED=10]="ABORTED",Re[Re.OUT_OF_RANGE=11]="OUT_OF_RANGE",Re[Re.UNIMPLEMENTED=12]="UNIMPLEMENTED",Re[Re.INTERNAL=13]="INTERNAL",Re[Re.UNAVAILABLE=14]="UNAVAILABLE",Re[Re.DATA_LOSS=15]="DATA_LOSS";var Ay=null;var hG=new yi([4294967295,4294967295],0);function BM(n){let e=hC().encode(n),t=new qb;return t.update(e),new Uint8Array(t.digest())}function $M(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new yi([t,r],0),new yi([i,s],0)]}var OS=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ga(`Invalid padding: ${t}`);if(r<0)throw new ga(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ga(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ga(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=yi.fromNumber(this.fe)}pe(e,t,r){let i=e.add(t.multiply(yi.fromNumber(r)));return i.compare(hG)===1&&(i=new yi([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;let t=BM(e),[r,i]=$M(t);for(let s=0;s<this.hashCount;s++){let o=this.pe(r,i,s);if(!this.ye(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.fe===0)return;let t=BM(e),[r,i]=$M(t);for(let s=0;s<this.hashCount;s++){let o=this.pe(r,i,s);this.we(o)}}we(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},ga=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Uh=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,jh.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(te.min(),i,new We(re),pn(),he())}},jh=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,he(),he(),he())}};var Lu=class{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.be=i}},Cy=class{constructor(e,t){this.targetId=e,this.De=t}},Dy=class{constructor(e,t,r=dt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Ry=class{constructor(){this.ve=0,this.Ce=qM(),this.Fe=dt.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=he(),t=he(),r=he();return this.Ce.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Y(38017,{changeType:s})}}),new jh(this.Fe,this.Me,e,t,r)}ke(){this.xe=!1,this.Ce=qM()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,X(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}},VS=class{constructor(e){this.We=e,this.Ge=new Map,this.ze=pn(),this.je=Jg(),this.Je=Jg(),this.He=new We(re)}Ye(e){for(let t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(let t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{let r=this.tt(t);switch(e.state){case 0:this.nt(t)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),r.Be(e.resumeToken));break;default:Y(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((r,i)=>{this.nt(i)&&t(i)})}it(e){let t=e.targetId,r=e.De.count,i=this.st(t);if(i){let s=i.target;if(wy(s))if(r===0){let o=new W(s.path);this.Xe(t,o,bt.newNoDocument(o,te.min()))}else X(r===1,20013,{expectedCount:r});else{let o=this.ot(t);if(o!==r){let a=this._t(e),c=a?this.ut(a,e,o):1;if(c!==0){this.rt(t);let d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,d)}Ay?.ct((function(h,f,y,w,R){var N,P,F,q,$,ee;let ue={localCacheCount:h,existenceFilterCount:f.count,databaseId:y.database,projectId:y.projectId},Z=f.unchangedNames;return Z&&(ue.bloomFilter={applied:R===0,hashCount:(N=Z?.hashCount)!==null&&N!==void 0?N:0,bitmapLength:(q=(F=(P=Z?.bits)===null||P===void 0?void 0:P.bitmap)===null||F===void 0?void 0:F.length)!==null&&q!==void 0?q:0,padding:(ee=($=Z?.bits)===null||$===void 0?void 0:$.padding)!==null&&ee!==void 0?ee:0,mightContain:T=>{var v;return(v=w?.mightContain(T))!==null&&v!==void 0&&v}}),ue})(o,e.De,this.We.lt(),a,c))}}}}_t(e){let t=e.De.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=bi(r).toUint8Array()}catch(c){if(c instanceof vy)return nn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new OS(o,i,s)}catch(c){return nn(c instanceof ga?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.fe===0?null:a}ut(e,t,r){return t.De.count===r-this.ht(e,t.targetId)?0:2}ht(e,t){let r=this.We.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.We.lt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Xe(t,s,null),i++)}),i}Pt(e){let t=new Map;this.Ge.forEach((s,o)=>{let a=this.st(o);if(a){if(s.current&&wy(a.target)){let c=new W(a.target.path);this.Tt(c).has(o)||this.It(o,c)||this.Xe(o,c,bt.newNoDocument(c,e))}s.Ne&&(t.set(o,s.Le()),s.ke())}});let r=he();this.Je.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let d=this.st(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ze.forEach((s,o)=>o.setReadTime(e));let i=new Uh(e,t,this.He,this.ze,r);return this.ze=pn(),this.je=Jg(),this.Je=Jg(),this.He=new We(re),i}Ze(e,t){if(!this.nt(e))return;let r=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,r),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,r){if(!this.nt(e))return;let i=this.tt(e);this.It(e,t)?i.qe(t,1):i.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),r&&(this.ze=this.ze.insert(t,r))}removeTarget(e){this.Ge.delete(e)}ot(e){let t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new Ry,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new qe(re),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new qe(re),this.je=this.je.insert(e,t)),t}nt(e){let t=this.st(e)!==null;return t||j("WatchChangeAggregator","Detected inactive target",e),t}st(e){let t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Ry),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}};function Jg(){return new We(W.comparator)}function qM(){return new We(W.comparator)}var fG={asc:"ASCENDING",desc:"DESCENDING"},pG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},mG={and:"AND",or:"OR"},LS=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function FS(n,e){return n.useProto3Json||sf(e)?e:{value:e}}function Zu(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function PV(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function gG(n,e){return Zu(n,e.toTimestamp())}function lt(n){return X(!!n,49232),te.fromTimestamp((function(t){let r=Ti(t);return new Ze(r.seconds,r.nanos)})(n))}function AC(n,e){return US(n,e).canonicalString()}function US(n,e){let t=(function(i){return new we(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function xV(n){let e=we.fromString(n);return X(BV(e),10190,{key:e.toString()}),e}function Bh(n,e){return AC(n.databaseId,e.path)}function Vr(n,e){let t=xV(e);if(t.get(1)!==n.databaseId.projectId)throw new U(M.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new U(M.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new W(OV(t))}function kV(n,e){return AC(n.databaseId,e)}function MV(n){let e=xV(n);return e.length===4?we.emptyPath():OV(e)}function jS(n){return new we(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function OV(n){return X(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function HM(n,e,t){return{name:Bh(n,e),fields:t.value.mapValue.fields}}function E_(n,e,t){let r=Vr(n,e.name),i=lt(e.updateTime),s=e.createTime?lt(e.createTime):te.min(),o=new Jt({mapValue:{fields:e.fields}}),a=bt.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function yG(n,e){return"found"in e?(function(r,i){X(!!i.found,43571),i.found.name,i.found.updateTime;let s=Vr(r,i.found.name),o=lt(i.found.updateTime),a=i.found.createTime?lt(i.found.createTime):te.min(),c=new Jt({mapValue:{fields:i.found.fields}});return bt.newFoundDocument(s,o,a,c)})(n,e):"missing"in e?(function(r,i){X(!!i.missing,3894),X(!!i.readTime,22933);let s=Vr(r,i.missing),o=lt(i.readTime);return bt.newNoDocument(s,o)})(n,e):Y(7234,{result:e})}function _G(n,e){let t;if("targetChange"in e){e.targetChange;let r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Y(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(d,h){return d.useProto3Json?(X(h===void 0||typeof h=="string",58123),dt.fromBase64String(h||"")):(X(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),dt.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(d){let h=d.code===void 0?M.UNKNOWN:NV(d.code);return new U(h,d.message||"")})(o);t=new Dy(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Vr(n,r.document.name),s=lt(r.document.updateTime),o=r.document.createTime?lt(r.document.createTime):te.min(),a=new Jt({mapValue:{fields:r.document.fields}}),c=bt.newFoundDocument(i,s,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];t=new Lu(d,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Vr(n,r.document),s=r.readTime?lt(r.readTime):te.min(),o=bt.newNoDocument(i,s),a=r.removedTargetIds||[];t=new Lu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Vr(n,r.document),s=r.removedTargetIds||[];t=new Lu([],s,i,null)}else{if(!("filter"in e))return Y(11601,{At:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new MS(i,s),a=r.targetId;t=new Cy(a,o)}}return t}function $h(n,e){let t;if(e instanceof Us)t={update:HM(n,e.key,e.value)};else if(e instanceof js)t={delete:Bh(n,e.key)};else if(e instanceof ur)t={update:HM(n,e.key,e.data),updateMask:bG(e.fieldMask)};else{if(!(e instanceof Vh))return Y(16599,{Rt:e.type});t={verify:Bh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>(function(s,o){let a=o.transform;if(a instanceof Ls)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Si)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ai)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Fs)return{fieldPath:o.field.canonicalString(),increment:a.Ee};throw Y(20930,{transform:o.transform})})(0,r))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:gG(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Y(27497)})(n,e.precondition)),t}function BS(n,e){let t=e.currentDocument?(function(s){return s.updateTime!==void 0?rt.updateTime(lt(s.updateTime)):s.exists!==void 0?rt.exists(s.exists):rt.none()})(e.currentDocument):rt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>(function(o,a){let c=null;if("setToServerValue"in a)X(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),c=new Ls;else if("appendMissingElements"in a){let h=a.appendMissingElements.values||[];c=new Si(h)}else if("removeAllFromArray"in a){let h=a.removeAllFromArray.values||[];c=new Ai(h)}else"increment"in a?c=new Fs(o,a.increment):Y(16584,{proto:a});let d=Tt.fromServerFormat(a.fieldPath);return new wa(d,c)})(n,i)):[];if(e.update){e.update.name;let i=Vr(n,e.update.name),s=new Jt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=(function(c){let d=c.fieldPaths||[];return new Dn(d.map(h=>Tt.fromServerFormat(h)))})(e.updateMask);return new ur(i,s,o,t,r)}return new Us(i,s,t,r)}if(e.delete){let i=Vr(n,e.delete);return new js(i,t)}if(e.verify){let i=Vr(n,e.verify);return new Vh(i,t)}return Y(1463,{proto:e})}function vG(n,e){return n&&n.length>0?(X(e!==void 0,14353),n.map(t=>(function(i,s){let o=i.updateTime?lt(i.updateTime):lt(s);return o.isEqual(te.min())&&(o=lt(s)),new xS(o,i.transformResults||[])})(t,e))):[]}function VV(n,e){return{documents:[kV(n,e.path)]}}function w_(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=kV(n,i);let s=(function(d){if(d.length!==0)return jV(Fe.create(d,"and"))})(e.filters);s&&(t.structuredQuery.where=s);let o=(function(d){if(d.length!==0)return d.map(h=>(function(y){return{field:As(y.field),direction:EG(y.dir)}})(h))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=FS(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{Vt:t,parent:i}}function LV(n,e,t,r){let{Vt:i,parent:s}=w_(n,e),o={},a=[],c=0;return t.forEach(d=>{let h=r?d.alias:"aggregate_"+c++;o[h]=d.alias,d.aggregateType==="count"?a.push({alias:h,count:{}}):d.aggregateType==="avg"?a.push({alias:h,avg:{field:As(d.fieldPath)}}):d.aggregateType==="sum"&&a.push({alias:h,sum:{field:As(d.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:i.structuredQuery},parent:i.parent},ft:o,parent:s}}function FV(n){let e=MV(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){X(r===1,65062);let h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=(function(f){let y=UV(f);return y instanceof Fe&&wC(y)?y.getFilters():[y]})(t.where));let o=[];t.orderBy&&(o=(function(f){return f.map(y=>(function(R){return new Ia(ku(R.field),(function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(R.direction))})(y))})(t.orderBy));let a=null;t.limit&&(a=(function(f){let y;return y=typeof f=="object"?f.value:f,sf(y)?null:y})(t.limit));let c=null;t.startAt&&(c=(function(f){let y=!!f.before,w=f.values||[];return new Ur(w,y)})(t.startAt));let d=null;return t.endAt&&(d=(function(f){let y=!f.before,w=f.values||[];return new Ur(w,y)})(t.endAt)),hV(e,i,o,s,a,"F",c,d)}function IG(n,e){let t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Y(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function UV(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=ku(t.unaryFilter.field);return Te.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=ku(t.unaryFilter.field);return Te.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=ku(t.unaryFilter.field);return Te.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=ku(t.unaryFilter.field);return Te.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Y(61313);default:return Y(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Te.create(ku(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Y(58110);default:return Y(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Fe.create(t.compositeFilter.filters.map(r=>UV(r)),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Y(1026)}})(t.compositeFilter.op))})(n):Y(30097,{filter:n})}function EG(n){return fG[n]}function wG(n){return pG[n]}function TG(n){return mG[n]}function As(n){return{fieldPath:n.canonicalString()}}function ku(n){return Tt.fromServerFormat(n.fieldPath)}function jV(n){return n instanceof Te?(function(t){if(t.op==="=="){if(RM(t.value))return{unaryFilter:{field:As(t.field),op:"IS_NAN"}};if(DM(t.value))return{unaryFilter:{field:As(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(RM(t.value))return{unaryFilter:{field:As(t.field),op:"IS_NOT_NAN"}};if(DM(t.value))return{unaryFilter:{field:As(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:As(t.field),op:wG(t.op),value:t.value}}})(n):n instanceof Fe?(function(t){let r=t.getFilters().map(i=>jV(i));return r.length===1?r[0]:{compositeFilter:{op:TG(t.op),filters:r}}})(n):Y(54877,{filter:n})}function bG(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function BV(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var el=class n{constructor(e,t,r,i,s=te.min(),o=te.min(),a=dt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Ny=class{constructor(e){this.gt=e}};function SG(n,e){let t;if(e.document)t=E_(n.gt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=W.fromSegments(e.noDocument.path),i=ba(e.noDocument.readTime);t=bt.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Y(56709);{let r=W.fromSegments(e.unknownDocument.path),i=ba(e.unknownDocument.version);t=bt.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){let s=new Ze(i[0],i[1]);return te.fromTimestamp(s)})(e.readTime)),t}function zM(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Py(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(s,o){return{name:Bh(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Zu(s,o.version.toTimestamp()),createTime:Zu(s,o.createTime.toTimestamp())}})(n.gt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Ta(e.version)};else{if(!e.isUnknownDocument())return Y(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Ta(e.version)}}return r}function Py(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ta(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ba(n){let e=new Ze(n.seconds,n.nanoseconds);return te.fromTimestamp(e)}function ha(n,e){let t=(e.baseMutations||[]).map(s=>BS(n.gt,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>BS(n.gt,s)),i=Ze.fromMillis(e.localWriteTimeMs);return new Lh(e.batchId,i,t,r)}function gh(n){let e=ba(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?ba(n.lastLimboFreeSnapshotVersion):te.min(),r;return r=(function(s){return s.documents!==void 0})(n.query)?(function(s){let o=s.documents.length;return X(o===1,1966,{count:o}),Zt(ll(MV(s.documents[0])))})(n.query):(function(s){return Zt(FV(s))})(n.query),new el(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,dt.fromBase64String(n.resumeToken))}function $V(n,e){let t=Ta(e.snapshotVersion),r=Ta(e.lastLimboFreeSnapshotVersion),i;i=wy(e.target)?VV(n.gt,e.target):w_(n.gt,e.target).Vt;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ea(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function T_(n){let e=FV({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?by(e,e.limit,"L"):e}function Qb(n,e){return new Fh(e.largestBatchId,BS(n.gt,e.overlayMutation))}function GM(n,e){let t=e.path.lastSegment();return[n,Xt(e.path.popLast()),t]}function WM(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ta(r.readTime),documentKey:Xt(r.documentKey.path),largestBatchId:r.largestBatchId}}var $S=class{getBundleMetadata(e,t){return KM(e).get(t).next(r=>{if(r)return(function(s){return{id:s.bundleId,createTime:ba(s.createTime),version:s.version}})(r)})}saveBundleMetadata(e,t){return KM(e).put((function(i){return{bundleId:i.id,createTime:Ta(lt(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return QM(e).get(t).next(r=>{if(r)return(function(s){return{name:s.name,query:T_(s.bundledQuery),readTime:ba(s.readTime)}})(r)})}saveNamedQuery(e,t){return QM(e).put((function(i){return{name:i.name,readTime:Ta(lt(i.readTime)),bundledQuery:i.bundledQuery}})(t))}};function KM(n){return Nt(n,m_)}function QM(n){return Nt(n,g_)}var xy=class n{constructor(e,t){this.serializer=e,this.userId=t}static yt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return dh(e).get(GM(this.userId,t)).next(r=>r?Qb(this.serializer,r):null)}getOverlays(e,t){let r=kr();return O.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((s,o)=>{let a=new Fh(t,o);i.push(this.wt(e,a))}),O.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(o=>i.add(Xt(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(dh(e).Y(yS,a))}),O.waitFor(s)}getOverlaysForCollection(e,t,r){let i=kr(),s=Xt(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return dh(e).j(yS,o).next(a=>{for(let c of a){let d=Qb(this.serializer,c);i.set(d.getKey(),d)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let s=kr(),o,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return dh(e).X({index:GO,range:a},(c,d,h)=>{let f=Qb(this.serializer,d);s.size()<i||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):h.done()}).next(()=>s)}wt(e,t){return dh(e).put((function(i,s,o){let[a,c,d]=GM(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:$h(i.gt,o.mutation)}})(this.serializer,this.userId,t))}};function dh(n){return Nt(n,y_)}var qS=class{St(e){return Nt(e,_C)}getSessionToken(e){return this.St(e).get("sessionToken").next(t=>{let r=t?.value;return r?dt.fromUint8Array(r):dt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}};var vi=class{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(Xe(e.integerValue));else if("doubleValue"in e){let r=Xe(e.doubleValue);isNaN(r)?this.Ct(t,13):(this.Ct(t,15),Ch(r)?t.Ft(0):t.Ft(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ct(t,20),typeof r=="string"&&(r=Ti(r)),t.Mt(`${r.seconds||""}`),t.Ft(r.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(bi(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ct(t,45),t.Ft(r.latitude||0),t.Ft(r.longitude||0)}else"mapValue"in e?iV(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):I_(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):Y(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){let r=e.fields||{};this.Ct(t,55);for(let i of Object.keys(r))this.xt(i,t),this.Dt(r[i],t)}Lt(e,t){var r,i;let s=e.fields||{};this.Ct(t,53);let o=Ku,a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Ct(t,15),t.Ft(Xe(a)),this.xt(o,t),this.Dt(s[o],t)}qt(e,t){let r=e.values||[];this.Ct(t,50);for(let i of r)this.Dt(i,t)}Bt(e,t){this.Ct(t,37),W.fromName(e).path.forEach(r=>{this.Ct(t,60),this.$t(r,t)})}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}};vi.Ut=new vi;var Cu=255;function AG(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function YM(n){let e=64-(function(r){let i=0;for(let s=0;s<8;++s){let o=AG(255&r[s]);if(i+=o,o!==8)break}return i})(n);return Math.ceil(e/8)}var HS=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Kt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Wt(r.value),r=t.next();this.Gt()}zt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.jt(r.value),r=t.next();this.Jt()}Ht(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Wt(r);else if(r<2048)this.Wt(960|r>>>6),this.Wt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Wt(480|r>>>12),this.Wt(128|63&r>>>6),this.Wt(128|63&r);else{let i=t.codePointAt(0);this.Wt(240|i>>>18),this.Wt(128|63&i>>>12),this.Wt(128|63&i>>>6),this.Wt(128|63&i)}}this.Gt()}Yt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.jt(r);else if(r<2048)this.jt(960|r>>>6),this.jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.jt(480|r>>>12),this.jt(128|63&r>>>6),this.jt(128|63&r);else{let i=t.codePointAt(0);this.jt(240|i>>>18),this.jt(128|63&i>>>12),this.jt(128|63&i>>>6),this.jt(128|63&i)}}this.Jt()}Zt(e){let t=this.Xt(e),r=YM(t);this.en(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}tn(e){let t=this.Xt(e),r=YM(t);this.en(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}nn(){this.rn(Cu),this.rn(255)}sn(){this._n(Cu),this._n(255)}reset(){this.position=0}seed(e){this.en(e.length),this.buffer.set(e,this.position),this.position+=e.length}an(){return this.buffer.slice(0,this.position)}Xt(e){let t=(function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Wt(e){let t=255&e;t===0?(this.rn(0),this.rn(255)):t===Cu?(this.rn(Cu),this.rn(0)):this.rn(t)}jt(e){let t=255&e;t===0?(this._n(0),this._n(255)):t===Cu?(this._n(Cu),this._n(0)):this._n(e)}Gt(){this.rn(0),this.rn(1)}Jt(){this._n(0),this._n(1)}rn(e){this.en(1),this.buffer[this.position++]=e}_n(e){this.en(1),this.buffer[this.position++]=~e}en(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},zS=class{constructor(e){this.un=e}Nt(e){this.un.Kt(e)}Mt(e){this.un.Ht(e)}Ft(e){this.un.Zt(e)}vt(){this.un.nn()}},GS=class{constructor(e){this.un=e}Nt(e){this.un.zt(e)}Mt(e){this.un.Yt(e)}Ft(e){this.un.tn(e)}vt(){this.un.sn()}},fa=class{constructor(){this.un=new HS,this.cn=new zS(this.un),this.ln=new GS(this.un)}seed(e){this.un.seed(e)}hn(e){return e===0?this.cn:this.ln}an(){return this.un.an()}reset(){this.un.reset()}};var pa=class n{constructor(e,t,r,i){this.Pn=e,this.Tn=t,this.In=r,this.dn=i}En(){let e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new n(this.Pn,this.Tn,this.In,r)}An(e,t,r){return{indexId:this.Pn,uid:e,arrayValue:uy(this.In),directionalValue:uy(this.dn),orderedDocumentKey:uy(t),documentKey:r.path.toArray()}}Rn(e,t,r){let i=this.An(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}};function Ts(n,e){let t=n.Pn-e.Pn;return t!==0?t:(t=JM(n.In,e.In),t!==0?t:(t=JM(n.dn,e.dn),t!==0?t:W.comparator(n.Tn,e.Tn)))}function JM(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function uy(n){return zE()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function XM(n){return typeof n!="string"?n:(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}var ky=class{constructor(e){this.Vn=new qe((t,r)=>Tt.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.mn=e.orderBy,this.fn=[];for(let t of e.filters){let r=t;r.isInequality()?this.Vn=this.Vn.add(r):this.fn.push(r)}}get gn(){return this.Vn.size>1}pn(e){if(X(e.collectionGroup===this.collectionId,49279),this.gn)return!1;let t=lS(e);if(t!==void 0&&!this.yn(t))return!1;let r=ua(e),i=new Set,s=0,o=0;for(;s<r.length&&this.yn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Vn.size>0){let a=this.Vn.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.wn(a,c)||!this.Sn(this.mn[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.mn.length||!this.Sn(this.mn[o++],a))return!1}return!0}bn(){if(this.gn)return null;let e=new qe(Tt.comparator),t=[];for(let r of this.fn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Ii(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Ii(r.field,0))}for(let r of this.mn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Ii(r.field,r.dir==="asc"?0:1)));return new ks(ks.UNKNOWN_ID,this.collectionId,t,$u.empty())}yn(e){for(let t of this.fn)if(this.wn(t,e))return!0;return!1}wn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}Sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function qV(n){var e,t;if(X(n instanceof Te||n instanceof Fe,20012),n instanceof Te){if(n instanceof Ey){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>Te.create(n.field,"==",s)))||[];return Fe.create(i,"or")}return n}let r=n.filters.map(i=>qV(i));return Fe.create(r,n.op)}function CG(n){if(n.getFilters().length===0)return[];let e=QS(qV(n));return X(HV(e),7391),WS(e)||KS(e)?[e]:e.getFilters()}function WS(n){return n instanceof Te}function KS(n){return n instanceof Fe&&wC(n)}function HV(n){return WS(n)||KS(n)||(function(t){if(t instanceof Fe&&ES(t)){for(let r of t.getFilters())if(!WS(r)&&!KS(r))return!1;return!0}return!1})(n)}function QS(n){if(X(n instanceof Te||n instanceof Fe,34018),n instanceof Te)return n;if(n.filters.length===1)return QS(n.filters[0]);let e=n.filters.map(r=>QS(r)),t=Fe.create(e,n.op);return t=My(t),HV(t)?t:(X(t instanceof Fe,64498),X(Yu(t),40251),X(t.filters.length>1,57927),t.filters.reduce((r,i)=>CC(r,i)))}function CC(n,e){let t;return X(n instanceof Te||n instanceof Fe,38388),X(e instanceof Te||e instanceof Fe,25473),t=n instanceof Te?e instanceof Te?(function(i,s){return Fe.create([i,s],"and")})(n,e):ZM(n,e):e instanceof Te?ZM(e,n):(function(i,s){if(X(i.filters.length>0&&s.filters.length>0,48005),Yu(i)&&Yu(s))return uV(i,s.getFilters());let o=ES(i)?i:s,a=ES(i)?s:i,c=o.filters.map(d=>CC(d,a));return Fe.create(c,"or")})(n,e),My(t)}function ZM(n,e){if(Yu(e))return uV(e,n.getFilters());{let t=e.filters.map(r=>CC(n,r));return Fe.create(t,"or")}}function My(n){if(X(n instanceof Te||n instanceof Fe,11850),n instanceof Te)return n;let e=n.getFilters();if(e.length===1)return My(e[0]);if(aV(n))return n;let t=e.map(i=>My(i)),r=[];return t.forEach(i=>{i instanceof Te?r.push(i):i instanceof Fe&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Fe.create(r,n.op)}var YS=class{constructor(){this.Dn=new qh}addToCollectionParentIndex(e,t){return this.Dn.add(t),O.resolve()}getCollectionParents(e,t){return O.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return O.resolve()}deleteFieldIndex(e,t){return O.resolve()}deleteAllFieldIndexes(e){return O.resolve()}createTargetIndexes(e,t){return O.resolve()}getDocumentsMatchingTarget(e,t){return O.resolve(null)}getIndexType(e,t){return O.resolve(0)}getFieldIndexes(e,t){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,t){return O.resolve(jn.min())}getMinOffsetFromCollectionGroup(e,t){return O.resolve(jn.min())}updateCollectionGroup(e,t,r){return O.resolve()}updateIndexEntries(e,t){return O.resolve()}},qh=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new qe(we.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new qe(we.comparator)).toArray()}};var eO="IndexedDbIndexManager",Xg=new Uint8Array(0),JS=class{constructor(e,t){this.databaseId=t,this.vn=new qh,this.Cn=new cr(r=>Ea(r),(r,i)=>af(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.vn.add(t)});let s={collectionId:r,parent:Xt(i)};return tO(e).put(s)}return O.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[kO(t),""],!1,!0);return tO(e).j(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;r.push(xr(o.parent))}return r})}addFieldIndex(e,t){let r=hh(e),i=(function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}})(t);delete i.indexId;let s=r.add(i);if(t.indexState){let o=Ru(e);return s.next(a=>{o.put(WM(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let r=hh(e),i=Ru(e),s=Du(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=hh(e),r=Du(e),i=Ru(e);return t.Y().next(()=>r.Y()).next(()=>i.Y())}createTargetIndexes(e,t){return O.forEach(this.Fn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new ky(r).bn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let r=Du(e),i=!0,s=new Map;return O.forEach(this.Fn(t),o=>this.Mn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=he(),a=[];return O.forEach(s,(c,d)=>{j(eO,`Using index ${(function($){return`id=${$.indexId}|cg=${$.collectionGroup}|f=${$.fields.map(ee=>`${ee.fieldPath}:${ee.kind}`).join(",")}`})(c)} to execute ${Ea(t)}`);let h=(function($,ee){let ue=lS(ee);if(ue===void 0)return null;for(let Z of Ty($,ue.fieldPath))switch(Z.op){case"array-contains-any":return Z.value.arrayValue.values||[];case"array-contains":return[Z.value]}return null})(d,c),f=(function($,ee){let ue=new Map;for(let Z of ua(ee))for(let T of Ty($,Z.fieldPath))switch(T.op){case"==":case"in":ue.set(Z.fieldPath.canonicalString(),T.value);break;case"not-in":case"!=":return ue.set(Z.fieldPath.canonicalString(),T.value),Array.from(ue.values())}return null})(d,c),y=(function($,ee){let ue=[],Z=!0;for(let T of ua(ee)){let v=T.kind===0?MM($,T.fieldPath,$.startAt):OM($,T.fieldPath,$.startAt);ue.push(v.value),Z&&(Z=v.inclusive)}return new Ur(ue,Z)})(d,c),w=(function($,ee){let ue=[],Z=!0;for(let T of ua(ee)){let v=T.kind===0?OM($,T.fieldPath,$.endAt):MM($,T.fieldPath,$.endAt);ue.push(v.value),Z&&(Z=v.inclusive)}return new Ur(ue,Z)})(d,c),R=this.xn(c,d,y),N=this.xn(c,d,w),P=this.On(c,d,f),F=this.Nn(c.indexId,h,R,y.inclusive,N,w.inclusive,P);return O.forEach(F,q=>r.H(q,t.limit).next($=>{$.forEach(ee=>{let ue=W.fromSegments(ee.documentKey);o.has(ue)||(o=o.add(ue),a.push(ue))})}))}).next(()=>a)}return O.resolve(null)})}Fn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=CG(Fe.create(e.filters,"and")).map(r=>NS(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Cn.set(e,t),t)}Nn(e,t,r,i,s,o,a){let c=(t!=null?t.length:1)*Math.max(r.length,s.length),d=c/(t!=null?t.length:1),h=[];for(let f=0;f<c;++f){let y=t?this.Bn(t[f/d]):Xg,w=this.Ln(e,y,r[f%d],i),R=this.kn(e,y,s[f%d],o),N=a.map(P=>this.Ln(e,y,P,!0));h.push(...this.createRange(w,R,N))}return h}Ln(e,t,r,i){let s=new pa(e,W.empty(),t,r);return i?s:s.En()}kn(e,t,r,i){let s=new pa(e,W.empty(),t,r);return i?s.En():s}Mn(e,t){let r=new ky(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.pn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2,i=this.Fn(t);return O.forEach(i,s=>this.Mn(e,s).next(o=>{o?r!==0&&o.fields.length<(function(c){let d=new qe(Tt.comparator),h=!1;for(let f of c.filters)for(let y of f.getFlattenedFilters())y.field.isKeyField()||(y.op==="array-contains"||y.op==="array-contains-any"?h=!0:d=d.add(y.field));for(let f of c.orderBy)f.field.isKeyField()||(d=d.add(f.field));return d.size+(h?1:0)})(s)&&(r=1):r=0})).next(()=>(function(o){return o.limit!==null})(t)&&i.length>1&&r===2?1:r)}qn(e,t){let r=new fa;for(let i of ua(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=r.hn(i.kind);vi.Ut.bt(s,o)}return r.an()}Bn(e){let t=new fa;return vi.Ut.bt(e,t.hn(0)),t.an()}Qn(e,t){let r=new fa;return vi.Ut.bt(va(this.databaseId,t),r.hn((function(s){let o=ua(s);return o.length===0?0:o[o.length-1].kind})(e))),r.an()}On(e,t,r){if(r===null)return[];let i=[];i.push(new fa);let s=0;for(let o of ua(e)){let a=r[s++];for(let c of i)if(this.$n(t,o.fieldPath)&&Oh(a))i=this.Un(i,o,a);else{let d=c.hn(o.kind);vi.Ut.bt(a,d)}}return this.Kn(i)}xn(e,t,r){return this.On(e,t,r.position)}Kn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].an();return t}Un(e,t,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new fa;c.seed(a.an()),vi.Ut.bt(o,c.hn(t.kind)),s.push(c)}return s}$n(e,t){return!!e.filters.find(r=>r instanceof Te&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=hh(e),i=Ru(e);return(t?r.j(gS,IDBKeyRange.bound(t,t)):r.j()).next(s=>{let o=[];return O.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push((function(h,f){let y=f?new $u(f.sequenceNumber,new jn(ba(f.readTime),new W(xr(f.documentKey)),f.largestBatchId)):$u.empty(),w=h.fields.map(([R,N])=>new Ii(Tt.fromServerFormat(R),N));return new ks(h.indexId,h.collectionGroup,w,y)})(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:re(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=hh(e),s=Ru(e);return this.Wn(e).next(o=>i.j(gS,IDBKeyRange.bound(t,t)).next(a=>O.forEach(a,c=>s.put(WM(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){let r=new Map;return O.forEach(t,(i,s)=>{let o=r.get(i.collectionGroup);return(o?O.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),O.forEach(a,c=>this.Gn(e,i,c).next(d=>{let h=this.zn(s,c);return d.isEqual(h)?O.resolve():this.jn(e,s,c,d,h)}))))})}Jn(e,t,r,i){return Du(e).put(i.An(this.uid,this.Qn(r,t.key),t.key))}Hn(e,t,r,i){return Du(e).delete(i.Rn(this.uid,this.Qn(r,t.key),t.key))}Gn(e,t,r){let i=Du(e),s=new qe(Ts);return i.X({index:zO,range:IDBKeyRange.only([r.indexId,this.uid,uy(this.Qn(r,t))])},(o,a)=>{s=s.add(new pa(r.indexId,t,XM(a.arrayValue),XM(a.directionalValue)))}).next(()=>s)}zn(e,t){let r=new qe(Ts),i=this.qn(t,e);if(i==null)return r;let s=lS(t);if(s!=null){let o=e.data.field(s.fieldPath);if(Oh(o))for(let a of o.arrayValue.values||[])r=r.add(new pa(t.indexId,e.key,this.Bn(a),i))}else r=r.add(new pa(t.indexId,e.key,Xg,i));return r}jn(e,t,r,i,s){j(eO,"Updating index entries for document '%s'",t.key);let o=[];return(function(c,d,h,f,y){let w=c.getIterator(),R=d.getIterator(),N=Au(w),P=Au(R);for(;N||P;){let F=!1,q=!1;if(N&&P){let $=h(N,P);$<0?q=!0:$>0&&(F=!0)}else N!=null?q=!0:F=!0;F?(f(P),P=Au(R)):q?(y(N),N=Au(w)):(N=Au(w),P=Au(R))}})(i,s,Ts,a=>{o.push(this.Jn(e,t,r,a))},a=>{o.push(this.Hn(e,t,r,a))}),O.waitFor(o)}Wn(e){let t=1;return Ru(e).X({index:HO,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>Ts(o,a)).filter((o,a,c)=>!a||Ts(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=Ts(o,e),c=Ts(o,t);if(a===0)i[0]=e.En();else if(a>0&&c<0)i.push(o),i.push(o.En());else if(c>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.Yn(i[o],i[o+1]))return[];let a=i[o].Rn(this.uid,Xg,W.empty()),c=i[o+1].Rn(this.uid,Xg,W.empty());s.push(IDBKeyRange.bound(a,c))}return s}Yn(e,t){return Ts(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(nO)}getMinOffset(e,t){return O.mapArray(this.Fn(t),r=>this.Mn(e,r).next(i=>i||Y(44426))).next(nO)}};function tO(n){return Nt(n,Nh)}function Du(n){return Nt(n,vh)}function hh(n){return Nt(n,yC)}function Ru(n){return Nt(n,_h)}function nO(n){X(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;pC(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new jn(e.readTime,e.documentKey,t)}var rO={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},zV=41943040,fn=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};function GV(n,e,t){let r=n.store(or),i=n.store(qu),s=[],o=IDBKeyRange.only(t.batchId),a=0,c=r.X({range:o},(h,f,y)=>(a++,y.delete()));s.push(c.next(()=>{X(a===1,47070,{batchId:t.batchId})}));let d=[];for(let h of t.mutations){let f=BO(e,h.key.path,t.batchId);s.push(i.delete(f)),d.push(h.key)}return O.waitFor(s).next(()=>d)}function Oy(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Y(14731);e=n.noDocument}return JSON.stringify(e).length}fn.DEFAULT_COLLECTION_PERCENTILE=10,fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,fn.DEFAULT=new fn(zV,fn.DEFAULT_COLLECTION_PERCENTILE,fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),fn.DISABLED=new fn(-1,0,0);var Vy=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Zn={}}static yt(e,t,r,i){X(e.uid!=="",64387);let s=e.isAuthenticated()?e.uid:"";return new n(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return bs(e).X({index:ma,range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let s=Mu(e),o=bs(e);return o.add({}).next(a=>{X(typeof a=="number",49019);let c=new Lh(a,t,r,i),d=(function(w,R,N){let P=N.baseMutations.map(q=>$h(w.gt,q)),F=N.mutations.map(q=>$h(w.gt,q));return{userId:R,batchId:N.batchId,localWriteTimeMs:N.localWriteTime.toMillis(),baseMutations:P,mutations:F}})(this.serializer,this.userId,c),h=[],f=new qe((y,w)=>re(y.canonicalString(),w.canonicalString()));for(let y of i){let w=BO(this.userId,y.key.path,a);f=f.add(y.key.path.popLast()),h.push(o.put(d)),h.push(s.put(w,D5))}return f.forEach(y=>{h.push(this.indexManager.addToCollectionParentIndex(e,y))}),e.addOnCommittedListener(()=>{this.Zn[a]=c.keys()}),O.waitFor(h).next(()=>c)})}lookupMutationBatch(e,t){return bs(e).get(t).next(r=>r?(X(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),ha(this.serializer,r)):null)}Xn(e,t){return this.Zn[t]?O.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Zn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return bs(e).X({index:ma,range:i},(o,a,c)=>{a.userId===this.userId&&(X(a.batchId>=r,47524,{er:r}),s=ha(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=Ns;return bs(e).X({index:ma,range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,Ns],[this.userId,Number.POSITIVE_INFINITY]);return bs(e).j(ma,t).next(r=>r.map(i=>ha(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=ry(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Mu(e).X({range:i},(o,a,c)=>{let[d,h,f]=o,y=xr(h);if(d===this.userId&&t.path.isEqual(y))return bs(e).get(f).next(w=>{if(!w)throw Y(61480,{tr:o,batchId:f});X(w.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:w.userId,batchId:f}),s.push(ha(this.serializer,w))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new qe(re),i=[];return t.forEach(s=>{let o=ry(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=Mu(e).X({range:a},(d,h,f)=>{let[y,w,R]=d,N=xr(w);y===this.userId&&s.path.isEqual(N)?r=r.add(R):f.done()});i.push(c)}),O.waitFor(i).next(()=>this.nr(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=ry(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new qe(re);return Mu(e).X({range:o},(c,d,h)=>{let[f,y,w]=c,R=xr(y);f===this.userId&&r.isPrefixOf(R)?R.length===i&&(a=a.add(w)):h.done()}).next(()=>this.nr(e,a))}nr(e,t){let r=[],i=[];return t.forEach(s=>{i.push(bs(e).get(s).next(o=>{if(o===null)throw Y(35274,{batchId:s});X(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(ha(this.serializer,o))}))}),O.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return GV(e.ce,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.rr(t.batchId)}),O.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}rr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return O.resolve();let r=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),i=[];return Mu(e).X({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=xr(s[1]);i.push(c)}else a.done()}).next(()=>{X(i.length===0,56720,{ir:i.map(s=>s.canonicalString())})})})}containsKey(e,t){return WV(e,this.userId,t)}sr(e){return KV(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:Ns,lastStreamToken:""})}};function WV(n,e,t){let r=ry(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return Mu(n).X({range:s,Z:!0},(a,c,d)=>{let[h,f,y]=a;h===e&&f===i&&(o=!0),d.done()}).next(()=>o)}function bs(n){return Nt(n,or)}function Mu(n){return Nt(n,qu)}function KV(n){return Nt(n,Dh)}var tl=class n{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new n(0)}static ur(){return new n(-1)}};var XS=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.cr(e).next(t=>{let r=new tl(t.highestTargetId);return t.highestTargetId=r.next(),this.lr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.cr(e).next(t=>te.fromTimestamp(new Ze(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.cr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.cr(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.lr(e,i)))}addTargetData(e,t){return this.hr(e,t).next(()=>this.cr(e).next(r=>(r.targetCount+=1,this.Pr(t,r),this.lr(e,r))))}updateTargetData(e,t){return this.hr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Nu(e).delete(t.targetId)).next(()=>this.cr(e)).next(r=>(X(r.targetCount>0,8065),r.targetCount-=1,this.lr(e,r)))}removeTargets(e,t,r){let i=0,s=[];return Nu(e).X((o,a)=>{let c=gh(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>O.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Nu(e).X((r,i)=>{let s=gh(i);t(s)})}cr(e){return iO(e).get(yy).next(t=>(X(t!==null,2888),t))}lr(e,t){return iO(e).put(yy,t)}hr(e,t){return Nu(e).put($V(this.serializer,t))}Pr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.cr(e).next(t=>t.targetCount)}getTargetData(e,t){let r=Ea(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return Nu(e).X({range:i,index:qO},(o,a,c)=>{let d=gh(a);af(t,d.target)&&(s=d,c.done())}).next(()=>s)}addMatchingKeys(e,t,r){let i=[],s=Cs(e);return t.forEach(o=>{let a=Xt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),O.waitFor(i)}removeMatchingKeys(e,t,r){let i=Cs(e);return O.forEach(t,s=>{let o=Xt(s.path);return O.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){let r=Cs(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Cs(e),s=he();return i.X({range:r,Z:!0},(o,a,c)=>{let d=xr(o[1]),h=new W(d);s=s.add(h)}).next(()=>s)}containsKey(e,t){let r=Xt(t.path),i=IDBKeyRange.bound([r],[kO(r)],!1,!0),s=0;return Cs(e).X({index:gC,Z:!0,range:i},([o,a],c,d)=>{o!==0&&(s++,d.done())}).next(()=>s>0)}Et(e,t){return Nu(e).get(t).next(r=>r?gh(r):null)}};function Nu(n){return Nt(n,Hu)}function iO(n){return Nt(n,_a)}function Cs(n){return Nt(n,zu)}var sO="LruGarbageCollector",QV=1048576;function oO([n,e],[t,r]){let i=re(n,t);return i===0?re(e,r):i}var ZS=class{constructor(e){this.Tr=e,this.buffer=new qe(oO),this.Ir=0}dr(){return++this.Ir}Er(e){let t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();oO(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Ly=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){j(sO,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Hs(t)?j(sO,"Ignoring IndexedDB error during garbage collection: ",t):await qs(t)}await this.Rr(3e5)})}},eA=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return O.resolve(Cn.ue);let r=new ZS(t);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(j("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(rO)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(j("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),rO):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,i,s,o,a,c,d,h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(j("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(s=f,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(d=Date.now(),Pu()<=ve.DEBUG&&j("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${f} documents in `+(d-c)+`ms
Total Duration: ${d-h}ms`),O.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}};function YV(n,e){return new eA(n,e)}var tA=class{constructor(e,t){this.db=e,this.garbageCollector=YV(this,t)}mr(e){let t=this.yr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}yr(e){let t=0;return this.gr(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}gr(e,t){return this.wr(e,(r,i)=>t(i))}addReference(e,t,r){return Zg(e,r)}removeReference(e,t,r){return Zg(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Zg(e,t)}Sr(e,t){return(function(i,s){let o=!1;return KV(i).ee(a=>WV(i,a,s).next(c=>(c&&(o=!0),O.resolve(!c)))).next(()=>o)})(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.wr(e,(o,a)=>{if(a<=t){let c=this.Sr(e,o).next(d=>{if(!d)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,te.min()),Cs(e).delete((function(f){return[0,Xt(f.path)]})(o))))});i.push(c)}}).next(()=>O.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Zg(e,t)}wr(e,t){let r=Cs(e),i,s=Cn.ue;return r.X({index:gC},([o,a],{path:c,sequenceNumber:d})=>{o===0?(s!==Cn.ue&&t(new W(xr(i)),s),s=d,i=c):s=Cn.ue}).next(()=>{s!==Cn.ue&&t(new W(xr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Zg(n,e){return Cs(n).put((function(r,i){return{targetId:0,path:Xt(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}var Fy=class{constructor(){this.changes=new cr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,bt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?O.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var nA=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return ca(e).put(r)}removeEntry(e,t,r){return ca(e).delete((function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Py(o),a[a.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.br(e,r)))}getEntry(e,t){let r=bt.newInvalidDocument(t);return ca(e).X({index:iy,range:IDBKeyRange.only(fh(t))},(i,s)=>{r=this.Dr(t,s)}).next(()=>r)}vr(e,t){let r={size:0,document:bt.newInvalidDocument(t)};return ca(e).X({index:iy,range:IDBKeyRange.only(fh(t))},(i,s)=>{r={document:this.Dr(t,s),size:Oy(s)}}).next(()=>r)}getEntries(e,t){let r=pn();return this.Cr(e,t,(i,s)=>{let o=this.Dr(i,s);r=r.insert(i,o)}).next(()=>r)}Fr(e,t){let r=pn(),i=new We(W.comparator);return this.Cr(e,t,(s,o)=>{let a=this.Dr(s,o);r=r.insert(s,a),i=i.insert(s,Oy(o))}).next(()=>({documents:r,Mr:i}))}Cr(e,t,r){if(t.isEmpty())return O.resolve();let i=new qe(uO);t.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(fh(i.first()),fh(i.last())),o=i.getIterator(),a=o.getNext();return ca(e).X({index:iy,range:s},(c,d,h)=>{let f=W.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;a&&uO(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,d),a=o.hasNext()?o.getNext():null),a?h.G(fh(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){let o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Py(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ca(e).j(IDBKeyRange.bound(a,c,!0)).next(d=>{s?.incrementDocumentReadCount(d.length);let h=pn();for(let f of d){let y=this.Dr(W.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);y.isFoundDocument()&&(uf(t,y)||i.has(y.key))&&(h=h.insert(y.key,y))}return h})}getAllFromCollectionGroup(e,t,r,i){let s=pn(),o=cO(t,r),a=cO(t,jn.max());return ca(e).X({index:$O,range:IDBKeyRange.bound(o,a,!0)},(c,d,h)=>{let f=this.Dr(W.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);s=s.insert(f.key,f),s.size===i&&h.done()}).next(()=>s)}newChangeBuffer(e){return new rA(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return aO(e).get(mS).next(t=>(X(!!t,20021),t))}br(e,t){return aO(e).put(mS,t)}Dr(e,t){if(t){let r=SG(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(te.min())))return r}return bt.newInvalidDocument(e)}};function JV(n){return new nA(n)}var rA=class extends Fy{constructor(e,t){super(),this.Or=e,this.trackRemovals=t,this.Nr=new cr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new qe((s,o)=>re(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.Nr.get(s);if(t.push(this.Or.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=zM(this.Or.serializer,o);i=i.add(s.path.popLast());let d=Oy(c);r+=d-a.size,t.push(this.Or.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=zM(this.Or.serializer,o.convertToNoDocument(te.min()));t.push(this.Or.addEntry(e,s,c))}}),i.forEach(s=>{t.push(this.Or.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.Or.updateMetadata(e,r)),O.waitFor(t)}getFromCache(e,t){return this.Or.vr(e,t).next(r=>(this.Nr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.Or.Fr(e,t).next(({documents:r,Mr:i})=>(i.forEach((s,o)=>{this.Nr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function aO(n){return Nt(n,Rh)}function ca(n){return Nt(n,gy)}function fh(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function cO(n,e){let t=e.documentKey.path.toArray();return[n,Py(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function uO(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=re(t[s],r[s]),i)return i;return i=re(t.length,r.length),i||(i=re(t[t.length-2],r[r.length-2]),i||re(t[t.length-1],r[r.length-1]))}var iA=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Uy=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&wh(r.mutation,i,Dn.empty(),Ze.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,he()).next(()=>r))}getLocalViewOfDocuments(e,t,r=he()){let i=kr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=mh();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=kr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,he()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=pn(),o=Eh(),a=(function(){return Eh()})();return t.forEach((c,d)=>{let h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof ur)?s=s.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),wh(h.mutation,d,h.mutation.getFieldMask(),Ze.now())):o.set(d.key,Dn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((d,h)=>o.set(d,h)),t.forEach((d,h)=>{var f;return a.set(d,new iA(h,(f=o.get(d))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){let r=Eh(),i=new We((o,a)=>o-a),s=he();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let d=t.get(c);if(d===null)return;let h=r.get(c)||Dn.empty();h=a.applyToLocalView(d,h),r.set(c,h);let f=(i.get(a.batchId)||he()).add(c);i=i.insert(a.batchId,f)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),d=c.key,h=c.value,f=IV();h.forEach(y=>{if(!s.has(y)){let w=CV(t.get(y),r.get(y));w!==null&&f.set(y,w),s=s.add(y)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return O.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return(function(o){return W.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):TC(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):O.resolve(kr()),a=Bu,c=s;return o.next(d=>O.forEach(d,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(h)?O.resolve():this.remoteDocumentCache.getEntry(e,h).next(y=>{c=c.insert(h,y)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,c,d,he())).next(h=>({batchId:a,changes:vV(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new W(t)).next(r=>{let i=mh();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=mh();return this.indexManager.getCollectionParents(e,s).next(a=>O.forEach(a,c=>{let d=(function(f,y){return new ar(y,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)})(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(h=>{h.forEach((f,y)=>{o=o.insert(f,y)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,d)=>{let h=d.getKey();o.get(h)===null&&(o=o.insert(h,bt.newInvalidDocument(h)))});let a=mh();return o.forEach((c,d)=>{let h=s.get(c);h!==void 0&&wh(h.mutation,d,Dn.empty(),Ze.now()),uf(t,d)&&(a=a.insert(c,d))}),a})}};var sA=class{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return O.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:lt(i.createTime)}})(t)),O.resolve()}getNamedQuery(e,t){return O.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(i){return{name:i.name,query:T_(i.bundledQuery),readTime:lt(i.readTime)}})(t)),O.resolve()}};var oA=class{constructor(){this.overlays=new We(W.comparator),this.kr=new Map}getOverlay(e,t){return O.resolve(this.overlays.get(t))}getOverlays(e,t){let r=kr();return O.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.wt(e,t,s)}),O.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.kr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(r)),O.resolve()}getOverlaysForCollection(e,t,r){let i=kr(),s=t.length+1,o=new W(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,d=c.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return O.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new We((d,h)=>d-h),o=this.overlays.getIterator();for(;o.hasNext();){let d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let h=s.get(d.largestBatchId);h===null&&(h=kr(),s=s.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}let a=kr(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=i)););return O.resolve(a)}wt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Fh(t,r));let s=this.kr.get(t);s===void 0&&(s=he(),this.kr.set(t,s)),this.kr.set(t,s.add(r.key))}};var aA=class{constructor(){this.sessionToken=dt.EMPTY_BYTE_STRING}getSessionToken(e){return O.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,O.resolve()}};var Hh=class{constructor(){this.qr=new qe(vt.Qr),this.$r=new qe(vt.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){let r=new vt(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Wr(new vt(e,t))}Gr(e,t){e.forEach(r=>this.removeReference(r,t))}zr(e){let t=new W(new we([])),r=new vt(t,e),i=new vt(t,e+1),s=[];return this.$r.forEachInRange([r,i],o=>{this.Wr(o),s.push(o.key)}),s}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){let t=new W(new we([])),r=new vt(t,e),i=new vt(t,e+1),s=he();return this.$r.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new vt(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},vt=class{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return W.comparator(e.key,t.key)||re(e.Hr,t.Hr)}static Ur(e,t){return re(e.Hr,t.Hr)||W.comparator(e.key,t.key)}};var cA=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new qe(vt.Qr)}checkEmpty(e){return O.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Lh(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.Yr=this.Yr.add(new vt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return O.resolve(o)}lookupMutationBatch(e,t){return O.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Xr(r),s=i<0?0:i;return O.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(this.mutationQueue.length===0?Ns:this.er-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new vt(t,0),i=new vt(t,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([r,i],o=>{let a=this.Zr(o.Hr);s.push(a)}),O.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new qe(re);return t.forEach(i=>{let s=new vt(i,0),o=new vt(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,o],a=>{r=r.add(a.Hr)})}),O.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;W.isDocumentKey(s)||(s=s.child(""));let o=new vt(new W(s),0),a=new qe(re);return this.Yr.forEachWhile(c=>{let d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(a=a.add(c.Hr)),!0)},o),O.resolve(this.ei(a))}ei(e){let t=[];return e.forEach(r=>{let i=this.Zr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){X(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return O.forEach(t.mutations,i=>{let s=new vt(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,t){let r=new vt(t,0),i=this.Yr.firstAfterOrEqual(r);return O.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,O.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var uA=class{constructor(e){this.ni=e,this.docs=(function(){return new We(W.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return O.resolve(r?r.document.mutableCopy():bt.newInvalidDocument(t))}getEntries(e,t){let r=pn();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():bt.newInvalidDocument(i))}),O.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=pn(),o=t.path,a=new W(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:d,value:{document:h}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||pC(LO(h),r)<=0||(i.has(h.key)||uf(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return O.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Y(9500)}ri(e,t){return O.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new lA(this)}getSize(e){return O.resolve(this.size)}},lA=class extends Fy{constructor(e){super(),this.Or=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Or.addEntry(e,i)):this.Or.removeEntry(r)}),O.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}};var dA=class{constructor(e){this.persistence=e,this.ii=new cr(t=>Ea(t),af),this.lastRemoteSnapshotVersion=te.min(),this.highestTargetId=0,this.si=0,this.oi=new Hh,this.targetCount=0,this._i=tl.ar()}forEachTarget(e,t){return this.ii.forEach((r,i)=>t(i)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),O.resolve()}hr(e){this.ii.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this._i=new tl(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,O.resolve()}updateTargetData(e,t){return this.hr(t),O.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.ii.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.ii.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),O.waitFor(s).next(()=>i)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,t){let r=this.ii.get(t)||null;return O.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),O.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),O.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),O.resolve()}getMatchingKeysForTargetId(e,t){let r=this.oi.Jr(t);return O.resolve(r)}containsKey(e,t){return O.resolve(this.oi.containsKey(t))}};var zh=class{constructor(e,t){this.ai={},this.overlays={},this.ui=new Cn(0),this.ci=!1,this.ci=!0,this.li=new aA,this.referenceDelegate=e(this),this.hi=new dA(this),this.indexManager=new YS,this.remoteDocumentCache=(function(i){return new uA(i)})(r=>this.referenceDelegate.Pi(r)),this.serializer=new Ny(t),this.Ti=new sA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new oA,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new cA(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){j("MemoryPersistence","Starting transaction:",e);let i=new hA(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(e,t){return O.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,t)))}},hA=class extends fy{constructor(e){super(),this.currentSequenceNumber=e}},jy=class n{constructor(e){this.persistence=e,this.Ai=new Hh,this.Ri=null}static Vi(e){return new n(e)}get mi(){if(this.Ri)return this.Ri;throw Y(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),O.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),O.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),O.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(i=>this.mi.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.mi.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.mi,r=>{let i=W.fromPath(r);return this.fi(e,i).next(s=>{s||t.removeEntry(i,te.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return O.or([()=>O.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},By=class n{constructor(e,t){this.persistence=e,this.gi=new cr(r=>Xt(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=YV(this,t)}static Vi(e,t){return new n(e,t)}Ii(){}di(e){return O.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){let t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}yr(e){let t=0;return this.gr(e,r=>{t++}).next(()=>t)}gr(e,t){return O.forEach(this.gi,(r,i)=>this.Sr(e,r,i).next(s=>s?O.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ri(e,o=>this.Sr(e,o,t).next(a=>{a||(r++,s.removeEntry(o,te.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),O.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),O.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),O.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),O.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=oy(e.data.value)),t}Sr(e,t,r){return O.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.gi.get(t);return O.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var fA=class{constructor(e){this.serializer=e}q(e,t,r,i){let s=new py("createOrUpgrade",t);r<1&&i>=1&&((function(c){c.createObjectStore(of)})(e),(function(c){c.createObjectStore(Dh,{keyPath:C5}),c.createObjectStore(or,{keyPath:TM,autoIncrement:!0}).createIndex(ma,bM,{unique:!0}),c.createObjectStore(qu)})(e),lO(e),(function(c){c.createObjectStore(la)})(e));let o=O.resolve();return r<3&&i>=3&&(r!==0&&((function(c){c.deleteObjectStore(zu),c.deleteObjectStore(Hu),c.deleteObjectStore(_a)})(e),lO(e)),o=o.next(()=>(function(c){let d=c.store(_a),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:te.min().toTimestamp(),targetCount:0};return d.put(yy,h)})(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>(function(c,d){return d.store(or).j().next(f=>{c.deleteObjectStore(or),c.createObjectStore(or,{keyPath:TM,autoIncrement:!0}).createIndex(ma,bM,{unique:!0});let y=d.store(or),w=f.map(R=>y.put(R));return O.waitFor(w)})})(e,s))),o=o.next(()=>{(function(c){c.createObjectStore(Gu,{keyPath:V5})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.pi(s))),r<6&&i>=6&&(o=o.next(()=>((function(c){c.createObjectStore(Rh)})(e),this.yi(s)))),r<7&&i>=7&&(o=o.next(()=>this.wi(s))),r<8&&i>=8&&(o=o.next(()=>this.Si(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.bi(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore(m_,{keyPath:L5})})(e),(function(c){c.createObjectStore(g_,{keyPath:F5})})(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let d=c.createObjectStore(y_,{keyPath:z5});d.createIndex(yS,G5,{unique:!1}),d.createIndex(GO,W5,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>(function(c){let d=c.createObjectStore(gy,{keyPath:R5});d.createIndex(iy,N5),d.createIndex($O,P5)})(e)).next(()=>this.Di(e,s)).next(()=>e.deleteObjectStore(la))),r<14&&i>=14&&(o=o.next(()=>this.Ci(e,s))),r<15&&i>=15&&(o=o.next(()=>(function(c){c.createObjectStore(yC,{keyPath:U5,autoIncrement:!0}).createIndex(gS,j5,{unique:!1}),c.createObjectStore(_h,{keyPath:B5}).createIndex(HO,$5,{unique:!1}),c.createObjectStore(vh,{keyPath:q5}).createIndex(zO,H5,{unique:!1})})(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore(_h).clear()}).next(()=>{t.objectStore(vh).clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(c){c.createObjectStore(_C,{keyPath:K5})})(e)})),r<18&&i>=18&&zE()&&(o=o.next(()=>{t.objectStore(_h).clear()}).next(()=>{t.objectStore(vh).clear()})),o}yi(e){let t=0;return e.store(la).X((r,i)=>{t+=Oy(i)}).next(()=>{let r={byteSize:t};return e.store(Rh).put(mS,r)})}pi(e){let t=e.store(Dh),r=e.store(or);return t.j().next(i=>O.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,Ns],[s.userId,s.lastAcknowledgedBatchId]);return r.j(ma,o).next(a=>O.forEach(a,c=>{X(c.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});let d=ha(this.serializer,c);return GV(e,s.userId,d).next(()=>{})}))}))}wi(e){let t=e.store(zu),r=e.store(la);return e.store(_a).get(yy).next(i=>{let s=[];return r.X((o,a)=>{let c=new we(o),d=(function(f){return[0,Xt(f)]})(c);s.push(t.get(d).next(h=>h?O.resolve():(f=>t.put({targetId:0,path:Xt(f),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>O.waitFor(s))})}Si(e,t){e.createObjectStore(Nh,{keyPath:O5});let r=t.store(Nh),i=new qh,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:Xt(c)})}};return t.store(la).X({Z:!0},(o,a)=>{let c=new we(o);return s(c.popLast())}).next(()=>t.store(qu).X({Z:!0},([o,a,c],d)=>{let h=xr(a);return s(h.popLast())}))}bi(e){let t=e.store(Hu);return t.X((r,i)=>{let s=gh(i),o=$V(this.serializer,s);return t.put(o)})}Di(e,t){let r=t.store(la),i=[];return r.X((s,o)=>{let a=t.store(gy),c=(function(f){return f.document?new W(we.fromString(f.document.name).popFirst(5)):f.noDocument?W.fromSegments(f.noDocument.path):f.unknownDocument?W.fromSegments(f.unknownDocument.path):Y(36783)})(o).path.toArray(),d={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(d))}).next(()=>O.waitFor(i))}Ci(e,t){let r=t.store(or),i=JV(this.serializer),s=new zh(jy.Vi,this.serializer.gt);return r.j().next(o=>{let a=new Map;return o.forEach(c=>{var d;let h=(d=a.get(c.userId))!==null&&d!==void 0?d:he();ha(this.serializer,c).keys().forEach(f=>h=h.add(f)),a.set(c.userId,h)}),O.forEach(a,(c,d)=>{let h=new It(d),f=xy.yt(this.serializer,h),y=s.getIndexManager(h),w=Vy.yt(h,this.serializer,y,s.referenceDelegate);return new Uy(i,w,f,y).recalculateAndSaveOverlaysForDocumentKeys(new Ph(t,Cn.ue),c).next()})})}};function lO(n){n.createObjectStore(zu,{keyPath:k5}).createIndex(gC,M5,{unique:!0}),n.createObjectStore(Hu,{keyPath:"targetId"}).createIndex(qO,x5,{unique:!0}),n.createObjectStore(_a)}var Ss="IndexedDbPersistence",Yb=18e5,Jb=5e3,Xb="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",XV="main",pA=class n{constructor(e,t,r,i,s,o,a,c,d,h,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Fi=s,this.window=o,this.document=a,this.Mi=d,this.xi=h,this.Oi=f,this.ui=null,this.ci=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ni=null,this.inForeground=!1,this.Bi=null,this.Li=null,this.ki=Number.NEGATIVE_INFINITY,this.qi=y=>Promise.resolve(),!n.C())throw new U(M.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new tA(this,i),this.Qi=t+XV,this.serializer=new Ny(c),this.$i=new Ms(this.Qi,this.Oi,new fA(this.serializer)),this.li=new qS,this.hi=new XS(this.referenceDelegate,this.serializer),this.remoteDocumentCache=JV(this.serializer),this.Ti=new $S,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,h===!1&&ut(Ss,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ki().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new U(M.FAILED_PRECONDITION,Xb);return this.Wi(),this.Gi(),this.zi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.hi.getHighestSequenceNumber(e))}).then(e=>{this.ui=new Cn(e,this.Mi)}).then(()=>{this.ci=!0}).catch(e=>(this.$i&&this.$i.close(),Promise.reject(e)))}ji(e){return this.qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.$i.setDatabaseDeletedListener(e)}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Fi.enqueueAndForget(async()=>{this.started&&await this.Ki()}))}Ki(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ey(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ji(e).next(t=>{t||(this.isPrimary=!1,this.Fi.enqueueRetryable(()=>this.qi(!1)))})}).next(()=>this.Hi(e)).next(t=>this.isPrimary&&!t?this.Yi(e).next(()=>!1):!!t&&this.Zi(e).next(()=>!0))).catch(e=>{if(Hs(e))return j(Ss,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return j(Ss,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Fi.enqueueRetryable(()=>this.qi(e)),this.isPrimary=e})}Ji(e){return ph(e).get(Su).next(t=>O.resolve(this.Xi(t)))}es(e){return ey(e).delete(this.clientId)}async ts(){if(this.isPrimary&&!this.ns(this.ki,Yb)){this.ki=Date.now();let e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=Nt(t,Gu);return r.j().next(i=>{let s=this.rs(i,Yb),o=i.filter(a=>s.indexOf(a)===-1);return O.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ui)for(let t of e)this.Ui.removeItem(this.ss(t.clientId))}}zi(){this.Li=this.Fi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ki().then(()=>this.ts()).then(()=>this.zi()))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.xi?O.resolve(!0):ph(e).get(Su).next(t=>{if(t!==null&&this.ns(t.leaseTimestampMs,Jb)&&!this._s(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new U(M.FAILED_PRECONDITION,Xb);return!1}}return!(!this.networkEnabled||!this.inForeground)||ey(e).j().next(r=>this.rs(r,Jb).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&j(Ss,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.ci=!1,this.us(),this.Li&&(this.Li.cancel(),this.Li=null),this.cs(),this.ls(),await this.$i.runTransaction("shutdown","readwrite",[of,Gu],e=>{let t=new Ph(e,Cn.ue);return this.Yi(t).next(()=>this.es(t))}),this.$i.close(),this.hs()}rs(e,t){return e.filter(r=>this.ns(r.updateTimeMs,t)&&!this._s(r.clientId))}Ps(){return this.runTransaction("getActiveClients","readonly",e=>ey(e).j().next(t=>this.rs(t,Yb).map(r=>r.clientId)))}get started(){return this.ci}getGlobalsCache(){return this.li}getMutationQueue(e,t){return Vy.yt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new JS(e,this.serializer.gt.databaseId)}getDocumentOverlayCache(e){return xy.yt(this.serializer,e)}getBundleCache(){return this.Ti}runTransaction(e,t,r){j(Ss,"Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=(function(c){return c===18?J5:c===17?YO:c===16?Y5:c===15?vC:c===14?QO:c===13?KO:c===12?Q5:c===11?WO:void Y(60245)})(this.Oi),o;return this.$i.runTransaction(e,i,s,a=>(o=new Ph(a,this.ui?this.ui.next():Cn.ue),t==="readwrite-primary"?this.Ji(o).next(c=>!!c||this.Hi(o)).next(c=>{if(!c)throw ut(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Fi.enqueueRetryable(()=>this.qi(!1)),new U(M.FAILED_PRECONDITION,FO);return r(o)}).next(c=>this.Zi(o).next(()=>c)):this.Ts(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ts(e){return ph(e).get(Su).next(t=>{if(t!==null&&this.ns(t.leaseTimestampMs,Jb)&&!this._s(t.ownerId)&&!this.Xi(t)&&!(this.xi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new U(M.FAILED_PRECONDITION,Xb)})}Zi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ph(e).put(Su,t)}static C(){return Ms.C()}Yi(e){let t=ph(e);return t.get(Su).next(r=>this.Xi(r)?(j(Ss,"Releasing primary lease."),t.delete(Su)):O.resolve())}ns(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(ut(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Bi=()=>{this.Fi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ki()))},this.document.addEventListener("visibilitychange",this.Bi),this.inForeground=this.document.visibilityState==="visible")}cs(){this.Bi&&(this.document.removeEventListener("visibilitychange",this.Bi),this.Bi=null)}Gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Ni=()=>{this.us();let t=/(?:Version|Mobile)\/1[456]/;HE()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Fi.enterRestrictedMode(!0),this.Fi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ni))}ls(){this.Ni&&(this.window.removeEventListener("pagehide",this.Ni),this.Ni=null)}_s(e){var t;try{let r=((t=this.Ui)===null||t===void 0?void 0:t.getItem(this.ss(e)))!==null;return j(Ss,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ut(Ss,"Failed to get zombied client id.",r),!1}}us(){if(this.Ui)try{this.Ui.setItem(this.ss(this.clientId),String(Date.now()))}catch(e){ut("Failed to set zombie client id.",e)}}hs(){if(this.Ui)try{this.Ui.removeItem(this.ss(this.clientId))}catch{}}ss(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function ph(n){return Nt(n,of)}function ey(n){return Nt(n,Gu)}function DC(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var mA=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=i}static Es(e,t){let r=he(),i=he();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var gA=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var $y=class{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return HE()?8:UO(Gt())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ps(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ys(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new gA;return this.ws(e,t,o).next(a=>{if(s.result=a,this.Rs)return this.Ss(e,t,o,a.size)})}).next(()=>s.result)}Ss(e,t,r,i){return r.documentReadCount<this.Vs?(Pu()<=ve.DEBUG&&j("QueryEngine","SDK will not create cache indexes for query:",xu(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),O.resolve()):(Pu()<=ve.DEBUG&&j("QueryEngine","Query:",xu(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(Pu()<=ve.DEBUG&&j("QueryEngine","The SDK decides to create cache indexes for query:",xu(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Zt(t))):O.resolve())}ps(e,t){if(VM(t))return O.resolve(null);let r=Zt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=by(t,null,"F"),r=Zt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=he(...s);return this.gs.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let d=this.bs(t,a);return this.Ds(t,d,o,c.readTime)?this.ps(e,by(t,null,"F")):this.vs(e,d,t,c)}))})))}ys(e,t,r,i){return VM(t)||i.isEqual(te.min())?O.resolve(null):this.gs.getDocuments(e,r).next(s=>{let o=this.bs(t,s);return this.Ds(t,o,r,i)?O.resolve(null):(Pu()<=ve.DEBUG&&j("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),xu(t)),this.vs(e,o,t,VO(i,Bu)).next(a=>a))})}bs(e,t){let r=new qe(yV(e));return t.forEach((i,s)=>{uf(e,s)&&(r=r.add(s))}),r}Ds(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ws(e,t,r){return Pu()<=ve.DEBUG&&j("QueryEngine","Using full collection scan to execute query:",xu(t)),this.gs.getDocumentsMatchingQuery(e,t,jn.min(),r)}vs(e,t,r,i){return this.gs.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var RC="LocalStore",DG=3e8,yA=class{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.Fs=new We(re),this.Ms=new cr(s=>Ea(s),af),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Uy(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}};function ZV(n,e,t,r){return new yA(n,e,t,r)}async function eL(n,e){let t=G(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Ns(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=he();for(let d of i){o.push(d.batchId);for(let h of d.mutations)c=c.add(h.key)}for(let d of s){a.push(d.batchId);for(let h of d.mutations)c=c.add(h.key)}return t.localDocuments.getDocuments(r,c).next(d=>({Bs:d,removedBatchIds:o,addedBatchIds:a}))})})}function RG(n,e){let t=G(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.Os.newChangeBuffer({trackRemovals:!0});return(function(a,c,d,h){let f=d.batch,y=f.keys(),w=O.resolve();return y.forEach(R=>{w=w.next(()=>h.getEntry(c,R)).next(N=>{let P=d.docVersions.get(R);X(P!==null,48541),N.version.compareTo(P)<0&&(f.applyToRemoteDocument(N,d),N.isValidDocument()&&(N.setReadTime(d.commitVersion),h.addEntry(N)))})}),w.next(()=>a.mutationQueue.removeMutationBatch(c,f))})(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(a){let c=he();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(c=c.add(a.batch.mutations[d].key));return c})(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function tL(n){let e=G(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function NG(n,e){let t=G(n),r=e.snapshotVersion,i=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.Os.newChangeBuffer({trackRemovals:!0});i=t.Fs;let a=[];e.targetChanges.forEach((h,f)=>{let y=i.get(f);if(!y)return;a.push(t.hi.removeMatchingKeys(s,h.removedDocuments,f).next(()=>t.hi.addMatchingKeys(s,h.addedDocuments,f)));let w=y.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?w=w.withResumeToken(dt.EMPTY_BYTE_STRING,te.min()).withLastLimboFreeSnapshotVersion(te.min()):h.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(h.resumeToken,r)),i=i.insert(f,w),(function(N,P,F){return N.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-N.snapshotVersion.toMicroseconds()>=DG?!0:F.addedDocuments.size+F.modifiedDocuments.size+F.removedDocuments.size>0})(y,w,h)&&a.push(t.hi.updateTargetData(s,w))});let c=pn(),d=he();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(nL(s,o,e.documentUpdates).next(h=>{c=h.Ls,d=h.ks})),!r.isEqual(te.min())){let h=t.hi.getLastRemoteSnapshotVersion(s).next(f=>t.hi.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(h)}return O.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,d)).next(()=>c)}).then(s=>(t.Fs=i,s))}function nL(n,e,t){let r=he(),i=he();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=pn();return t.forEach((a,c)=>{let d=s.get(a);c.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(te.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):j(RC,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",c.version)}),{Ls:o,ks:i}})}function PG(n,e){let t=G(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Ns),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function nl(n,e){let t=G(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.hi.getTargetData(r,e).next(s=>s?(i=s,O.resolve(i)):t.hi.allocateTargetId(r).next(o=>(i=new el(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(r.targetId,r),t.Ms.set(e,r.targetId)),r})}async function rl(n,e,t){let r=G(n),i=r.Fs.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Hs(o))throw o;j(RC,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(i.target)}function qy(n,e,t){let r=G(n),i=te.min(),s=he();return r.persistence.runTransaction("Execute query","readwrite",o=>(function(c,d,h){let f=G(c),y=f.Ms.get(h);return y!==void 0?O.resolve(f.Fs.get(y)):f.hi.getTargetData(d,h)})(r,o,Zt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,t?i:te.min(),t?s:he())).next(a=>(sL(r,gV(e),a),{documents:a,qs:s})))}function rL(n,e){let t=G(n),r=G(t.hi),i=t.Fs.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.Et(s,e).next(o=>o?o.target:null))}function iL(n,e){let t=G(n),r=t.xs.get(e)||te.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Os.getAllFromCollectionGroup(i,e,VO(r,Bu),Number.MAX_SAFE_INTEGER)).then(i=>(sL(t,e,i),i))}function sL(n,e,t){let r=n.xs.get(e)||te.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.xs.set(e,r)}async function xG(n,e,t,r){let i=G(n),s=he(),o=pn();for(let d of t){let h=e.Qs(d.metadata.name);d.document&&(s=s.add(h));let f=e.$s(d);f.setReadTime(e.Us(d.metadata.readTime)),o=o.insert(h,f)}let a=i.Os.newChangeBuffer({trackRemovals:!0}),c=await nl(i,(function(h){return Zt(ll(we.fromString(`__bundle__/docs/${h}`)))})(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",d=>nL(d,a,o).next(h=>(a.apply(d),h)).next(h=>i.hi.removeMatchingKeysForTargetId(d,c.targetId).next(()=>i.hi.addMatchingKeys(d,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(d,h.Ls,h.ks)).next(()=>h.Ls)))}async function kG(n,e,t=he()){let r=await nl(n,Zt(T_(e.bundledQuery))),i=G(n);return i.persistence.runTransaction("Save named query","readwrite",s=>{let o=lt(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Ti.saveNamedQuery(s,e);let a=r.withResumeToken(dt.EMPTY_BYTE_STRING,o);return i.Fs=i.Fs.insert(a.targetId,a),i.hi.updateTargetData(s,a).next(()=>i.hi.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.hi.addMatchingKeys(s,t,r.targetId)).next(()=>i.Ti.saveNamedQuery(s,e))})}var oL="firestore_clients";function dO(n,e){return`${oL}_${n}_${e}`}var aL="firestore_mutations";function hO(n,e,t){let r=`${aL}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}var cL="firestore_targets";function Zb(n,e){return`${cL}_${n}_${e}`}var Pr="SharedClientState",Hy=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ks(e,t,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new U(i.error.code,i.error.message))),o?new n(e,t,i.state,s):(ut(Pr,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Ws(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Th=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ks(e,t){let r=JSON.parse(t),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new U(r.error.code,r.error.message))),s?new n(e,r.state,i):(ut(Pr,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},zy=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ks(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=bC();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=jO(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new n(e,s):(ut(Pr,`Failed to parse client data for instance '${e}': ${t}`),null)}},_A=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Ks(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(ut(Pr,`Failed to parse online state: ${e}`),null)}},Gh=class{constructor(){this.activeTargetIds=bC()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},bh=class{constructor(e,t,r,i,s){this.window=e,this.Fi=t,this.persistenceKey=r,this.js=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Js=this.Hs.bind(this),this.Ys=new We(re),this.started=!1,this.Zs=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Xs=dO(this.persistenceKey,this.js),this.eo=(function(c){return`firestore_sequence_number_${c}`})(this.persistenceKey),this.Ys=this.Ys.insert(this.js,new Gh),this.no=new RegExp(`^${oL}_${o}_([^_]*)$`),this.ro=new RegExp(`^${aL}_${o}_(\\d+)(?:_(.*))?$`),this.io=new RegExp(`^${cL}_${o}_(\\d+)$`),this.so=(function(c){return`firestore_online_state_${c}`})(this.persistenceKey),this.oo=(function(c){return`firestore_bundle_loaded_v2_${c}`})(this.persistenceKey),this.window.addEventListener("storage",this.Js)}static C(e){return!(!e||!e.localStorage)}async start(){let e=await this.syncEngine.Ps();for(let r of e){if(r===this.js)continue;let i=this.getItem(dO(this.persistenceKey,r));if(i){let s=zy.Ks(r,i);s&&(this.Ys=this.Ys.insert(s.clientId,s))}}this._o();let t=this.storage.getItem(this.so);if(t){let r=this.ao(t);r&&this.uo(r)}for(let r of this.Zs)this.Hs(r);this.Zs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.eo,JSON.stringify(e))}getAllActiveQueryTargets(){return this.co(this.Ys)}isActiveQueryTarget(e){let t=!1;return this.Ys.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.lo(e,"pending")}updateMutationState(e,t,r){this.lo(e,t,r),this.ho(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){let i=this.storage.getItem(Zb(this.persistenceKey,e));if(i){let s=Th.Ks(e,i);s&&(r=s.state)}}return t&&this.Po.Gs(e),this._o(),r}removeLocalQueryTarget(e){this.Po.zs(e),this._o()}isLocalQueryTarget(e){return this.Po.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Zb(this.persistenceKey,e))}updateQueryState(e,t,r){this.To(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.ho(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Io(e)}notifyBundleLoaded(e){this.Eo(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Js),this.removeItem(this.Xs),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return j(Pr,"READ",e,t),t}setItem(e,t){j(Pr,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){j(Pr,"REMOVE",e),this.storage.removeItem(e)}Hs(e){let t=e;if(t.storageArea===this.storage){if(j(Pr,"EVENT",t.key,t.newValue),t.key===this.Xs)return void ut("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Fi.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.no.test(t.key)){if(t.newValue==null){let r=this.Ao(t.key);return this.Ro(r,null)}{let r=this.Vo(t.key,t.newValue);if(r)return this.Ro(r.clientId,r)}}else if(this.ro.test(t.key)){if(t.newValue!==null){let r=this.mo(t.key,t.newValue);if(r)return this.fo(r)}}else if(this.io.test(t.key)){if(t.newValue!==null){let r=this.po(t.key,t.newValue);if(r)return this.yo(r)}}else if(t.key===this.so){if(t.newValue!==null){let r=this.ao(t.newValue);if(r)return this.uo(r)}}else if(t.key===this.eo){let r=(function(s){let o=Cn.ue;if(s!=null)try{let a=JSON.parse(s);X(typeof a=="number",30636,{wo:s}),o=a}catch(a){ut(Pr,"Failed to read sequence number from WebStorage",a)}return o})(t.newValue);r!==Cn.ue&&this.sequenceNumberHandler(r)}else if(t.key===this.oo){let r=this.So(t.newValue);await Promise.all(r.map(i=>this.syncEngine.bo(i)))}}}else this.Zs.push(t)})}}get Po(){return this.Ys.get(this.js)}_o(){this.setItem(this.Xs,this.Po.Ws())}lo(e,t,r){let i=new Hy(this.currentUser,e,t,r),s=hO(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Ws())}ho(e){let t=hO(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Io(e){let t={clientId:this.js,onlineState:e};this.storage.setItem(this.so,JSON.stringify(t))}To(e,t,r){let i=Zb(this.persistenceKey,e),s=new Th(e,t,r);this.setItem(i,s.Ws())}Eo(e){let t=JSON.stringify(Array.from(e));this.setItem(this.oo,t)}Ao(e){let t=this.no.exec(e);return t?t[1]:null}Vo(e,t){let r=this.Ao(e);return zy.Ks(r,t)}mo(e,t){let r=this.ro.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Hy.Ks(new It(s),i,t)}po(e,t){let r=this.io.exec(e),i=Number(r[1]);return Th.Ks(i,t)}ao(e){return _A.Ks(e)}So(e){return JSON.parse(e)}async fo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Do(e.batchId,e.state,e.error);j(Pr,`Ignoring mutation for non-active user ${e.user.uid}`)}yo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Ro(e,t){let r=t?this.Ys.insert(e,t):this.Ys.remove(e),i=this.co(this.Ys),s=this.co(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.Co(o,a).then(()=>{this.Ys=r})}uo(e){this.Ys.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}co(e){let t=bC();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},Gy=class{constructor(){this.Fo=new Gh,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new Gh,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var vA=class{xo(e){}shutdown(){}};var fO="ConnectivityMonitor",Wy=class{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){j(fO,"Network connectivity changed: AVAILABLE");for(let e of this.ko)e(0)}Lo(){j(fO,"Network connectivity changed: UNAVAILABLE");for(let e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var ty=null;function IA(){return ty===null?ty=(function(){return 268435456+Math.round(2147483648*Math.random())})():ty++,"0x"+ty.toString(16)}var eS="RestConnection",MG={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},EA=class{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===kh?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,s){let o=IA(),a=this.Go(e,t.toUriEncodedString());j(eS,`Sending RPC '${e}' ${o}:`,a,r);let c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(c,i,s);let{host:d}=new URL(a),h=us(d);return this.jo(e,a,c,r,h).then(f=>(j(eS,`Received RPC '${e}' ${o}: `,f),f),f=>{throw nn(eS,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}Jo(e,t,r,i,s,o){return this.Wo(e,t,r,i,s)}zo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ul})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}Go(e,t){let r=MG[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}};var wA=class{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}};var Yt="WebChannelConnection",TA=class extends EA{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,i,s){let o=IA();return new Promise((a,c)=>{let d=new Hb;d.setWithCredentials(!0),d.listenOnce(zb.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case lh.NO_ERROR:let f=d.getResponseJson();j(Yt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case lh.TIMEOUT:j(Yt,`RPC '${e}' ${o} timed out`),c(new U(M.DEADLINE_EXCEEDED,"Request time out"));break;case lh.HTTP_ERROR:let y=d.getStatus();if(j(Yt,`RPC '${e}' ${o} failed with status:`,y,"response text:",d.getResponseText()),y>0){let w=d.getResponseJson();Array.isArray(w)&&(w=w[0]);let R=w?.error;if(R&&R.status&&R.message){let N=(function(F){let q=F.toLowerCase().replace(/_/g,"-");return Object.values(M).indexOf(q)>=0?q:M.UNKNOWN})(R.status);c(new U(N,R.message))}else c(new U(M.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new U(M.UNAVAILABLE,"Connection failed."));break;default:Y(9055,{c_:e,streamId:o,l_:d.getLastErrorCode(),h_:d.getLastError()})}}finally{j(Yt,`RPC '${e}' ${o} completed.`)}});let h=JSON.stringify(i);j(Yt,`RPC '${e}' ${o} sending request:`,i),d.send(t,"POST",h,r,15)})}P_(e,t,r){let i=IA(),s=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Kb(),a=Wb(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.zo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let h=s.join("");j(Yt,`Creating RPC '${e}' stream ${i}: ${h}`,c);let f=o.createWebChannel(h,c);this.T_(f);let y=!1,w=!1,R=new wA({Ho:P=>{w?j(Yt,`Not sending because RPC '${e}' stream ${i} is closed:`,P):(y||(j(Yt,`Opening RPC '${e}' stream ${i} transport.`),f.open(),y=!0),j(Yt,`RPC '${e}' stream ${i} sending:`,P),f.send(P))},Yo:()=>f.close()}),N=(P,F,q)=>{P.listen(F,$=>{try{q($)}catch(ee){setTimeout(()=>{throw ee},0)}})};return N(f,bu.EventType.OPEN,()=>{w||(j(Yt,`RPC '${e}' stream ${i} transport opened.`),R.s_())}),N(f,bu.EventType.CLOSE,()=>{w||(w=!0,j(Yt,`RPC '${e}' stream ${i} transport closed`),R.__(),this.I_(f))}),N(f,bu.EventType.ERROR,P=>{w||(w=!0,nn(Yt,`RPC '${e}' stream ${i} transport errored. Name:`,P.name,"Message:",P.message),R.__(new U(M.UNAVAILABLE,"The operation could not be completed")))}),N(f,bu.EventType.MESSAGE,P=>{var F;if(!w){let q=P.data[0];X(!!q,16349);let $=q,ee=$?.error||((F=$[0])===null||F===void 0?void 0:F.error);if(ee){j(Yt,`RPC '${e}' stream ${i} received error:`,ee);let ue=ee.status,Z=(function(E){let S=_t[E];if(S!==void 0)return NV(S)})(ue),T=ee.message;Z===void 0&&(Z=M.INTERNAL,T="Unknown error status: "+ue+" with message "+ee.message),w=!0,R.__(new U(Z,T)),f.close()}else j(Yt,`RPC '${e}' stream ${i} received:`,q),R.a_(q)}}),N(a,Gb.STAT_EVENT,P=>{P.stat===Yg.PROXY?j(Yt,`RPC '${e}' stream ${i} detected buffering proxy`):P.stat===Yg.NOPROXY&&j(Yt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{R.o_()},0),R}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}};function uL(){return typeof window<"u"?window:null}function ly(){return typeof document<"u"?document:null}function xa(n){return new LS(n,!0)}var Wh=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=i,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();let t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,t-r);i>0&&j("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}};var pO="PersistentStream",Ky=class{constructor(e,t,r,i,s,o,a,c){this.Fi=e,this.w_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Wh(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===M.RESOURCE_EXHAUSTED?(ut(t.toString()),ut("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===M.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;let e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===t&&this.W_(r,i)},r=>{e(()=>{let i=new U(M.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(e,t){let r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return j(pO,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(j(pO,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},bA=class extends Ky{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();let t=_G(this.serializer,e),r=(function(s){if(!("targetChange"in s))return te.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?te.min():o.readTime?lt(o.readTime):te.min()})(e);return this.listener.J_(t,r)}H_(e){let t={};t.database=jS(this.serializer),t.addTarget=(function(s,o){let a,c=o.target;if(a=wy(c)?{documents:VV(s,c)}:{query:w_(s,c).Vt},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=PV(s,o.resumeToken);let d=FS(s,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(te.min())>0){a.readTime=Zu(s,o.snapshotVersion.toTimestamp());let d=FS(s,o.expectedCount);d!==null&&(a.expectedCount=d)}return a})(this.serializer,e);let r=IG(this.serializer,e);r&&(t.labels=r),this.k_(t)}Y_(e){let t={};t.database=jS(this.serializer),t.removeTarget=e,this.k_(t)}},SA=class extends Ky{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return X(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,X(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){X(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();let t=vG(e.writeResults,e.commitTime),r=lt(e.commitTime);return this.listener.ta(r,t)}na(){let e={};e.database=jS(this.serializer),this.k_(e)}X_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>$h(this.serializer,r))};this.k_(t)}};var AA=class{},CA=class extends AA{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new U(M.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(e,US(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new U(M.UNKNOWN,s.toString())})}Jo(e,t,r,i,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Jo(e,US(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new U(M.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}},DA=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(ut(t),this._a=!1):j("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}};var Sa="RemoteStore",RA=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(o=>{r.enqueueAndForget(async()=>{Gs(this)&&(j(Sa,"Restarting streams for network reachability change."),await(async function(c){let d=G(c);d.Ia.add(4),await dl(d),d.Aa.set("Unknown"),d.Ia.delete(4),await lf(d)})(this))})}),this.Aa=new DA(r,i)}};async function lf(n){if(Gs(n))for(let e of n.da)await e(!0)}async function dl(n){for(let e of n.da)await e(!1)}function b_(n,e){let t=G(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),xC(t)?PC(t):fl(t).x_()&&NC(t,e))}function il(n,e){let t=G(n),r=fl(t);t.Ta.delete(e),r.x_()&&lL(t,e),t.Ta.size===0&&(r.x_()?r.B_():Gs(t)&&t.Aa.set("Unknown"))}function NC(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(te.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}fl(n).H_(e)}function lL(n,e){n.Ra.$e(e),fl(n).Y_(e)}function PC(n){n.Ra=new VS({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),fl(n).start(),n.Aa.aa()}function xC(n){return Gs(n)&&!fl(n).M_()&&n.Ta.size>0}function Gs(n){return G(n).Ia.size===0}function dL(n){n.Ra=void 0}async function OG(n){n.Aa.set("Online")}async function VG(n){n.Ta.forEach((e,t)=>{NC(n,e)})}async function LG(n,e){dL(n),xC(n)?(n.Aa.la(e),PC(n)):n.Aa.set("Unknown")}async function FG(n,e,t){if(n.Aa.set("Online"),e instanceof Dy&&e.state===2&&e.cause)try{await(async function(i,s){let o=s.cause;for(let a of s.targetIds)i.Ta.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ta.delete(a),i.Ra.removeTarget(a))})(n,e)}catch(r){j(Sa,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Qy(n,r)}else if(e instanceof Lu?n.Ra.Ye(e):e instanceof Cy?n.Ra.it(e):n.Ra.et(e),!t.isEqual(te.min()))try{let r=await tL(n.localStore);t.compareTo(r)>=0&&await(function(s,o){let a=s.Ra.Pt(o);return a.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){let h=s.Ta.get(d);h&&s.Ta.set(d,h.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,d)=>{let h=s.Ta.get(c);if(!h)return;s.Ta.set(c,h.withResumeToken(dt.EMPTY_BYTE_STRING,h.snapshotVersion)),lL(s,c);let f=new el(h.target,c,d,h.sequenceNumber);NC(s,f)}),s.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(r){j(Sa,"Failed to raise snapshot:",r),await Qy(n,r)}}async function Qy(n,e,t){if(!Hs(e))throw e;n.Ia.add(1),await dl(n),n.Aa.set("Offline"),t||(t=()=>tL(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{j(Sa,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await lf(n)})}function hL(n,e){return e().catch(t=>Qy(n,t,e))}async function hl(n){let e=G(n),t=Bs(e),r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Ns;for(;UG(e);)try{let i=await PG(e.localStore,r);if(i===null){e.Pa.length===0&&t.B_();break}r=i.batchId,jG(e,i)}catch(i){await Qy(e,i)}fL(e)&&pL(e)}function UG(n){return Gs(n)&&n.Pa.length<10}function jG(n,e){n.Pa.push(e);let t=Bs(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function fL(n){return Gs(n)&&!Bs(n).M_()&&n.Pa.length>0}function pL(n){Bs(n).start()}async function BG(n){Bs(n).na()}async function $G(n){let e=Bs(n);for(let t of n.Pa)e.X_(t.mutations)}async function qG(n,e,t){let r=n.Pa.shift(),i=kS.from(r,e,t);await hL(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await hl(n)}async function HG(n,e){e&&Bs(n).Z_&&await(async function(r,i){if((function(o){return RV(o)&&o!==M.ABORTED})(i.code)){let s=r.Pa.shift();Bs(r).N_(),await hL(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await hl(r)}})(n,e),fL(n)&&pL(n)}async function mO(n,e){let t=G(n);t.asyncQueue.verifyOperationInProgress(),j(Sa,"RemoteStore received new credentials");let r=Gs(t);t.Ia.add(3),await dl(t),r&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await lf(t)}async function NA(n,e){let t=G(n);e?(t.Ia.delete(2),await lf(t)):e||(t.Ia.add(2),await dl(t),t.Aa.set("Unknown"))}function fl(n){return n.Va||(n.Va=(function(t,r,i){let s=G(t);return s.ia(),new bA(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:OG.bind(null,n),e_:VG.bind(null,n),n_:LG.bind(null,n),J_:FG.bind(null,n)}),n.da.push(async e=>{e?(n.Va.N_(),xC(n)?PC(n):n.Aa.set("Unknown")):(await n.Va.stop(),dL(n))})),n.Va}function Bs(n){return n.ma||(n.ma=(function(t,r,i){let s=G(t);return s.ia(),new SA(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:BG.bind(null,n),n_:HG.bind(null,n),ea:$G.bind(null,n),ta:qG.bind(null,n)}),n.da.push(async e=>{e?(n.ma.N_(),await hl(n)):(await n.ma.stop(),n.Pa.length>0&&(j(Sa,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))})),n.ma}var PA=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new wt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new U(M.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function pl(n,e){if(ut("AsyncQueue",`${e}: ${n}`),Hs(n))return new U(M.UNAVAILABLE,`${e}: ${n}`);throw n}var Kh=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||W.comparator(t.key,r.key):(t,r)=>W.comparator(t.key,r.key),this.keyedMap=mh(),this.sortedSet=new We(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Yy=class{constructor(){this.fa=new We(W.comparator)}track(e){let t=e.doc.key,r=this.fa.get(t);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(t,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(t):e.type===1&&r.type===2?this.fa=this.fa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):Y(63341,{At:e,ga:r}):this.fa=this.fa.insert(t,e)}pa(){let e=[];return this.fa.inorderTraversal((t,r)=>{e.push(r)}),e}},Aa=class n{constructor(e,t,r,i,s,o,a,c,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,Kh.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&cf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var xA=class{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}},kA=class{constructor(){this.queries=gO(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){let i=G(t),s=i.queries;i.queries=gO(),s.forEach((o,a)=>{for(let c of a.wa)c.onError(r)})})(this,new U(M.ABORTED,"Firestore shutting down"))}};function gO(){return new cr(n=>mV(n),cf)}async function kC(n,e){let t=G(n),r=3,i=e.query,s=t.queries.get(i);s?!s.Sa()&&e.ba()&&(r=2):(s=new xA,r=e.ba()?0:1);try{switch(r){case 0:s.ya=await t.onListen(i,!0);break;case 1:s.ya=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){let a=pl(o,`Initialization of query '${xu(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.wa.push(e),e.va(t.onlineState),s.ya&&e.Ca(s.ya)&&OC(t)}async function MC(n,e){let t=G(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.wa.indexOf(e);o>=0&&(s.wa.splice(o,1),s.wa.length===0?i=e.ba()?0:1:!s.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function zG(n,e){let t=G(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.wa)a.Ca(i)&&(r=!0);o.ya=i}}r&&OC(t)}function GG(n,e,t){let r=G(n),i=r.queries.get(e);if(i)for(let s of i.wa)s.onError(t);r.queries.delete(e)}function OC(n){n.Da.forEach(e=>{e.next()})}var MA,yO;(yO=MA||(MA={})).Fa="default",yO.Cache="cache";var Qh=class{constructor(e,t,r){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Aa(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;let r=t!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;let t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=Aa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==MA.Cache}};var Jy=class{constructor(e,t){this.qa=e,this.byteLength=t}Qa(){return"metadata"in this.qa}};var Xy=class{constructor(e){this.serializer=e}Qs(e){return Vr(this.serializer,e)}$s(e){return e.metadata.exists?E_(this.serializer,e.document,!1):bt.newNoDocument(this.Qs(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return lt(e)}},Yh=class{constructor(e,t){this.$a=e,this.serializer=t,this.Ua=[],this.Ka=[],this.collectionGroups=new Set,this.progress=mL(e)}get queries(){return this.Ua}get documents(){return this.Ka}Wa(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Ua.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Ka.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++t;let r=we.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.qa.document&&(this.Ka[this.Ka.length-1].document=e.qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Ga(e){let t=new Map,r=new Xy(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Qs(i.metadata.name);for(let o of i.metadata.queries){let a=(t.get(o)||he()).add(s);t.set(o,a)}}return t}async za(e){let t=await xG(e,new Xy(this.serializer),this.Ka,this.$a.id),r=this.Ga(this.documents);for(let i of this.Ua)await kG(e,i,r.get(i.name));return this.progress.taskState="Success",{progress:this.progress,ja:this.collectionGroups,Ja:t}}};function mL(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var Zy=class{constructor(e){this.key=e}},e_=class{constructor(e){this.key=e}},t_=class{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=he(),this.mutatedKeys=he(),this.Xa=yV(e),this.eu=new Kh(this.Xa)}get tu(){return this.Ha}nu(e,t){let r=t?t.ru:new Yy,i=t?t.eu:this.eu,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,f)=>{let y=i.get(h),w=uf(this.query,f)?f:null,R=!!y&&this.mutatedKeys.has(y.key),N=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations),P=!1;y&&w?y.data.isEqual(w.data)?R!==N&&(r.track({type:3,doc:w}),P=!0):this.iu(y,w)||(r.track({type:2,doc:w}),P=!0,(c&&this.Xa(w,c)>0||d&&this.Xa(w,d)<0)&&(a=!0)):!y&&w?(r.track({type:0,doc:w}),P=!0):y&&!w&&(r.track({type:1,doc:y}),P=!0,(c||d)&&(a=!0)),P&&(w?(o=o.add(w),s=N?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{eu:o,ru:r,Ds:a,mutatedKeys:s}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;let o=e.ru.pa();o.sort((h,f)=>(function(w,R){let N=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Y(20277,{At:P})}};return N(w)-N(R)})(h.type,f.type)||this.Xa(h.doc,f.doc)),this.su(r),i=i!=null&&i;let a=t&&!i?this.ou():[],c=this.Za.size===0&&this.current&&!i?1:0,d=c!==this.Ya;return this.Ya=c,o.length!==0||d?{snapshot:new Aa(this.query,e.eu,s,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:a}:{_u:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Yy,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}ou(){if(!this.current)return[];let e=this.Za;this.Za=he(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});let t=[];return e.forEach(r=>{this.Za.has(r)||t.push(new e_(r))}),this.Za.forEach(r=>{e.has(r)||t.push(new Zy(r))}),t}uu(e){this.Ha=e.qs,this.Za=he();let t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Aa.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}},Ws="SyncEngine",OA=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},VA=class{constructor(e){this.key=e,this.lu=!1}},LA=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new cr(a=>mV(a),cf),this.Tu=new Map,this.Iu=new Set,this.du=new We(W.comparator),this.Eu=new Map,this.Au=new Hh,this.Ru={},this.Vu=new Map,this.mu=tl.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}};async function WG(n,e,t=!0){let r=S_(n),i,s=r.Pu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=await gL(r,e,t,!0),i}async function KG(n,e){let t=S_(n);await gL(t,e,!0,!1)}async function gL(n,e,t,r){let i=await nl(n.localStore,Zt(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),a;return r&&(a=await VC(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&b_(n.remoteStore,i),a}async function VC(n,e,t,r,i){n.gu=(f,y,w)=>(async function(N,P,F,q){let $=P.view.nu(F);$.Ds&&($=await qy(N.localStore,P.query,!1).then(({documents:T})=>P.view.nu(T,$)));let ee=q&&q.targetChanges.get(P.targetId),ue=q&&q.targetMismatches.get(P.targetId)!=null,Z=P.view.applyChanges($,N.isPrimaryClient,ee,ue);return FA(N,P.targetId,Z._u),Z.snapshot})(n,f,y,w);let s=await qy(n.localStore,e,!0),o=new t_(e,s.qs),a=o.nu(s.documents),c=jh.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=o.applyChanges(a,n.isPrimaryClient,c);FA(n,t,d._u);let h=new OA(e,t,o);return n.Pu.set(e,h),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),d.snapshot}async function QG(n,e,t){let r=G(n),i=r.Pu.get(e),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter(o=>!cf(o,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await rl(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&il(r.remoteStore,i.targetId),sl(r,i.targetId)}).catch(qs)):(sl(r,i.targetId),await rl(r.localStore,i.targetId,!0))}async function YG(n,e){let t=G(n),r=t.Pu.get(e),i=t.Tu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),il(t.remoteStore,r.targetId))}async function JG(n,e,t){let r=jC(n);try{let i=await(function(o,a){let c=G(o),d=Ze.now(),h=a.reduce((w,R)=>w.add(R.key),he()),f,y;return c.persistence.runTransaction("Locally write mutations","readwrite",w=>{let R=pn(),N=he();return c.Os.getEntries(w,h).next(P=>{R=P,R.forEach((F,q)=>{q.isValidDocument()||(N=N.add(F))})}).next(()=>c.localDocuments.getOverlayedDocuments(w,R)).next(P=>{f=P;let F=[];for(let q of a){let $=dG(q,f.get(q.key).overlayedDocument);$!=null&&F.push(new ur(q.key,$,oV($.value.mapValue),rt.exists(!0)))}return c.mutationQueue.addMutationBatch(w,d,F,a)}).next(P=>{y=P;let F=P.applyToLocalDocumentSet(f,N);return c.documentOverlayCache.saveOverlays(w,P.batchId,F)})}).then(()=>({batchId:y.batchId,changes:vV(f)}))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,a,c){let d=o.Ru[o.currentUser.toKey()];d||(d=new We(re)),d=d.insert(a,c),o.Ru[o.currentUser.toKey()]=d})(r,i.batchId,t),await Ri(r,i.changes),await hl(r.remoteStore)}catch(i){let s=pl(i,"Failed to persist write");t.reject(s)}}async function yL(n,e){let t=G(n);try{let r=await NG(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Eu.get(s);o&&(X(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.lu=!0:i.modifiedDocuments.size>0?X(o.lu,14607):i.removedDocuments.size>0&&(X(o.lu,42227),o.lu=!1))}),await Ri(t,r,e)}catch(r){await qs(r)}}function _O(n,e,t){let r=G(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Pu.forEach((s,o)=>{let a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),(function(o,a){let c=G(o);c.onlineState=a;let d=!1;c.queries.forEach((h,f)=>{for(let y of f.wa)y.va(a)&&(d=!0)}),d&&OC(c)})(r.eventManager,e),i.length&&r.hu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function XG(n,e,t){let r=G(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Eu.get(e),s=i&&i.key;if(s){let o=new We(W.comparator);o=o.insert(s,bt.newNoDocument(s,te.min()));let a=he().add(s),c=new Uh(te.min(),new Map,new We(re),o,a);await yL(r,c),r.du=r.du.remove(s),r.Eu.delete(e),UC(r)}else await rl(r.localStore,e,!1).then(()=>sl(r,e,t)).catch(qs)}async function ZG(n,e){let t=G(n),r=e.batch.batchId;try{let i=await RG(t.localStore,e);FC(t,r,null),LC(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Ri(t,i)}catch(i){await qs(i)}}async function eW(n,e,t){let r=G(n);try{let i=await(function(o,a){let c=G(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return c.mutationQueue.lookupMutationBatch(d,a).next(f=>(X(f!==null,37113),h=f.keys(),c.mutationQueue.removeMutationBatch(d,f))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>c.localDocuments.getDocuments(d,h))})})(r.localStore,e);FC(r,e,t),LC(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Ri(r,i)}catch(i){await qs(i)}}async function tW(n,e){let t=G(n);Gs(t.remoteStore)||j(Ws,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=await(function(o){let a=G(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))})(t.localStore);if(r===Ns)return void e.resolve();let i=t.Vu.get(r)||[];i.push(e),t.Vu.set(r,i)}catch(r){let i=pl(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function LC(n,e){(n.Vu.get(e)||[]).forEach(t=>{t.resolve()}),n.Vu.delete(e)}function FC(n,e,t){let r=G(n),i=r.Ru[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ru[r.currentUser.toKey()]=i}}function sl(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Tu.get(e))n.Pu.delete(r),t&&n.hu.pu(r,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach(r=>{n.Au.containsKey(r)||_L(n,r)})}function _L(n,e){n.Iu.delete(e.path.canonicalString());let t=n.du.get(e);t!==null&&(il(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),UC(n))}function FA(n,e,t){for(let r of t)r instanceof Zy?(n.Au.addReference(r.key,e),nW(n,r)):r instanceof e_?(j(Ws,"Document no longer in limbo: "+r.key),n.Au.removeReference(r.key,e),n.Au.containsKey(r.key)||_L(n,r.key)):Y(19791,{yu:r})}function nW(n,e){let t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Iu.has(r)||(j(Ws,"New document in limbo: "+t),n.Iu.add(r),UC(n))}function UC(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){let e=n.Iu.values().next().value;n.Iu.delete(e);let t=new W(we.fromString(e)),r=n.mu.next();n.Eu.set(r,new VA(t)),n.du=n.du.insert(t,r),b_(n.remoteStore,new el(Zt(ll(t.path)),r,"TargetPurposeLimboResolution",Cn.ue))}}async function Ri(n,e,t){let r=G(n),i=[],s=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((a,c)=>{o.push(r.gu(c,e,t).then(d=>{var h;if((d||t)&&r.isPrimaryClient){let f=d?!d.fromCache:(h=t?.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(d){i.push(d);let f=mA.Es(c.targetId,d);s.push(f)}}))}),await Promise.all(o),r.hu.J_(i),await(async function(c,d){let h=G(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>O.forEach(d,y=>O.forEach(y.Is,w=>h.persistence.referenceDelegate.addReference(f,y.targetId,w)).next(()=>O.forEach(y.ds,w=>h.persistence.referenceDelegate.removeReference(f,y.targetId,w)))))}catch(f){if(!Hs(f))throw f;j(RC,"Failed to update sequence numbers: "+f)}for(let f of d){let y=f.targetId;if(!f.fromCache){let w=h.Fs.get(y),R=w.snapshotVersion,N=w.withLastLimboFreeSnapshotVersion(R);h.Fs=h.Fs.insert(y,N)}}})(r.localStore,s))}async function rW(n,e){let t=G(n);if(!t.currentUser.isEqual(e)){j(Ws,"User change. New user:",e.toKey());let r=await eL(t.localStore,e);t.currentUser=e,(function(s,o){s.Vu.forEach(a=>{a.forEach(c=>{c.reject(new U(M.CANCELLED,o))})}),s.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ri(t,r.Bs)}}function iW(n,e){let t=G(n),r=t.Eu.get(e);if(r&&r.lu)return he().add(r.key);{let i=he(),s=t.Tu.get(e);if(!s)return i;for(let o of s){let a=t.Pu.get(o);i=i.unionWith(a.view.tu)}return i}}async function sW(n,e){let t=G(n),r=await qy(t.localStore,e.query,!0),i=e.view.uu(r);return t.isPrimaryClient&&FA(t,e.targetId,i._u),i}async function oW(n,e){let t=G(n);return iL(t.localStore,e).then(r=>Ri(t,r))}async function aW(n,e,t,r){let i=G(n),s=await(function(a,c){let d=G(a),h=G(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",f=>h.Xn(f,c).next(y=>y?d.localDocuments.getDocuments(f,y):O.resolve(null)))})(i.localStore,e);s!==null?(t==="pending"?await hl(i.remoteStore):t==="acknowledged"||t==="rejected"?(FC(i,e,r||null),LC(i,e),(function(a,c){G(G(a).mutationQueue).rr(c)})(i.localStore,e)):Y(6720,"Unknown batchState",{wu:t}),await Ri(i,s)):j(Ws,"Cannot apply mutation batch with id: "+e)}async function cW(n,e){let t=G(n);if(S_(t),jC(t),e===!0&&t.fu!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=await vO(t,r.toArray());t.fu=!0,await NA(t.remoteStore,!0);for(let s of i)b_(t.remoteStore,s)}else if(e===!1&&t.fu!==!1){let r=[],i=Promise.resolve();t.Tu.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(sl(t,o),rl(t.localStore,o,!0))),il(t.remoteStore,o)}),await i,await vO(t,r),(function(o){let a=G(o);a.Eu.forEach((c,d)=>{il(a.remoteStore,d)}),a.Au.jr(),a.Eu=new Map,a.du=new We(W.comparator)})(t),t.fu=!1,await NA(t.remoteStore,!1)}}async function vO(n,e,t){let r=G(n),i=[],s=[];for(let o of e){let a,c=r.Tu.get(o);if(c&&c.length!==0){a=await nl(r.localStore,Zt(c[0]));for(let d of c){let h=r.Pu.get(d),f=await sW(r,h);f.snapshot&&s.push(f.snapshot)}}else{let d=await rL(r.localStore,o);a=await nl(r.localStore,d),await VC(r,vL(d),o,!1,a.resumeToken)}i.push(a)}return r.hu.J_(s),i}function vL(n){return hV(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function uW(n){return(function(t){return G(G(t).persistence).Ps()})(G(n).localStore)}async function lW(n,e,t,r){let i=G(n);if(i.fu)return void j(Ws,"Ignoring unexpected query state notification.");let s=i.Tu.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=await iL(i.localStore,gV(s[0])),a=Uh.createSynthesizedRemoteEventForCurrentChange(e,t==="current",dt.EMPTY_BYTE_STRING);await Ri(i,o,a);break}case"rejected":await rl(i.localStore,e,!0),sl(i,e,r);break;default:Y(64155,t)}}async function dW(n,e,t){let r=S_(n);if(r.fu){for(let i of e){if(r.Tu.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){j(Ws,"Adding an already active target "+i);continue}let s=await rL(r.localStore,i),o=await nl(r.localStore,s);await VC(r,vL(s),o.targetId,!1,o.resumeToken),b_(r.remoteStore,o)}for(let i of t)r.Tu.has(i)&&await rl(r.localStore,i,!1).then(()=>{il(r.remoteStore,i),sl(r,i)}).catch(qs)}}function S_(n){let e=G(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=yL.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=iW.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=XG.bind(null,e),e.hu.J_=zG.bind(null,e.eventManager),e.hu.pu=GG.bind(null,e.eventManager),e}function jC(n){let e=G(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ZG.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=eW.bind(null,e),e}function hW(n,e,t){let r=G(n);(async function(s,o,a){try{let c=await o.getMetadata();if(await(function(w,R){let N=G(w),P=lt(R.createTime);return N.persistence.runTransaction("hasNewerBundle","readonly",F=>N.Ti.getBundleMetadata(F,R.id)).then(F=>!!F&&F.createTime.compareTo(P)>=0)})(s.localStore,c))return await o.close(),a._completeWith((function(w){return{taskState:"Success",documentsLoaded:w.totalDocuments,bytesLoaded:w.totalBytes,totalDocuments:w.totalDocuments,totalBytes:w.totalBytes}})(c)),Promise.resolve(new Set);a._updateProgress(mL(c));let d=new Yh(c,o.serializer),h=await o.Su();for(;h;){let y=await d.Wa(h);y&&a._updateProgress(y),h=await o.Su()}let f=await d.za(s.localStore);return await Ri(s,f.Ja,void 0),await(function(w,R){let N=G(w);return N.persistence.runTransaction("Save bundle","readwrite",P=>N.Ti.saveBundleMetadata(P,R))})(s.localStore,c),a._completeWith(f.progress),Promise.resolve(f.ja)}catch(c){return nn(Ws,`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var A_=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=xa(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)}Cu(t,r){return null}Fu(t,r){return null}vu(t){return ZV(this.persistence,new $y,t.initialUser,this.serializer)}Du(t){return new zh(jy.Vi,this.serializer)}bu(t){return new Gy}async terminate(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),Jh=class extends A_{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){X(this.persistence.referenceDelegate instanceof By,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new Ly(r,e.asyncQueue,t)}Du(e){let t=this.cacheSizeBytes!==void 0?fn.withCacheSize(this.cacheSizeBytes):fn.DEFAULT;return new zh(r=>By.Vi(r,t),this.serializer)}},Xh=class extends A_{constructor(e,t,r){super(),this.Mu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Mu.initialize(this,e),await jC(this.Mu.syncEngine),await hl(this.Mu.remoteStore),await this.persistence.ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return ZV(this.persistence,new $y,e.initialUser,this.serializer)}Cu(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new Ly(r,e.asyncQueue,t)}Fu(e,t){let r=new pS(t,this.persistence);return new fS(e.asyncQueue,r)}Du(e){let t=DC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?fn.withCacheSize(this.cacheSizeBytes):fn.DEFAULT;return new pA(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,uL(),ly(),this.serializer,this.sharedClientState,!!this.forceOwnership)}bu(e){return new Gy}},n_=class extends Xh{constructor(e,t){super(e,t,!1),this.Mu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);let t=this.Mu.syncEngine;this.sharedClientState instanceof bh&&(this.sharedClientState.syncEngine={Do:aW.bind(null,t),vo:lW.bind(null,t),Co:dW.bind(null,t),Ps:uW.bind(null,t),bo:oW.bind(null,t)},await this.sharedClientState.start()),await this.persistence.ji(async r=>{await cW(this.Mu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}bu(e){let t=uL();if(!bh.C(t))throw new U(M.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=DC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new bh(t,e.asyncQueue,r,e.clientId,e.initialUser)}},ml=(()=>{class n{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>_O(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=rW.bind(null,this.syncEngine),await NA(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new kA})()}createDatastore(t){let r=xa(t.databaseInfo.databaseId),i=(function(o){return new TA(o)})(t.databaseInfo);return(function(o,a,c,d){return new CA(o,a,c,d)})(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return(function(i,s,o,a,c){return new RA(i,s,o,a,c)})(this.localStore,this.datastore,t.asyncQueue,r=>_O(this.syncEngine,r,0),(function(){return Wy.C()?new Wy:new vA})())}createSyncEngine(t,r){return(function(s,o,a,c,d,h,f){let y=new LA(s,o,a,c,d,h);return f&&(y.fu=!0),y})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){var t,r;await(async function(s){let o=G(s);j(Sa,"RemoteStore shutting down."),o.Ia.add(5),await dl(o),o.Ea.shutdown(),o.Aa.set("Unknown")})(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}return n.provider={build:()=>new n},n})();function IO(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){let r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}var ol=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):ut("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var UA=class{constructor(e,t){this.Nu=e,this.serializer=t,this.metadata=new wt,this.buffer=new Uint8Array,this.Bu=(function(){return new TextDecoder("utf-8")})(),this.Lu().then(r=>{r&&r.Qa()?this.metadata.resolve(r.qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.qa)}`))},r=>this.metadata.reject(r))}close(){return this.Nu.cancel()}async getMetadata(){return this.metadata.promise}async Su(){return await this.getMetadata(),this.Lu()}async Lu(){let e=await this.ku();if(e===null)return null;let t=this.Bu.decode(e),r=Number(t);isNaN(r)&&this.qu(`length string (${t}) is not valid number`);let i=await this.Qu(r);return new Jy(JSON.parse(i),e.length+r)}$u(){return this.buffer.findIndex(e=>e===123)}async ku(){for(;this.$u()<0&&!await this.Uu(););if(this.buffer.length===0)return null;let e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Qu(e){for(;this.buffer.length<e;)await this.Uu()&&this.qu("Reached the end of bundle when more is expected.");let t=this.Bu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}qu(e){throw this.Nu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Uu(){let e=await this.Nu.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}};var jA=class{constructor(e,t){this.bundleData=e,this.serializer=t,this.cursor=0,this.elements=[];let r=this.Su();if(!r||!r.Qa())throw new Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(r?.qa)}`);this.metadata=r;do r=this.Su(),r!==null&&this.elements.push(r);while(r!==null)}getMetadata(){return this.metadata}Ku(){return this.elements}Su(){if(this.cursor===this.bundleData.length)return null;let e=this.ku(),t=this.Qu(e);return new Jy(JSON.parse(t),e)}Qu(e){if(this.cursor+e>this.bundleData.length)throw new U(M.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}ku(){let e=this.cursor,t=this.cursor;for(;t<this.bundleData.length;){if(this.bundleData[t]==="{"){if(t===e)throw new Error("First character is a bracket and not a number");return this.cursor=t,Number(this.bundleData.slice(e,t))}t++}throw new Error("Reached the end of bundle when more is expected.")}};var BA=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new U(M.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=await(async function(i,s){let o=G(i),a={documents:s.map(f=>Bh(o.serializer,f))},c=await o.Jo("BatchGetDocuments",o.serializer.databaseId,we.emptyPath(),a,s.length),d=new Map;c.forEach(f=>{let y=yG(o.serializer,f);d.set(y.key.toString(),y)});let h=[];return s.forEach(f=>{let y=d.get(f.toString());X(!!y,55234,{key:f}),h.push(y)}),h})(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new js(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=W.fromPath(r);this.mutations.push(new Vh(i,this.precondition(i)))}),await(async function(r,i){let s=G(r),o={writes:i.map(a=>$h(s.serializer,a))};await s.Wo("Commit",s.serializer.databaseId,we.emptyPath(),o)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Y(50498,{Wu:e.constructor.name});t=te.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new U(M.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(te.min())?rt.exists(!1):rt.updateTime(t):rt.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(te.min()))throw new U(M.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return rt.updateTime(t)}return rt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var $A=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Gu=r.maxAttempts,this.F_=new Wh(this.asyncQueue,"transaction_retry")}zu(){this.Gu-=1,this.ju()}ju(){this.F_.g_(async()=>{let e=new BA(this.datastore),t=this.Ju(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Hu(i)}))}).catch(r=>{this.Hu(r)})})}Ju(e){try{let t=this.updateFunction(e);return!sf(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Hu(e){this.Gu>0&&this.Yu(e)?(this.Gu-=1,this.asyncQueue.enqueueAndForget(()=>(this.ju(),Promise.resolve()))):this.deferred.reject(e)}Yu(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!RV(t)}return!1}};var $s="FirestoreClient",qA=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=It.UNAUTHENTICATED,this.clientId=Ah.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{j($s,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(j($s,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new wt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=pl(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function tS(n,e){n.asyncQueue.verifyOperationInProgress(),j($s,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await eL(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>{nn("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then(()=>{j("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{nn("Terminating Firestore due to IndexedDb database deletion failed",i)})}),n._offlineComponents=e}async function EO(n,e){n.asyncQueue.verifyOperationInProgress();let t=await BC(n);j($s,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>mO(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>mO(e.remoteStore,i)),n._onlineComponents=e}async function BC(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){j($s,"Using user provided OfflineComponentProvider");try{await tS(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===M.FAILED_PRECONDITION||i.code===M.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;nn("Error using user provided cache. Falling back to memory cache: "+t),await tS(n,new A_)}}else j($s,"Using default OfflineComponentProvider"),await tS(n,new Jh(void 0));return n._offlineComponents}async function C_(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(j($s,"Using user provided OnlineComponentProvider"),await EO(n,n._uninitializedComponentsProvider._online)):(j($s,"Using default OnlineComponentProvider"),await EO(n,new ml))),n._onlineComponents}function IL(n){return BC(n).then(e=>e.persistence)}function gl(n){return BC(n).then(e=>e.localStore)}function EL(n){return C_(n).then(e=>e.remoteStore)}function $C(n){return C_(n).then(e=>e.syncEngine)}function wL(n){return C_(n).then(e=>e.datastore)}async function al(n){let e=await C_(n),t=e.eventManager;return t.onListen=WG.bind(null,e.syncEngine),t.onUnlisten=QG.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=KG.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=YG.bind(null,e.syncEngine),t}function fW(n){return n.asyncQueue.enqueue(async()=>{let e=await IL(n),t=await EL(n);return e.setNetworkEnabled(!0),(function(i){let s=G(i);return s.Ia.delete(0),lf(s)})(t)})}function pW(n){return n.asyncQueue.enqueue(async()=>{let e=await IL(n),t=await EL(n);return e.setNetworkEnabled(!1),(async function(i){let s=G(i);s.Ia.add(0),await dl(s),s.Aa.set("Offline")})(t)})}function mW(n,e){let t=new wt;return n.asyncQueue.enqueueAndForget(async()=>(async function(i,s,o){try{let a=await(function(d,h){let f=G(d);return f.persistence.runTransaction("read document","readonly",y=>f.localDocuments.getDocument(y,h))})(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new U(M.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=pl(a,`Failed to get document '${s} from cache`);o.reject(c)}})(await gl(n),e,t)),t.promise}function TL(n,e,t={}){let r=new wt;return n.asyncQueue.enqueueAndForget(async()=>(function(s,o,a,c,d){let h=new ol({next:y=>{h.Ou(),o.enqueueAndForget(()=>MC(s,f));let w=y.docs.has(a);!w&&y.fromCache?d.reject(new U(M.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&y.fromCache&&c&&c.source==="server"?d.reject(new U(M.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(y)},error:y=>d.reject(y)}),f=new Qh(ll(a.path),h,{includeMetadataChanges:!0,ka:!0});return kC(s,f)})(await al(n),n.asyncQueue,e,t,r)),r.promise}function gW(n,e){let t=new wt;return n.asyncQueue.enqueueAndForget(async()=>(async function(i,s,o){try{let a=await qy(i,s,!0),c=new t_(s,a.qs),d=c.nu(a.documents),h=c.applyChanges(d,!1);o.resolve(h.snapshot)}catch(a){let c=pl(a,`Failed to execute query '${s} against cache`);o.reject(c)}})(await gl(n),e,t)),t.promise}function bL(n,e,t={}){let r=new wt;return n.asyncQueue.enqueueAndForget(async()=>(function(s,o,a,c,d){let h=new ol({next:y=>{h.Ou(),o.enqueueAndForget(()=>MC(s,f)),y.fromCache&&c.source==="server"?d.reject(new U(M.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(y)},error:y=>d.reject(y)}),f=new Qh(a,h,{includeMetadataChanges:!0,ka:!0});return kC(s,f)})(await al(n),n.asyncQueue,e,t,r)),r.promise}function yW(n,e,t){let r=new wt;return n.asyncQueue.enqueueAndForget(async()=>{try{let i=await wL(n);r.resolve((async function(o,a,c){var d;let h=G(o),{request:f,ft:y,parent:w}=LV(h.serializer,fV(a),c);h.connection.Qo||delete f.parent;let R=(await h.Jo("RunAggregationQuery",h.serializer.databaseId,w,f,1)).filter(P=>!!P.result);X(R.length===1,64727);let N=(d=R[0].result)===null||d===void 0?void 0:d.aggregateFields;return Object.keys(N).reduce((P,F)=>(P[y[F]]=N[F],P),{})})(i,e,t))}catch(i){r.reject(i)}}),r.promise}function _W(n,e){let t=new ol(e);return n.asyncQueue.enqueueAndForget(async()=>(function(i,s){G(i).Da.add(s),s.next()})(await al(n),t)),()=>{t.Ou(),n.asyncQueue.enqueueAndForget(async()=>(function(i,s){G(i).Da.delete(s)})(await al(n),t))}}function vW(n,e,t,r){let i=(function(o,a){let c;return c=typeof o=="string"?hC().encode(o):o,(function(h,f){return new UA(h,f)})((function(h,f){if(h instanceof Uint8Array)return IO(h,f);if(h instanceof ArrayBuffer)return IO(new Uint8Array(h),f);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(c),a)})(t,xa(e));n.asyncQueue.enqueueAndForget(async()=>{hW(await $C(n),i,r)})}function IW(n,e){return n.asyncQueue.enqueue(async()=>(function(r,i){let s=G(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Ti.getNamedQuery(o,i))})(await gl(n),e))}function SL(n,e){return(function(r,i){return new jA(r,i)})(n,e)}function EW(n,e){return n.asyncQueue.enqueue(async()=>(async function(r,i){let s=G(r),o=s.indexManager,a=[];return s.persistence.runTransaction("Configure indexes","readwrite",c=>o.getFieldIndexes(c).next(d=>(function(f,y,w,R,N){f=[...f],y=[...y],f.sort(w),y.sort(w);let P=f.length,F=y.length,q=0,$=0;for(;q<F&&$<P;){let ee=w(f[$],y[q]);ee<0?N(f[$++]):ee>0?R(y[q++]):(q++,$++)}for(;q<F;)R(y[q++]);for(;$<P;)N(f[$++])})(d,i,b5,h=>{a.push(o.addFieldIndex(c,h))},h=>{a.push(o.deleteFieldIndex(c,h))})).next(()=>O.waitFor(a)))})(await gl(n),e))}function wW(n,e){return n.asyncQueue.enqueue(async()=>(function(r,i){G(r).Cs.Rs=i})(await gl(n),e))}function TW(n){return n.asyncQueue.enqueue(async()=>(function(t){let r=G(t),i=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",s=>i.deleteAllFieldIndexes(s))})(await gl(n)))}function AL(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var wO=new Map;var CL="firestore.googleapis.com",TO=!0,r_=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new U(M.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=CL,this.ssl=TO}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:TO;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=zV;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<QV)throw new U(M.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}T5("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=AL((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new U(M.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new U(M.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new U(M.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Ca=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new r_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new U(M.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new U(M.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new r_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new nS;switch(r.type){case"firstParty":return new oS(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new U(M.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let r=wO.get(t);r&&(j("ComponentProvider","Removing Datastore"),wO.delete(t),r.terminate())})(this),Promise.resolve()}};function qC(n,e,t,r={}){var i;n=Ie(n,Ca);let s=us(e),o=n._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:n._getEmulatorOptions()}),c=`${e}:${t}`;s&&(Dm(`https://${c}`),qE("Firestore",!0)),o.host!==CL&&o.host!==c&&nn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let d=Object.assign(Object.assign({},o),{host:c,ssl:s,emulatorOptions:r});if(!er(d,a)&&(n._setSettings(d),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=It.MOCK_USER;else{h=bP(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let y=r.mockUserToken.sub||r.mockUserToken.user_id;if(!y)throw new U(M.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new It(y)}n._authCredentials=new rS(new dy(h,f))}}var Mt=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Ge=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Lr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Pa(t,n._jsonSchema))return new n(e,r||null,new W(we.fromString(t.referencePath)))}};Ge._jsonSchemaVersion="firestore/documentReference/1.0",Ge._jsonSchema={type:Et("string",Ge._jsonSchemaVersion),referencePath:Et("string")};var Lr=class n extends Mt{constructor(e,t,r){super(e,t,ll(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ge(this.firestore,null,new W(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function DL(n,e,...t){if(n=ze(n),fC("collection","path",e),n instanceof Ca){let r=we.fromString(e,...t);return _M(r),new Lr(n,null,r)}{if(!(n instanceof Ge||n instanceof Lr))throw new U(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(we.fromString(e,...t));return _M(r),new Lr(n.firestore,null,r)}}function RL(n,e){if(n=Ie(n,Ca),fC("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new U(M.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Mt(n,null,(function(r){return new ar(we.emptyPath(),r)})(e))}function HC(n,e,...t){if(n=ze(n),arguments.length===1&&(e=Ah.newId()),fC("doc","path",e),n instanceof Ca){let r=we.fromString(e,...t);return yM(r),new Ge(n,null,new W(r))}{if(!(n instanceof Ge||n instanceof Lr))throw new U(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(we.fromString(e,...t));return yM(r),new Ge(n.firestore,n instanceof Lr?n.converter:null,new W(r))}}function NL(n,e){return n=ze(n),e=ze(e),(n instanceof Ge||n instanceof Lr)&&(e instanceof Ge||e instanceof Lr)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function D_(n,e){return n=ze(n),e=ze(e),n instanceof Mt&&e instanceof Mt&&n.firestore===e.firestore&&cf(n._query,e._query)&&n.converter===e.converter}var bO="AsyncQueue",i_=class{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Wh(this,"async_queue_retry"),this.oc=()=>{let r=ly();r&&j(bO,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;let t=ly();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;let t=ly();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});let t=new wt;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Hs(e))throw e;j(bO,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){let t=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,ut("INTERNAL UNHANDLED ERROR: ",SO(r)),r}).then(r=>(this.nc=!1,r))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);let i=PA.createAndSchedule(this,e,t,r,s=>this.lc(s));return this.ec.push(i),i}ac(){this.tc&&Y(47125,{hc:SO(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(let t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){let t=this.ec.indexOf(e);this.ec.splice(t,1)}};function SO(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function Fu(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1})(n,["next","error","complete"])}var HA=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new wt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var Fde=-1,Ue=class extends Ca{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new i_,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new i_(e),this._firestoreClient=void 0,await e}}};function PL(n,e,t){t||(t=kh);let r=Bc(n,"firestore");if(r.isInitialized(t)){let i=r.getImmediate({identifier:t}),s=r.getOptions(t);if(er(s,e))return i;throw new U(M.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new U(M.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<QV)throw new U(M.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&us(e.host)&&Dm(e.host),r.initialize({options:e,instanceIdentifier:t})}function xL(n,e){let t=typeof n=="object"?n:qc(),r=typeof n=="string"?n:e||kh,i=Bc(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=wP("firestore");s&&qC(i,...s)}return i}function tt(n){if(n._terminated)throw new U(M.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||kL(n),n._firestoreClient}function kL(n){var e,t,r;let i=n._freezeSettings(),s=(function(a,c,d,h){return new _S(a,c,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,AL(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new qA(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&(function(a){let c=a?._online.build();return{_offline:a?._offline.build(c),_online:c}})(n._componentsProvider))}function ML(n,e){nn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings();return VL(n,ml.provider,{build:r=>new Xh(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}async function OL(n){nn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=n._freezeSettings();VL(n,ml.provider,{build:t=>new n_(t,e.cacheSizeBytes)})}function VL(n,e,t){if((n=Ie(n,Ue))._firestoreClient||n._terminated)throw new U(M.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new U(M.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},kL(n)}function LL(n){if(n._initialized&&!n._terminated)throw new U(M.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new wt;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await(async function(r){if(!Ms.C())return Promise.resolve();let i=r+XV;await Ms.delete(i)})(DC(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function FL(n){return(function(t){let r=new wt;return t.asyncQueue.enqueueAndForget(async()=>tW(await $C(t),r)),r.promise})(tt(n=Ie(n,Ue)))}function UL(n){return fW(tt(n=Ie(n,Ue)))}function jL(n){return pW(tt(n=Ie(n,Ue)))}function BL(n){return qP(n.app,"firestore",n._databaseId.database),n._delete()}function s_(n,e){let t=tt(n=Ie(n,Ue)),r=new HA;return vW(t,n._databaseId,e,r),r}function zC(n,e){return IW(tt(n=Ie(n,Ue)),e).then(t=>t?new Mt(n,null,t.query):null)}var Da=class{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}},zA=class{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}};var Ei=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(dt.fromBase64String(e))}catch(t){throw new U(M.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(dt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Pa(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};Ei._jsonSchemaVersion="firestore/bytes/1.0",Ei._jsonSchema={type:Et("string",Ei._jsonSchemaVersion),bytes:Et("string")};var Ci=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new U(M.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Tt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};function $L(){return new Ci(uS)}var Di=class{constructor(e){this._methodName=e}};var Ps=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new U(M.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new U(M.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return re(this._lat,e._lat)||re(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(Pa(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};Ps._jsonSchemaVersion="firestore/geoPoint/1.0",Ps._jsonSchema={type:Et("string",Ps._jsonSchemaVersion),latitude:Et("number"),longitude:Et("number")};var wi=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Pa(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new U(M.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};wi._jsonSchemaVersion="firestore/vectorValue/1.0",wi._jsonSchema={type:Et("string",wi._jsonSchemaVersion),vectorValues:Et("object")};var bW=/^__.*__$/,GA=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ur(e,this.data,this.fieldMask,t,this.fieldTransforms):new Us(e,this.data,t,this.fieldTransforms)}},o_=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new ur(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function qL(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Y(40011,{Ec:n})}}var a_=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.fc(e),i}gc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return c_(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(qL(this.Ec)&&bW.test(e))throw this.wc('Document fields cannot begin and end with "__"')}},WA=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||xa(e)}Dc(e,t,r,i=!1){return new a_({Ec:e,methodName:t,bc:r,path:Tt.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function ka(n){let e=n._freezeSettings(),t=xa(n._databaseId);return new WA(n._databaseId,!!e.ignoreUndefinedProperties,t)}function R_(n,e,t,r,i,s={}){let o=n.Dc(s.merge||s.mergeFields?2:0,e,t,i);KC("Data must be an object, but it was:",o,r);let a=GL(r,o),c,d;if(s.merge)c=new Dn(o.fieldMask),d=o.fieldTransforms;else if(s.mergeFields){let h=[];for(let f of s.mergeFields){let y=ef(e,f,t);if(!o.contains(y))throw new U(M.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);KL(h,y)||h.push(y)}c=new Dn(h),d=o.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,d=o.fieldTransforms;return new GA(new Jt(a),c,d)}var Zh=class n extends Di{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function HL(n,e,t){return new a_({Ec:3,bc:e.settings.bc,methodName:n._methodName,mc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var KA=class n extends Di{_toFieldTransform(e){return new wa(e.path,new Ls)}isEqual(e){return e instanceof n}},QA=class n extends Di{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){let t=HL(this,e,!0),r=this.vc.map(s=>Ma(s,t)),i=new Si(r);return new wa(e.path,i)}isEqual(e){return e instanceof n&&er(this.vc,e.vc)}},YA=class n extends Di{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){let t=HL(this,e,!0),r=this.vc.map(s=>Ma(s,t)),i=new Ai(r);return new wa(e.path,i)}isEqual(e){return e instanceof n&&er(this.vc,e.vc)}},JA=class n extends Di{constructor(e,t){super(e),this.Cc=t}_toFieldTransform(e){let t=new Fs(e.serializer,wV(e.serializer,this.Cc));return new wa(e.path,t)}isEqual(e){return e instanceof n&&this.Cc===e.Cc}};function GC(n,e,t,r){let i=n.Dc(1,e,t);KC("Data must be an object, but it was:",i,r);let s=[],o=Jt.empty();zs(r,(c,d)=>{let h=N_(e,c,t);d=ze(d);let f=i.gc(h);if(d instanceof Zh)s.push(h);else{let y=Ma(d,f);y!=null&&(s.push(h),o.set(h,y))}});let a=new Dn(s);return new o_(o,a,i.fieldTransforms)}function WC(n,e,t,r,i,s){let o=n.Dc(1,e,t),a=[ef(e,r,t)],c=[i];if(s.length%2!=0)throw new U(M.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<s.length;y+=2)a.push(ef(e,s[y])),c.push(s[y+1]);let d=[],h=Jt.empty();for(let y=a.length-1;y>=0;--y)if(!KL(d,a[y])){let w=a[y],R=c[y];R=ze(R);let N=o.gc(w);if(R instanceof Zh)d.push(w);else{let P=Ma(R,N);P!=null&&(d.push(w),h.set(w,P))}}let f=new Dn(d);return new o_(h,f,o.fieldTransforms)}function zL(n,e,t,r=!1){return Ma(t,n.Dc(r?4:3,e))}function Ma(n,e){if(WL(n=ze(n)))return KC("Unsupported field value:",e,n),GL(n,e);if(n instanceof Di)return(function(r,i){if(!qL(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(r,i){let s=[],o=0;for(let a of r){let c=Ma(a,i.yc(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=ze(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return wV(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Ze.fromDate(r);return{timestampValue:Zu(i.serializer,s)}}if(r instanceof Ze){let s=new Ze(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Zu(i.serializer,s)}}if(r instanceof Ps)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ei)return{bytesValue:PV(i.serializer,r._byteString)};if(r instanceof Ge){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:AC(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof wi)return(function(o,a){return{mapValue:{fields:{[IC]:{stringValue:EC},[Ku]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw a.wc("VectorValues must only contain numeric values.");return SC(a.serializer,d)})}}}}}})(r,i);throw i.wc(`Unsupported field value: ${p_(r)}`)})(n,e)}function GL(n,e){let t={};return XO(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):zs(n,(r,i)=>{let s=Ma(i,e.Vc(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function WL(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ze||n instanceof Ps||n instanceof Ei||n instanceof Ge||n instanceof Di||n instanceof wi)}function KC(n,e,t){if(!WL(t)||!MO(t)){let r=p_(t);throw r==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+r)}}function ef(n,e,t){if((e=ze(e))instanceof Ci)return e._internalPath;if(typeof e=="string")return N_(n,e);throw c_("Field path arguments must be of type string or ",n,!1,void 0,t)}var SW=new RegExp("[~\\*/\\[\\]]");function N_(n,e,t){if(e.search(SW)>=0)throw c_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ci(...e.split("."))._internalPath}catch{throw c_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function c_(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new U(M.INVALID_ARGUMENT,a+n+c)}function KL(n,e){return n.some(t=>t.isEqual(e))}var Ra=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ge(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new XA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(P_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},XA=class extends Ra{data(){return super.data()}};function P_(n,e){return typeof e=="string"?N_(n,e):e instanceof Ci?e._internalPath:e._delegate._internalPath}function QL(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new U(M.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var tf=class{},Na=class extends tf{};function YL(n,e,...t){let r=[];e instanceof tf&&r.push(e),r=r.concat(t),(function(s){let o=s.filter(c=>c instanceof cl).length,a=s.filter(c=>c instanceof nf).length;if(o>1||o>0&&a>0)throw new U(M.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(let i of r)n=i._apply(n);return n}var nf=class n extends Na{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return cF(e._query,t),new Mt(e.firestore,e.converter,PS(e._query,t))}_parse(e){let t=ka(e.firestore);return(function(s,o,a,c,d,h,f){let y;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new U(M.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){CO(f,h);let R=[];for(let N of f)R.push(AO(c,s,N));y={arrayValue:{values:R}}}else y=AO(c,s,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||CO(f,h),y=zL(a,o,f,h==="in"||h==="not-in");return Te.create(d,h,y)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function JL(n,e,t){let r=e,i=P_("where",n);return nf._create(i,r,t)}var cl=class n extends tf{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Fe.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)cF(o,c),o=PS(o,c)})(e._query,t),new Mt(e.firestore,e.converter,PS(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function XL(...n){return n.forEach(e=>uF("or",e)),cl._create("or",n)}function ZL(...n){return n.forEach(e=>uF("and",e)),cl._create("and",n)}var ZA=class n extends Na{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=(function(i,s,o){if(i.startAt!==null)throw new U(M.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new U(M.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ia(s,o)})(e._query,this._field,this._direction);return new Mt(e.firestore,e.converter,(function(i,s){let o=i.explicitOrderBy.concat([s]);return new ar(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}};function eF(n,e="asc"){let t=e,r=P_("orderBy",n);return ZA._create(r,t)}var u_=class n extends Na{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new Mt(e.firestore,e.converter,by(e._query,this._limit,this._limitType))}};function tF(n){return OO("limit",n),u_._create("limit",n,"F")}function nF(n){return OO("limitToLast",n),u_._create("limitToLast",n,"L")}var l_=class n extends Na{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=aF(e,this.type,this._docOrFields,this._inclusive);return new Mt(e.firestore,e.converter,(function(i,s){return new ar(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)})(e._query,t))}};function rF(...n){return l_._create("startAt",n,!0)}function iF(...n){return l_._create("startAfter",n,!1)}var d_=class n extends Na{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=aF(e,this.type,this._docOrFields,this._inclusive);return new Mt(e.firestore,e.converter,(function(i,s){return new ar(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)})(e._query,t))}};function sF(...n){return d_._create("endBefore",n,!1)}function oF(...n){return d_._create("endAt",n,!0)}function aF(n,e,t,r){if(t[0]=ze(t[0]),t[0]instanceof Ra)return(function(s,o,a,c,d){if(!c)throw new U(M.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let h=[];for(let f of Vu(s))if(f.field.isKeyField())h.push(va(o,c.key));else{let y=c.data.field(f.field);if(__(y))throw new U(M.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(y===null){let w=f.field.canonicalString();throw new U(M.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${w}' (used as the orderBy) does not exist.`)}h.push(y)}return new Ur(h,d)})(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=ka(n.firestore);return(function(o,a,c,d,h,f){let y=o.explicitOrderBy;if(h.length>y.length)throw new U(M.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let w=[];for(let R=0;R<h.length;R++){let N=h[R];if(y[R].field.isKeyField()){if(typeof N!="string")throw new U(M.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof N}`);if(!TC(o)&&N.indexOf("/")!==-1)throw new U(M.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${N}' contains a slash.`);let P=o.path.child(we.fromString(N));if(!W.isDocumentKey(P))throw new U(M.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${P}' is not because it contains an odd number of segments.`);let F=new W(P);w.push(va(a,F))}else{let P=zL(c,d,N);w.push(P)}}return new Ur(w,f)})(n._query,n.firestore._databaseId,i,e,t,r)}}function AO(n,e,t){if(typeof(t=ze(t))=="string"){if(t==="")throw new U(M.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!TC(e)&&t.indexOf("/")!==-1)throw new U(M.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(we.fromString(t));if(!W.isDocumentKey(r))throw new U(M.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return va(n,new W(r))}if(t instanceof Ge)return va(n,t._key);throw new U(M.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${p_(t)}.`)}function CO(n,e){if(!Array.isArray(n)||n.length===0)throw new U(M.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function cF(n,e){let t=(function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new U(M.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new U(M.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function uF(n,e){if(!(e instanceof nf||e instanceof cl))throw new U(M.INVALID_ARGUMENT,`Function ${n}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}var h_=class{convertValue(e,t="none"){switch(Os(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Xe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(bi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Y(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return zs(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[Ku].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Xe(o.doubleValue));return new wi(s)}convertGeoPoint(e){return new Ps(Xe(e.latitude),Xe(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=v_(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(xh(e));default:return null}}convertTimestamp(e){let t=Ti(e);return new Ze(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=we.fromString(e);X(BV(r),9688,{name:e});let i=new Wu(r.get(1),r.get(3)),s=new W(r.popFirst(5));return i.isEqual(t)||ut(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function x_(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var rf=class extends h_{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ei(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ge(this.firestore,null,t)}};function lF(n){return new Da("sum",ef("sum",n))}function Ude(n){return new Da("avg",ef("average",n))}function AW(){return new Da("count")}function dF(n,e){var t,r;return n instanceof Da&&e instanceof Da&&n.aggregateType===e.aggregateType&&((t=n._internalFieldPath)===null||t===void 0?void 0:t.canonicalString())===((r=e._internalFieldPath)===null||r===void 0?void 0:r.canonicalString())}function hF(n,e){return D_(n.query,e.query)&&er(n.data(),e.data())}var fF="NOT SUPPORTED",Mr=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Rn=class n extends Ra{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Uu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(P_("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new U(M.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};function jde(n,e,t){if(Pa(e,Rn._jsonSchema)){if(e.bundle===fF)throw new U(M.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");let r=xa(n._databaseId),i=SL(e.bundle,r),s=i.Ku(),o=new Yh(i.getMetadata(),r);for(let h of s)o.Wa(h);let a=o.documents;if(a.length!==1)throw new U(M.INVALID_ARGUMENT,`Expected bundle data to contain 1 document, but it contains ${a.length} documents.`);let c=E_(r,a[0].document),d=new W(we.fromString(e.bundleName));return new Rn(n,new rf(n),d,c,new Mr(!1,!1),t||null)}}Rn._jsonSchemaVersion="firestore/documentSnapshot/1.0",Rn._jsonSchema={type:Et("string",Rn._jsonSchemaVersion),bundleSource:Et("string","DocumentSnapshot"),bundleName:Et("string"),bundle:Et("string")};var Uu=class extends Rn{data(e={}){return super.data(e)}},Nn=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Mr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Uu(this._firestore,this._userDataWriter,r.key,r,new Mr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new U(M.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new Uu(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Mr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new Uu(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Mr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:CW(a.type),doc:c,oldIndex:d,newIndex:h}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new U(M.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ah.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function Bde(n,e,t){if(Pa(e,Nn._jsonSchema)){if(e.bundle===fF)throw new U(M.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");let r=xa(n._databaseId),i=SL(e.bundle,r),s=i.Ku(),o=new Yh(i.getMetadata(),r);for(let y of s)o.Wa(y);if(o.queries.length!==1)throw new U(M.INVALID_ARGUMENT,`Snapshot data expected 1 query but found ${o.queries.length} queries.`);let a=T_(o.queries[0].bundledQuery),c=o.documents,d=new Kh;c.map(y=>{let w=E_(r,y.document);d=d.add(w)});let h=Aa.fromInitialDocuments(a,d,he(),!1,!1),f=new Mt(n,t||null,a);return new Nn(n,new rf(n),f,h)}}function CW(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Y(61501,{type:n})}}function pF(n,e){return n instanceof Rn&&e instanceof Rn?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Nn&&e instanceof Nn&&n._firestore===e._firestore&&D_(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function mF(n){n=Ie(n,Ge);let e=Ie(n.firestore,Ue);return TL(tt(e),n._key).then(t=>QC(e,n,t))}Nn._jsonSchemaVersion="firestore/querySnapshot/1.0",Nn._jsonSchema={type:Et("string",Nn._jsonSchemaVersion),bundleSource:Et("string","QuerySnapshot"),bundleName:Et("string"),bundle:Et("string")};var jr=class extends h_{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ei(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ge(this.firestore,null,t)}};function gF(n){n=Ie(n,Ge);let e=Ie(n.firestore,Ue),t=tt(e),r=new jr(e);return mW(t,n._key).then(i=>new Rn(e,r,n._key,i,new Mr(i!==null&&i.hasLocalMutations,!0),n.converter))}function yF(n){n=Ie(n,Ge);let e=Ie(n.firestore,Ue);return TL(tt(e),n._key,{source:"server"}).then(t=>QC(e,n,t))}function _F(n){n=Ie(n,Mt);let e=Ie(n.firestore,Ue),t=tt(e),r=new jr(e);return QL(n._query),bL(t,n._query).then(i=>new Nn(e,r,n,i))}function vF(n){n=Ie(n,Mt);let e=Ie(n.firestore,Ue),t=tt(e),r=new jr(e);return gW(t,n._query).then(i=>new Nn(e,r,n,i))}function IF(n){n=Ie(n,Mt);let e=Ie(n.firestore,Ue),t=tt(e),r=new jr(e);return bL(t,n._query,{source:"server"}).then(i=>new Nn(e,r,n,i))}function EF(n,e,t){n=Ie(n,Ge);let r=Ie(n.firestore,Ue),i=x_(n.converter,e,t);return df(r,[R_(ka(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,rt.none())])}function wF(n,e,t,...r){n=Ie(n,Ge);let i=Ie(n.firestore,Ue),s=ka(i),o;return o=typeof(e=ze(e))=="string"||e instanceof Ci?WC(s,"updateDoc",n._key,e,t,r):GC(s,"updateDoc",n._key,e),df(i,[o.toMutation(n._key,rt.exists(!0))])}function TF(n){return df(Ie(n.firestore,Ue),[new js(n._key,rt.none())])}function bF(n,e){let t=Ie(n.firestore,Ue),r=HC(n),i=x_(n.converter,e);return df(t,[R_(ka(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,rt.exists(!1))]).then(()=>r)}function f_(n,...e){var t,r,i;n=ze(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Fu(e[o])||(s=e[o++]);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Fu(e[o])){let f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(i=f.complete)===null||i===void 0?void 0:i.bind(f)}let c,d,h;if(n instanceof Ge)d=Ie(n.firestore,Ue),h=ll(n._key.path),c={next:f=>{e[o]&&e[o](QC(d,n,f))},error:e[o+1],complete:e[o+2]};else{let f=Ie(n,Mt);d=Ie(f.firestore,Ue),h=f._query;let y=new jr(d);c={next:w=>{e[o]&&e[o](new Nn(d,y,f,w))},error:e[o+1],complete:e[o+2]},QL(n._query)}return(function(y,w,R,N){let P=new ol(N),F=new Qh(w,P,R);return y.asyncQueue.enqueueAndForget(async()=>kC(await al(y),F)),()=>{P.Ou(),y.asyncQueue.enqueueAndForget(async()=>MC(await al(y),F))}})(tt(d),h,a,c)}function $de(n,e,...t){let r=ze(n),i=(function(c){let d={bundle:"",bundleName:"",bundleSource:""},h=["bundle","bundleName","bundleSource"];for(let f of h){if(!(f in c)){d.error=`snapshotJson missing required field: ${f}`;break}let y=c[f];if(typeof y!="string"){d.error=`snapshotJson field '${f}' must be a string.`;break}if(y.length===0){d.error=`snapshotJson field '${f}' cannot be an empty string.`;break}f==="bundle"?d.bundle=y:f==="bundleName"?d.bundleName=y:f==="bundleSource"&&(d.bundleSource=y)}return d})(e);if(i.error)throw new U(M.INVALID_ARGUMENT,i.error);let s,o=0;if(typeof t[o]!="object"||Fu(t[o])||(s=t[o++]),i.bundleSource==="QuerySnapshot"){let a=null;if(typeof t[o]=="object"&&Fu(t[o])){let c=t[o++];a={next:c.next,error:c.error,complete:c.complete}}else a={next:t[o++],error:t[o++],complete:t[o++]};return(function(d,h,f,y,w){let R,N=!1;return s_(d,h.bundle).then(()=>zC(d,h.bundleName)).then(F=>{F&&!N&&(w&&F.withConverter(w),R=f_(F,f||{},y))}).catch(F=>(y.error&&y.error(F),()=>{})),()=>{N||(N=!0,R&&R())}})(r,i,s,a,t[o])}if(i.bundleSource==="DocumentSnapshot"){let a=null;if(typeof t[o]=="object"&&Fu(t[o])){let c=t[o++];a={next:c.next,error:c.error,complete:c.complete}}else a={next:t[o++],error:t[o++],complete:t[o++]};return(function(d,h,f,y,w){let R,N=!1;return s_(d,h.bundle).then(()=>{if(!N){let F=new Ge(d,w||null,W.fromPath(h.bundleName));R=f_(F,f||{},y)}}).catch(F=>(y.error&&y.error(F),()=>{})),()=>{N||(N=!0,R&&R())}})(r,i,s,a,t[o])}throw new U(M.INVALID_ARGUMENT,`unsupported bundle source: ${i.bundleSource}`)}function SF(n,e){return _W(tt(n=Ie(n,Ue)),Fu(e)?e:{next:e})}function df(n,e){return(function(r,i){let s=new wt;return r.asyncQueue.enqueueAndForget(async()=>JG(await $C(r),i,s)),s.promise})(tt(n),e)}function QC(n,e,t){let r=t.docs.get(e._key),i=new jr(n);return new Rn(n,i,e._key,r,new Mr(t.hasPendingWrites,t.fromCache),e.converter)}function AF(n){return YC(n,{count:AW()})}function YC(n,e){let t=Ie(n.firestore,Ue),r=tt(t),i=JO(e,(s,o)=>new Sy(o,s.aggregateType,s._internalFieldPath));return yW(r,n._query,i).then(s=>(function(a,c,d){let h=new jr(a);return new zA(c,h,d)})(t,n,s))}var eC=class{constructor(e){this.kind="memory",this._onlineComponentProvider=ml.provider,e?.garbageCollector?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider={build:()=>new Jh(void 0)}}toJSON(){return{kind:this.kind}}},tC=class{constructor(e){let t;this.kind="persistent",e?.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=DW(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}},nC=class{constructor(){this.kind="memoryEager",this._offlineComponentProvider=A_.provider}toJSON(){return{kind:this.kind}}},rC=class{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new Jh(e)}}toJSON(){return{kind:this.kind}}};function qde(){return new nC}function Hde(n){return new rC(n?.cacheSizeBytes)}function zde(n){return new eC(n)}function Gde(n){return new tC(n)}var iC=class{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=ml.provider,this._offlineComponentProvider={build:t=>new Xh(t,e?.cacheSizeBytes,this.forceOwnership)}}},sC=class{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=ml.provider,this._offlineComponentProvider={build:t=>new n_(t,e?.cacheSizeBytes)}}};function DW(n){return new iC(n?.forceOwnership)}function Wde(){return new sC}var RW={maxAttempts:5};var oC=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=ka(e)}set(e,t,r){this._verifyNotCommitted();let i=Rs(e,this._firestore),s=x_(i.converter,t,r),o=R_(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,rt.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=Rs(e,this._firestore),o;return o=typeof(t=ze(t))=="string"||t instanceof Ci?WC(this._dataReader,"WriteBatch.update",s._key,t,r,i):GC(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,rt.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Rs(e,this._firestore);return this._mutations=this._mutations.concat(new js(t._key,rt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new U(M.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Rs(n,e){if((n=ze(n)).firestore!==e)throw new U(M.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var aC=class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=ka(e)}get(e){let t=Rs(e,this._firestore),r=new rf(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||i.length!==1)return Y(24041);let s=i[0];if(s.isFoundDocument())return new Ra(this._firestore,r,s.key,s,t.converter);if(s.isNoDocument())return new Ra(this._firestore,r,t._key,null,t.converter);throw Y(18433,{doc:s})})}set(e,t,r){let i=Rs(e,this._firestore),s=x_(i.converter,t,r),o=R_(this._dataReader,"Transaction.set",i._key,s,i.converter!==null,r);return this._transaction.set(i._key,o),this}update(e,t,r,...i){let s=Rs(e,this._firestore),o;return o=typeof(t=ze(t))=="string"||t instanceof Ci?WC(this._dataReader,"Transaction.update",s._key,t,r,i):GC(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,o),this}delete(e){let t=Rs(e,this._firestore);return this._transaction.delete(t._key),this}};var cC=class extends aC{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Rs(e,this._firestore),r=new jr(this._firestore);return super.get(e).then(i=>new Rn(this._firestore,r,t._key,i._document,new Mr(!1,!1),t.converter))}};function CF(n,e,t){n=Ie(n,Ue);let r=Object.assign(Object.assign({},RW),t);return(function(s){if(s.maxAttempts<1)throw new U(M.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r),(function(s,o,a){let c=new wt;return s.asyncQueue.enqueueAndForget(async()=>{let d=await wL(s);new $A(s.asyncQueue,d,a,o,c).zu()}),c.promise})(tt(n),i=>e(new cC(n,i)),r)}function DF(){return new Zh("deleteField")}function Kde(){return new KA("serverTimestamp")}function Qde(...n){return new QA("arrayUnion",n)}function Yde(...n){return new YA("arrayRemove",n)}function RF(n){return new JA("increment",n)}function NF(n){return new wi(n)}function PF(n){return tt(n=Ie(n,Ue)),new oC(n,e=>df(n,e))}function xF(n,e){let t=tt(n=Ie(n,Ue));if(!t._uninitializedComponentsProvider||t._uninitializedComponentsProvider._offline.kind==="memory")return nn("Cannot enable indexes when persistence is disabled"),Promise.resolve();let r=(function(s){let o=typeof s=="string"?(function(d){try{return JSON.parse(d)}catch(h){throw new U(M.INVALID_ARGUMENT,"Failed to parse JSON: "+h?.message)}})(s):s,a=[];if(Array.isArray(o.indexes))for(let c of o.indexes){let d=DO(c,"collectionGroup"),h=[];if(Array.isArray(c.fields))for(let f of c.fields){let y=N_("setIndexConfiguration",DO(f,"fieldPath"));f.arrayConfig==="CONTAINS"?h.push(new Ii(y,2)):f.order==="ASCENDING"?h.push(new Ii(y,0)):f.order==="DESCENDING"&&h.push(new Ii(y,1))}a.push(new ks(ks.UNKNOWN_ID,d,h,$u.empty()))}return a})(e);return EW(t,r)}function DO(n,e){if(typeof n[e]!="string")throw new U(M.INVALID_ARGUMENT,"Missing string value for: "+e);return n[e]}var uC=class{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}};function kF(n){var e;n=Ie(n,Ue);let t=RO.get(n);if(t)return t;if(((e=tt(n)._uninitializedComponentsProvider)===null||e===void 0?void 0:e._offline.kind)!=="persistent")return null;let r=new uC(n);return RO.set(n,r),r}function MF(n){LF(n,!0)}function OF(n){LF(n,!1)}function VF(n){TW(tt(n._firestore)).then(e=>j("deleting all persistent cache indexes succeeded")).catch(e=>nn("deleting all persistent cache indexes failed",e))}function LF(n,e){wW(tt(n._firestore),e).then(t=>j(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(t=>nn(`setting persistent cache index auto creation isEnabled=${e} failed`,t))}var RO=new WeakMap;function Jde(n){var e;let t=(e=tt(Ie(n.firestore,Ue))._onlineComponents)===null||e===void 0?void 0:e.datastore.serializer;return t===void 0?null:w_(t,Zt(n._query)).Vt}function Xde(n,e){var t;let r=JO(e,(s,o)=>new Sy(o,s.aggregateType,s._internalFieldPath)),i=(t=tt(Ie(n.firestore,Ue))._onlineComponents)===null||t===void 0?void 0:t.datastore.serializer;return i===void 0?null:LV(i,fV(n._query),r,!0).request}var NO=class{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return lC.instance.onExistenceFilterMismatch(e)}},lC=class n{constructor(){this.Fc=new Map}static get instance(){return ny||(ny=new n,(function(t){if(Ay)throw new Error("a TestingHooksSpi instance is already set");Ay=t})(ny)),ny}ct(e){this.Fc.forEach(t=>t(e))}onExistenceFilterMismatch(e){let t=Symbol(),r=this.Fc;return r.set(t,e),()=>r.delete(t)}},ny=null;(function(e,t=!0){(function(i){ul=i})($c),tr(new tn("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Ue(new iS(r.getProvider("auth-internal")),new aS(o,r.getProvider("app-check-internal")),(function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new U(M.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Wu(d.options.projectId,h)})(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),nt(fM,pM,e),nt(fM,pM,"esm2017")})();var hf=class{constructor(e){return e}},XC="firestore",JC=class{constructor(){return qo(XC)}},fhe=av(0,300).pipe(cv(()=>kn(qo(XC))),lv()),ZC=new be("angularfire2.firestore-instances");function NW(n,e){let t=Om(XC,n,e);return t&&new hf(t)}function PW(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new hf(r)}}var FF={provide:JC,deps:[[new ii,ZC]]},UF={provide:hf,useFactory:NW,deps:[[new ii,ZC],zo]},phe=(()=>{class n{constructor(){nt("angularfire",ds.full,"fst")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=AE({type:n});static \u0275inj=Sp({providers:[UF,FF]})}return n})();function mhe(n,...e){return nt("angularfire",ds.full,"fst"),Xr([UF,FF,{provide:ZC,useFactory:PW(n),multi:!0,deps:[Lt,En,Ho,Rd,[new ii,Xm],[new ii,jm],...e]}])}var ghe=Q(cM,!0),yhe=Q(Bb,!0),_he=Q(Kg,!0),vhe=Q(lM,!0),Ihe=Q($b,!0),Ehe=Q(uM,!0),whe=Q(jb,!0),The=Q(iM,!0),bhe=Q(uh,!0),She=Q(Wg,!0),Ahe=Q(aM,!0),Che=Q(bF,!0,2),Dhe=Q(dF,!0,2),Rhe=Q(hF,!0,2),Nhe=Q(ZL,!0,2),Phe=Q(LL,!0),xhe=Q(DL,!0,2),khe=Q(RL,!0,2),Mhe=Q(qC,!0),Ohe=Q(VF,!0),Vhe=Q(TF,!0,2),Lhe=Q(DF,!0,2),Fhe=Q(jL,!0),Uhe=Q(OF,!0),jhe=Q(HC,!0,2),Bhe=Q($L,!0,2),$he=Q(ML,!0),qhe=Q(OL,!0),Hhe=Q(UL,!0),zhe=Q(MF,!0),Ghe=Q(oF,!0,2),Whe=Q(sF,!0,2),Khe=Q(YC,!0),Qhe=Q(AF,!0),Yhe=Q(mF,!0),Jhe=Q(gF,!0),Xhe=Q(yF,!0),Zhe=Q(_F,!0),efe=Q(vF,!0),tfe=Q(IF,!0),nfe=Q(xL,!0),rfe=Q(kF,!0),ife=Q(RF,!0,2),sfe=Q(PL,!0),ofe=Q(tF,!0,2),afe=Q(nF,!0,2),cfe=Q(s_,!0),ufe=Q(zC,!0,2),lfe=Q(f_,!0),dfe=Q(SF,!0),hfe=Q(XL,!0,2),ffe=Q(eF,!0,2),pfe=Q(YL,!0,2),mfe=Q(D_,!0,2),gfe=Q(NL,!0,2),yfe=Q(CF,!0),_fe=Q(EF,!0,2),vfe=Q(xF,!0),Ife=Q(PO,!0),Efe=Q(pF,!0,2),wfe=Q(iF,!0,2),Tfe=Q(rF,!0,2),bfe=Q(lF,!0,2),Sfe=Q(BL,!0),Afe=Q(wF,!0,2),Cfe=Q(NF,!0,2),Dfe=Q(FL,!0),Rfe=Q(JL,!0,2),Nfe=Q(PF,!0,2);export{Vt as a,Jf as b,me as c,yr as d,zl as e,Wl as f,kn as g,o2 as h,a2 as i,c2 as j,Kl as k,un as l,g2 as m,_o as n,pp as o,_2 as p,gc as q,VD as r,cv as s,uv as t,E2 as u,w2 as v,T2 as w,fv as x,b2 as y,S2 as z,A2 as A,ke as B,Pv as C,Qe as D,P2 as E,be as F,zt as G,se as H,Xr as I,Kv as J,hn as K,is as L,mR as M,gR as N,En as O,ni as P,Nc as Q,Mo as R,Qr as S,Lt as T,Ic as U,as as V,sU as W,yI as X,II as Y,vU as Z,jU as _,GU as $,WU as aa,L0 as ba,aE as ca,QU as da,Vo as ea,Uc as fa,uE as ga,tj as ha,nj as ia,rj as ja,ij as ka,sj as la,lE as ma,J0 as na,pm as oa,Aj as pa,Cj as qa,$j as ra,em as sa,pd as ta,yE as ua,_d as va,FN as wa,jN as xa,BN as ya,I4 as za,b4 as Aa,R4 as Ba,CE as Ca,WN as Da,Em as Ea,x4 as Fa,k4 as Ga,M4 as Ha,O4 as Ia,V4 as Ja,YN as Ka,xE as La,kE as Ma,JN as Na,B4 as Oa,ZN as Pa,tP as Qa,q4 as Ra,rP as Sa,n$ as Ta,f$ as Ua,lP as Va,ME as Wa,dP as Xa,g$ as Ya,y$ as Za,_$ as _a,I$ as $a,poe as ab,goe as bb,yoe as cb,Vm as db,rH as eb,cw as fb,ex as gb,uH as hb,uw as ib,kae as jb,gae as kb,yae as lb,nn as mb,Ode as nb,U as ob,nS as pb,mM as qb,Ah as rb,Tt as sb,W as tb,T5 as ub,Ie as vb,Ze as wb,Lde as xb,dt as yb,Wu as zb,Mt as Ab,Ge as Bb,Lr as Cb,HA as Db,Fde as Eb,tt as Fb,Da as Gb,zA as Hb,Ei as Ib,Ci as Jb,Di as Kb,Ps as Lb,wi as Mb,Na as Nb,nf as Ob,cl as Pb,ZA as Qb,u_ as Rb,l_ as Sb,d_ as Tb,h_ as Ub,Ude as Vb,AW as Wb,Mr as Xb,Rn as Yb,jde as Zb,Uu as _b,Nn as $b,Bde as ac,$de as bc,df as cc,qde as dc,Hde as ec,zde as fc,Gde as gc,DW as hc,Wde as ic,oC as jc,cC as kc,Kde as lc,Qde as mc,Yde as nc,uC as oc,Jde as pc,Xde as qc,NO as rc,hf as sc,JC as tc,fhe as uc,phe as vc,mhe as wc,ghe as xc,yhe as yc,_he as zc,vhe as Ac,Ihe as Bc,Ehe as Cc,whe as Dc,The as Ec,bhe as Fc,She as Gc,Ahe as Hc,Che as Ic,Dhe as Jc,Rhe as Kc,Nhe as Lc,Phe as Mc,xhe as Nc,khe as Oc,Mhe as Pc,Ohe as Qc,Vhe as Rc,Lhe as Sc,Fhe as Tc,Uhe as Uc,jhe as Vc,Bhe as Wc,$he as Xc,qhe as Yc,Hhe as Zc,zhe as _c,Ghe as $c,Whe as ad,Khe as bd,Qhe as cd,Yhe as dd,Jhe as ed,Xhe as fd,Zhe as gd,efe as hd,tfe as id,nfe as jd,rfe as kd,ife as ld,sfe as md,ofe as nd,afe as od,cfe as pd,ufe as qd,lfe as rd,dfe as sd,hfe as td,ffe as ud,pfe as vd,mfe as wd,gfe as xd,yfe as yd,_fe as zd,vfe as Ad,Ife as Bd,Efe as Cd,wfe as Dd,Tfe as Ed,bfe as Fd,Sfe as Gd,Afe as Hd,Cfe as Id,Dfe as Jd,Rfe as Kd,Nfe as Ld};
